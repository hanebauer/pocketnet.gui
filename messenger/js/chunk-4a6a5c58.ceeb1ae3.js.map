{"version":3,"sources":["webpack:///./node_modules/cancelable-promise/umd/CancelablePromise.js","webpack:///./node_modules/async-each/index.js","webpack:///./src/components/assets/recordProgress/index.scss?31c2","webpack:///./src/components/chat/input/index.sass?bc62","webpack:///./src/components/assets/upload/index.vue?26cf","webpack:///./src/components/assets/recordVoice/index.scss?4edc","webpack:///./src/components/chat/input/index.vue?8e49","webpack:///./src/components/assets/recordVoice/index.vue?b4ee","webpack:///./src/components/assets/recordVoice/index.js","webpack:///./src/components/assets/recordVoice","webpack:///./src/components/assets/recordVoice/index.vue","webpack:///./src/components/assets/recordProgress/index.vue?439b","webpack:///./src/components/assets/recordProgress/index.js","webpack:///./src/components/assets/recordProgress","webpack:///./src/components/assets/recordProgress/index.vue","webpack:///./src/components/assets/upload/index.vue?d50b","webpack:///src/components/assets/upload/index.vue","webpack:///./src/components/assets/upload/index.vue?f5f6","webpack:///./src/components/assets/upload/index.vue","webpack:///./src/components/chat/input/index.js","webpack:///./src/components/chat/input","webpack:///./src/components/chat/input/index.vue"],"names":["_typeof","Symbol","iterator","obj","constructor","prototype","global","factory","globalThis","self","_exports","_inherits","subClass","superClass","TypeError","Object","create","value","writable","configurable","defineProperty","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","result","Super","_getPrototypeOf","NewTarget","this","Reflect","construct","arguments","apply","_possibleConstructorReturn","call","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","_defineProperty","key","enumerable","_createForOfIteratorHelper","allowArrayLike","it","Array","isArray","_unsupportedIterableToArray","length","i","F","s","n","done","_e","f","err","normalCompletion","didErr","step","next","_e2","return","minLen","_arrayLikeToArray","toString","slice","name","from","test","arr","len","arr2","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","_createClass","protoProps","staticProps","_classPrivateFieldInitSpec","privateMap","_checkPrivateRedeclaration","set","privateCollection","has","_classPrivateFieldGet","receiver","_classExtractFieldDescriptor","_classApplyDescriptorGet","get","_classPrivateFieldSet","_classApplyDescriptorSet","action","CancelablePromise","cancelable","default","isCancelablePromise","_internals","WeakMap","_promise","CancelablePromiseInternal","_ref","_ref$executor","executor","_ref$internals","internals","defaultInternals","_ref$promise","promise","Promise","resolve","reject","onCancel","onCancelList","push","cancel","bind","onfulfilled","onrejected","makeCancelable","then","createCallback","catch","onfinally","runWhenCanceled","_this","finally","filter","callback","isCanceled","callbacks","_step","_iterator","console","error","_CancelablePromiseInt","_super","iterable","makeAllCancelable","all","allSettled","any","race","reason","_default","onResult","arg","_step2","_iterator2","resolvable","globals","each","items","Function","undefined","transformed","count","returned","forEach","item","index","transformedItem","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","tipusers","_l","user","id","class","selected","tipuserindex","on","$event","insertuser","voiceEnable","isRecording","record","recordTime","recordRmsData","cancelOpacity","clear","ref","chat","roomId","sendinput","emitInputData","HideUploadPic","pasteImage","focused","tipBySearch","browsetip","selectcurrenttip","upload","extended","menuItems","scopedSlots","_u","fn","slotProps","onlyimage","multiple","extensions","images","files","uploadStart","data","uploadUploaded","uploadUploadedAll","uploadError","icon","_v","_s","title","proxy","menuItemClick","directives","rawName","expression","prepareRecording","microphoneDisabled","initRecording","stopRecording","setOpacity","sendVoiceMessage","_m","staticRenderFns","hold","isHold","active","disabled","mousedown","mouseup","handleTouchStart","handleTouchEnd","recordEnd","type","required","start","direction","computed","mapState","mobile","state","mounted","beforeDestroy","document","removeEventListener","handleMove","$emit","methods","Y","changedTouches","pageY","X","pageX","addEventListener","sendnow","clearStyle","$refs","toggle","style","transform","classList","remove","holder","deltaY","deltaX","contains","add","component","timer","width","opacity","Number","rmsData","minute","Math","floor","sec","rmsDataLast","_","last","watch","throttle","draw","graph","offsetWidth","window","resize","re","setTimeout","canvas","ctx","getContext","l","c","max","clearRect","fillStyle","fillRect","_t","dropzone","$t","maxsize","loading","maxSize","created","read","reader","base64","file","event","ha","text","errorText","check","checkSize","getExtension","checkExtension","handle","sendAnyFile","resizeIfNeed","handleImages","u","String","relationEvent","components","InputField","contacts","preview","recordProgress","recordVoice","fileInfo","ready","creating","userId","showuserselect","anyUrlMeta","joinedMembers","tipvalue","mediaRecorder","audioContext","audioAnalyser","interval","cancelledCordovaMediaRecorder","usersForKeysHash","handler","close","$store","voiceMessagesEnabled","connect","contact","pkoindisabled","POCKETNETINSTANCE","supportimagegallery","click","$i18n","t","transaction","unshift","userlist","core","mtrx","chatUsersInfo","deep","uusers","map","split","ausers","matrixId","stateChat","$route","query","chatsMap","invited","currentState","getMembers","m","v","membership","joined","toLowerCase","indexOf","maintipuser","client","newchat","wait","$f","pretry","access","increase","inserttip","showuserselected","resizeImage","ftype","Images","cameraHandlerCustom","dropdownMenu","hidePopup","platform","ui","uploadImage","Base64","toFile","onSuccess","imgs","sendtransactionWrapper","menuIsVisible","users","j","getmatrixid","r","source","userinfo","store","commit","caption","userselected","sendtransaction","api","roomid","address","emitUrl","url","globalpreloader","usersInfo","info","_info","keys","kit","tetatetid","initialstate","encrypted","createRoom","room_alias_name","visibility","invite","initial_state","_chat","m_chat","getRoom","room_id","getStateEvents","setPowerLevel","greetings","errcode","joinRoom","baseUrl","replace","maySendMessage","send","textCutLimit","limit","trim","replaceMentions","RegExp","focus","textEvent","clearEventId","makeid","editEvent","content","body","block","msgtype","decryptKey","decrypted","sendEvent","dispatch","sendtext","relation","sendImage","meta","aborted","canencryptfilesize","pcrypto","canBeEncrypt","size","$dialog","confirm","okText","cancelText","dialog","sendFile","notenc","blur","blurifempty","change","setText","keyup","evt","getUrl","sendTyping","rowObject","menuItemLoadedHandler","message","getImg","uploadSizeError","validImageTypes","includes","imageWH","img","Image","imgInfo","onload","w","h","height","onerror","src","catchPermissonsError","cordova","getFileIosCordova","path","resolveLocalFileSystemURL","entry","FileReader","onloadend","blob","Blob","Uint8Array","readAsArrayBuffer","initRecordingCordova","media","permissions","audio","isios","getAudioContext","cordovaMediaRecorder","Media","release","fu","externalDataDirectory","duration","createVoiceMessage","rmsdata","currentPlaying","currentPlayingVoiceMessage","pause","setInterval","clone","getCurrentAmplitude","amp","log","startRecord","initMediaRecorder","recorder","stream","getTracks","track","stop","createAnalyser","createMediaStreamSource","startRecording","dataArray","frequencyBinCount","getByteFrequencyData","generateRms","checkaudioForSend","getduration","readFile","arraybuffer","decodeAudioData","buffer","frequencies","sqrt","reduce","a","b","toPrecision","clearInterval","stopRecord","convertAudioToBase64","sendAudio"],"mappings":"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","file":"js/chunk-4a6a5c58.ceeb1ae3.js","sourcesContent":["function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\n(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define([\"exports\"], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(exports);\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(mod.exports);\n    global.CancelablePromise = mod.exports;\n  }\n})(typeof globalThis !== \"undefined\" ? globalThis : typeof self !== \"undefined\" ? self : this, function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.CancelablePromise = void 0;\n  _exports.cancelable = cancelable;\n  _exports.default = void 0;\n  _exports.isCancelablePromise = isCancelablePromise;\n\n  function _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\n  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\n  function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\n  function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\n  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\n  function _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\n  function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  function _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\n  function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\n  function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n  function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n  function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\n  function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\n  function _classPrivateFieldInitSpec(obj, privateMap, value) { _checkPrivateRedeclaration(obj, privateMap); privateMap.set(obj, value); }\n\n  function _checkPrivateRedeclaration(obj, privateCollection) { if (privateCollection.has(obj)) { throw new TypeError(\"Cannot initialize the same private elements twice on an object\"); } }\n\n  function _classPrivateFieldGet(receiver, privateMap) { var descriptor = _classExtractFieldDescriptor(receiver, privateMap, \"get\"); return _classApplyDescriptorGet(receiver, descriptor); }\n\n  function _classApplyDescriptorGet(receiver, descriptor) { if (descriptor.get) { return descriptor.get.call(receiver); } return descriptor.value; }\n\n  function _classPrivateFieldSet(receiver, privateMap, value) { var descriptor = _classExtractFieldDescriptor(receiver, privateMap, \"set\"); _classApplyDescriptorSet(receiver, descriptor, value); return value; }\n\n  function _classExtractFieldDescriptor(receiver, privateMap, action) { if (!privateMap.has(receiver)) { throw new TypeError(\"attempted to \" + action + \" private field on non-instance\"); } return privateMap.get(receiver); }\n\n  function _classApplyDescriptorSet(receiver, descriptor, value) { if (descriptor.set) { descriptor.set.call(receiver, value); } else { if (!descriptor.writable) { throw new TypeError(\"attempted to set read only private field\"); } descriptor.value = value; } }\n\n  var _internals = /*#__PURE__*/new WeakMap();\n\n  var _promise = /*#__PURE__*/new WeakMap();\n\n  var CancelablePromiseInternal = /*#__PURE__*/function () {\n    function CancelablePromiseInternal(_ref) {\n      var _ref$executor = _ref.executor,\n          executor = _ref$executor === void 0 ? function () {} : _ref$executor,\n          _ref$internals = _ref.internals,\n          internals = _ref$internals === void 0 ? defaultInternals() : _ref$internals,\n          _ref$promise = _ref.promise,\n          promise = _ref$promise === void 0 ? new Promise(function (resolve, reject) {\n        return executor(resolve, reject, function (onCancel) {\n          internals.onCancelList.push(onCancel);\n        });\n      }) : _ref$promise;\n\n      _classCallCheck(this, CancelablePromiseInternal);\n\n      _classPrivateFieldInitSpec(this, _internals, {\n        writable: true,\n        value: void 0\n      });\n\n      _classPrivateFieldInitSpec(this, _promise, {\n        writable: true,\n        value: void 0\n      });\n\n      this.cancel = this.cancel.bind(this);\n\n      _classPrivateFieldSet(this, _internals, internals);\n\n      _classPrivateFieldSet(this, _promise, promise || new Promise(function (resolve, reject) {\n        return executor(resolve, reject, function (onCancel) {\n          internals.onCancelList.push(onCancel);\n        });\n      }));\n    }\n\n    _createClass(CancelablePromiseInternal, [{\n      key: \"then\",\n      value: function then(onfulfilled, onrejected) {\n        return makeCancelable(_classPrivateFieldGet(this, _promise).then(createCallback(onfulfilled, _classPrivateFieldGet(this, _internals)), createCallback(onrejected, _classPrivateFieldGet(this, _internals))), _classPrivateFieldGet(this, _internals));\n      }\n    }, {\n      key: \"catch\",\n      value: function _catch(onrejected) {\n        return makeCancelable(_classPrivateFieldGet(this, _promise).catch(createCallback(onrejected, _classPrivateFieldGet(this, _internals))), _classPrivateFieldGet(this, _internals));\n      }\n    }, {\n      key: \"finally\",\n      value: function _finally(onfinally, runWhenCanceled) {\n        var _this = this;\n\n        if (runWhenCanceled) {\n          _classPrivateFieldGet(this, _internals).onCancelList.push(onfinally);\n        }\n\n        return makeCancelable(_classPrivateFieldGet(this, _promise).finally(createCallback(function () {\n          if (onfinally) {\n            if (runWhenCanceled) {\n              _classPrivateFieldGet(_this, _internals).onCancelList = _classPrivateFieldGet(_this, _internals).onCancelList.filter(function (callback) {\n                return callback !== onfinally;\n              });\n            }\n\n            return onfinally();\n          }\n        }, _classPrivateFieldGet(this, _internals))), _classPrivateFieldGet(this, _internals));\n      }\n    }, {\n      key: \"cancel\",\n      value: function cancel() {\n        _classPrivateFieldGet(this, _internals).isCanceled = true;\n\n        var callbacks = _classPrivateFieldGet(this, _internals).onCancelList;\n\n        _classPrivateFieldGet(this, _internals).onCancelList = [];\n\n        var _iterator = _createForOfIteratorHelper(callbacks),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var callback = _step.value;\n\n            if (typeof callback === 'function') {\n              try {\n                callback();\n              } catch (err) {\n                console.error(err);\n              }\n            }\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      }\n    }, {\n      key: \"isCanceled\",\n      value: function isCanceled() {\n        return _classPrivateFieldGet(this, _internals).isCanceled === true;\n      }\n    }]);\n\n    return CancelablePromiseInternal;\n  }();\n\n  var CancelablePromise = /*#__PURE__*/function (_CancelablePromiseInt) {\n    _inherits(CancelablePromise, _CancelablePromiseInt);\n\n    var _super = _createSuper(CancelablePromise);\n\n    function CancelablePromise(executor) {\n      _classCallCheck(this, CancelablePromise);\n\n      return _super.call(this, {\n        executor: executor\n      });\n    }\n\n    return _createClass(CancelablePromise);\n  }(CancelablePromiseInternal);\n\n  _exports.CancelablePromise = CancelablePromise;\n\n  _defineProperty(CancelablePromise, \"all\", function all(iterable) {\n    return makeAllCancelable(iterable, Promise.all(iterable));\n  });\n\n  _defineProperty(CancelablePromise, \"allSettled\", function allSettled(iterable) {\n    return makeAllCancelable(iterable, Promise.allSettled(iterable));\n  });\n\n  _defineProperty(CancelablePromise, \"any\", function any(iterable) {\n    return makeAllCancelable(iterable, Promise.any(iterable));\n  });\n\n  _defineProperty(CancelablePromise, \"race\", function race(iterable) {\n    return makeAllCancelable(iterable, Promise.race(iterable));\n  });\n\n  _defineProperty(CancelablePromise, \"resolve\", function resolve(value) {\n    return cancelable(Promise.resolve(value));\n  });\n\n  _defineProperty(CancelablePromise, \"reject\", function reject(reason) {\n    return cancelable(Promise.reject(reason));\n  });\n\n  _defineProperty(CancelablePromise, \"isCancelable\", isCancelablePromise);\n\n  var _default = CancelablePromise;\n  _exports.default = _default;\n\n  function cancelable(promise) {\n    return makeCancelable(promise, defaultInternals());\n  }\n\n  function isCancelablePromise(promise) {\n    return promise instanceof CancelablePromise || promise instanceof CancelablePromiseInternal;\n  }\n\n  function createCallback(onResult, internals) {\n    if (onResult) {\n      return function (arg) {\n        if (!internals.isCanceled) {\n          var result = onResult(arg);\n\n          if (isCancelablePromise(result)) {\n            internals.onCancelList.push(result.cancel);\n          }\n\n          return result;\n        }\n\n        return arg;\n      };\n    }\n  }\n\n  function makeCancelable(promise, internals) {\n    return new CancelablePromiseInternal({\n      internals: internals,\n      promise: promise\n    });\n  }\n\n  function makeAllCancelable(iterable, promise) {\n    var internals = defaultInternals();\n    internals.onCancelList.push(function () {\n      var _iterator2 = _createForOfIteratorHelper(iterable),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var resolvable = _step2.value;\n\n          if (isCancelablePromise(resolvable)) {\n            resolvable.cancel();\n          }\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n    });\n    return new CancelablePromiseInternal({\n      internals: internals,\n      promise: promise\n    });\n  }\n\n  function defaultInternals() {\n    return {\n      isCanceled: false,\n      onCancelList: []\n    };\n  }\n});\n//# sourceMappingURL=CancelablePromise.js.map","// async-each MIT license (by Paul Miller from https://paulmillr.com).\n(function(globals) {\n  'use strict';\n  var each = function(items, next, callback) {\n    if (!Array.isArray(items)) throw new TypeError('each() expects array as first argument');\n    if (typeof next !== 'function') throw new TypeError('each() expects function as second argument');\n    if (typeof callback !== 'function') callback = Function.prototype; // no-op\n\n    if (items.length === 0) return callback(undefined, items);\n\n    var transformed = new Array(items.length);\n    var count = 0;\n    var returned = false;\n\n    items.forEach(function(item, index) {\n      next(item, function(error, transformedItem) {\n        if (returned) return;\n        if (error) {\n          returned = true;\n          return callback(error);\n        }\n        transformed[index] = transformedItem;\n        count += 1;\n        if (count === items.length) return callback(undefined, transformed);\n      });\n    });\n  };\n\n  if (typeof define !== 'undefined' && define.amd) {\n    define([], function() {\n      return each;\n    }); // RequireJS\n  } else if (typeof module !== 'undefined' && module.exports) {\n    module.exports = each; // CommonJS\n  } else {\n    globals.asyncEach = each; // <script>\n  }\n})(this);\n","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!./index.scss?vue&type=style&index=0&id=3f87c0fa&scoped=true&lang=scss&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-3!./index.sass?vue&type=style&index=0&id=e8b463ac&scoped=true&lang=sass&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=a28e80a8&scoped=true&lang=sass&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!./index.scss?vue&type=style&index=0&id=34d15f18&scoped=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"noswipepnt\",attrs:{\"id\":\"chatInput\"}},[(_vm.ready)?_c('div',{staticClass:\"work\"},[(_vm.chat)?_c('div',{staticClass:\"inputWrapper\"},[(_vm.tipusers.length)?_c('div',{staticClass:\"tipusers\"},_vm._l((_vm.tipusers),function(user,i){return _c('div',{key:user.id,staticClass:\"previewWrapperExt\",class:{selected : _vm.tipuserindex == i},on:{\"click\":function($event){return _vm.insertuser(user)}}},[_c('preview',{attrs:{\"contact\":user,\"mode\":\"\"}})],1)}),0):_vm._e(),_c('div',{staticClass:\"center\"},[(_vm.voiceEnable && (_vm.isRecording || _vm.record))?_c('record-progress',{attrs:{\"recordTime\":_vm.recordTime,\"isRecording\":_vm.isRecording,\"rmsData\":_vm.recordRmsData,\"opacity\":_vm.cancelOpacity},on:{\"onClear\":_vm.clear}}):_c('InputField',{ref:\"newinput\",attrs:{\"storagekey\":'chatinput' + _vm.chat.roomId,\"tipusers\":_vm.tipusers},on:{\"chatMessage\":_vm.sendinput,\"emptyInput\":_vm.emitInputData,\"FilledInput\":_vm.HideUploadPic,\"base64\":_vm.pasteImage,\"focused\":_vm.focused,\"tipsearchrequest\":_vm.tipBySearch,\"browsetip\":_vm.browsetip,\"selectcurrenttip\":_vm.selectcurrenttip}}),(_vm.upload && _vm.chat)?_c('div',{staticClass:\"left\",class:{extended: _vm.voiceEnable}},[(!_vm.isRecording && !_vm.record)?_c('div',{staticClass:\"iconbutton\"},[_c('dropdownMenu',{ref:\"dropdownMenu\",attrs:{\"menuItems\":_vm.menuItems,\"rowObject\":{},\"icon\":\"fas fa-plus\"},scopedSlots:_vm._u([{key:\"default\",fn:function(slotProps){return [(!slotProps.item.upload)?_c('div',{staticClass:\"menu-item\",on:{\"click\":function($event){return _vm.menuItemClick(slotProps.item)}}},[_c('div',{staticClass:\"iconWrapper\"},[(slotProps.item.icon)?_c('i',{class:slotProps.item.icon}):_vm._e()]),_c('div',{staticClass:\"title\"},[_vm._v(\" \"+_vm._s(slotProps.item.title)+\" \")])]):_c('upload',{attrs:{\"onlyimage\":slotProps.item.upload.onlyimage,\"multiple\":slotProps.item.upload.multiple,\"extensions\":slotProps.item.upload.extensions,\"images\":slotProps.item.upload.images},on:{\"start\":function (files) { return _vm.uploadStart(slotProps.item, files); },\"uploaded\":function (data) { return _vm.uploadUploaded(slotProps.item, data); },\"uploadedAll\":function (result) { return _vm.uploadUploadedAll(slotProps.item, result); },\"error\":function (error) { return _vm.uploadError(slotProps.item, error); }},scopedSlots:_vm._u([{key:\"content\",fn:function(){return [_c('div',{staticClass:\"menu-item\"},[_c('div',{staticClass:\"iconWrapper\"},[(slotProps.item.icon)?_c('i',{class:slotProps.item.icon}):_vm._e()]),_c('div',{staticClass:\"title\"},[_vm._v(\" \"+_vm._s(slotProps.item.title)+\" \")])])]},proxy:true},{key:\"dropzone\",fn:function(){return undefined},proxy:true}],null,true)})]}}],null,false,3187246467)})],1):_vm._e(),(_vm.voiceEnable)?[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:((_vm.isRecording || !_vm.record)),expression:\"(isRecording || !record)\"}],staticClass:\"iconbutton\"},[_c('recordVoice',{attrs:{\"prepareRecording\":_vm.prepareRecording ? true : false,\"isRecording\":_vm.isRecording,\"disabled\":_vm.microphoneDisabled},on:{\"onRecordingStart\":_vm.initRecording,\"onRecordingStop\":_vm.stopRecording,\"onClear\":_vm.clear,\"canceling\":_vm.setOpacity}})],1)]:_vm._e(),(!_vm.isRecording && _vm.record)?_c('div',{staticClass:\"iconbutton\",on:{\"click\":function (e) {_vm.sendVoiceMessage()}}},[_vm._m(0)]):_vm._e()],2):_vm._e()],1)]):_vm._e()]):_c('div',{staticClass:\"notready\"},[_c('linepreloader')],1)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('i',{staticClass:\"icon fas fa-paper-plane\"})])}]\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"recordButton_wrapper\"},[_c('div',{ref:\"holder\",staticClass:\"recordButton_holder\",class:{hold: _vm.isHold}},[_c('i',{staticClass:\"icon fas\",class:_vm.isHold ? 'fa-lock': 'fa-lock-open'})]),(!_vm.isHold)?_c('div',{ref:\"toggle\",staticClass:\"recordButton_micro recordButton_main\",class:{active: _vm.isRecording, disabled: _vm.disabled},on:{\"mousedown\":_vm.mousedown,\"mouseup\":_vm.mouseup,\"touchstart\":_vm.handleTouchStart,\"touchend\":_vm.handleTouchEnd,\"touchcancel\":_vm.handleTouchEnd}},[_c('i',{staticClass:\"icon fas fa-microphone\"})]):_vm._e(),(_vm.isHold)?_c('div',{ref:\"stop\",staticClass:\"recordButton_stop recordButton_main\",on:{\"click\":_vm.recordEnd}},[_c('i',{staticClass:\"icon fas fa-stop\"})]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { mapState } from 'vuex';\r\n\r\nexport default {\r\n\tname: \"recordVoice\",\r\n\tprops: {\r\n\t\tisRecording: {\r\n\t\t\ttype: Boolean,\r\n\t\t\trequired: true\r\n\t\t},\r\n\t\tprepareRecording: {\r\n\t\t\ttype: Boolean\r\n\t\t},\r\n\t\tdisabled: Boolean,\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tstart: 0,\r\n\t\t\tisHold: false,\r\n\t\t\tdirection: null\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState({\r\n\t\t\tmobile: state => state.mobile,\r\n\t\t})\r\n\t},\r\n\tmounted() {\r\n\t\r\n\t},\r\n\tbeforeDestroy() {\r\n\r\n\t\tdocument.removeEventListener('mousemove', this.handleMove)\r\n\t\tdocument.removeEventListener('touchmove', this.handleMove)\r\n\r\n\t\tif (this.isRecording) {\r\n\t\t\tthis.$emit('onRecordingStop', {cancel : true})\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\r\n\t\tmouseup : function(e){\r\n\t\t\tif(!this.mobile)\r\n\t\t\t\tthis.handleTouchEnd(e)\r\n\t\t},\r\n\r\n\t\tmousedown : function(e){\r\n\t\t\tif(!this.mobile)\r\n\t\t\t\tthis.handleTouchStart(e)\r\n\t\t},\r\n\t\t\r\n\t\thandleTouchStart(e) {\r\n\r\n\r\n\t\t\tif(!this.isRecording) {\r\n\t\t\t\tthis.$emit('onRecordingStart')\r\n\t\t\t}\r\n\r\n\t\t\telse{\r\n\t\t\t\tif(this.isHold) return\r\n\t\t\t}\r\n\r\n\t\t\tthis.start = {\r\n\t\t\t\tY: e.changedTouches ? e.changedTouches[0].pageY : e.pageY,\r\n\t\t\t\tX: e.changedTouches ? e.changedTouches[0].pageX : e.pageX\r\n\t\t\t}\r\n\r\n\t\t\tif(!this.mobile)\r\n\t\t\t\tdocument.addEventListener('mousemove', this.handleMove)\r\n\t\t\telse\r\n\t\t\t\tdocument.addEventListener('touchmove', this.handleMove)\r\n\r\n\t\t},\r\n\t\thandleTouchEnd(e) {\r\n\r\n\t\t\tif (this.isHold) return\r\n\r\n\t\t\tif (this.isRecording || this.prepareRecording) {\r\n\t\t\t\tthis.$emit('onRecordingStop', {\r\n\t\t\t\t\tsendnow : true\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tdocument.removeEventListener('mousemove', this.handleMove)\r\n\t\t\tdocument.removeEventListener('touchmove', this.handleMove)\r\n\r\n\t\t\tthis.clearStyle()\r\n\r\n\t\t},\r\n\r\n\t\tclearStyle(){\r\n\r\n\t\t\tif (this.$refs.toggle){\r\n\t\t\t\tthis.$refs.toggle.style.transform = `translate(0,0)`\r\n\t\t\t\tthis.$refs.toggle.classList.remove('outside')\r\n\t\t\t}\r\n\r\n\t\t\tif (this.$refs.holder){\r\n\t\t\t\tthis.$refs.holder.classList.remove('active')\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\thandleMove(e) {\r\n\r\n\t\t\tif(!this.isRecording) return\r\n\r\n\t\t\tlet deltaY = this.start.Y - e.pageY\r\n\t\t\tlet deltaX = this.start.X - e.pageX\r\n\r\n\t\t\tif (e?.changedTouches?.length) {\r\n\t\t\t\tdeltaY = this.start.Y - e.changedTouches[0].pageY\r\n\t\t\t\tdeltaX = this.start.X - e.changedTouches[0].pageX\r\n\t\t\t}\r\n\r\n\t\t\tif (deltaY > 5 && deltaX < 5) {\r\n\t\t\t\tthis.direction = 'Y'\r\n\t\t\t} else {\r\n\t\t\t\tthis.direction = 'X'\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif (deltaY > 5 && this.direction === 'Y') {\r\n\r\n\t\t\t\tif(!this.$refs.holder.classList.contains('active'))\r\n\t\t\t\t\tthis.$refs.holder.classList.add('active')\r\n\r\n\t\t\t\tthis.$refs.toggle.style.transform = `translate(0,-${deltaY}px)`\r\n\r\n\t\t\t\tif (deltaY > 70) {\r\n\t\t\t\t\tthis.$refs.toggle.style.transform = `translate(0,0)`\r\n\r\n\t\t\t\t\tdocument.removeEventListener('mousemove', this.handleMove)\r\n\t\t\t\t\tdocument.removeEventListener('touchmove', this.handleMove)\r\n\t\t\t\t\t//document.removeEventListener('mouseup', this.handleTouchEnd)\r\n\r\n\t\t\t\t\tthis.isHold = true\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t} else if (deltaX > 5 && this.direction === 'X') {\r\n\r\n\t\t\t\tthis.$refs.toggle.style.transform = `translate(-${deltaX}px, 0)`\r\n\r\n\t\t\t\tif(!this.$refs.holder.classList.contains('outside'))\r\n\t\t\t\t\tthis.$refs.toggle.classList.add('outside')\r\n\r\n\t\t\t\tthis.$emit('canceling', (deltaX - 5) / 130)\r\n\t\t\t\t\r\n\t\t\t\tif (deltaX > 130) {\r\n\t\t\t\t\tthis.$refs.toggle.style.transform = `translate(0,0)`\r\n\t\t\t\t\tdocument.removeEventListener('mousemove', this.handleMove)\r\n\t\t\t\t\tdocument.removeEventListener('touchmove', this.handleMove)\r\n\t\t\t\t\t//document.removeEventListener('mouseup', this.handleTouchEnd)\r\n\t\t\t\t\tthis.$emit('onRecordingStop', { cancel: true })\r\n\t\t\t\t\tthis.$emit('onClear')\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.clearStyle()\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\trecordEnd(e) {\r\n\r\n\t\t\tthis.clearStyle()\r\n\r\n\t\t\tif (this.isRecording && this.isHold) {\r\n\r\n\t\t\t\tthis.$emit('onRecordingStop', {})\r\n\t\t\t\tthis.isHold = false\r\n\r\n\t\t\t\treturn\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t\r\n\t}\r\n}","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!./index.js?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!./index.js?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=34d15f18&scoped=true&\"\nimport script from \"./index.js?vue&type=script&lang=js&\"\nexport * from \"./index.js?vue&type=script&lang=js&\"\nimport style0 from \"./index.scss?vue&type=style&index=0&id=34d15f18&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"34d15f18\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"recordProgress\"},[(_vm.isRecording)?_c('div',{staticClass:\"indicatorWrapper\"},[_c('div',{staticClass:\"indicator\",class:{'recording': _vm.isRecording}})]):_c('div',{staticClass:\"del\",on:{\"click\":_vm.clear}},[_c('i',{staticClass:\"fas fa-trash\"})]),_c('div',{staticClass:\"timer\"},[_vm._v(_vm._s(_vm.timer))]),_c('div',{ref:\"graph\",staticClass:\"graph\"},[_c('canvas',{ref:\"canvas\",attrs:{\"id\":\"canvas\",\"width\":_vm.width,\"height\":\"20\"}})]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isRecording && _vm.opacity),expression:\"isRecording && opacity\"}],ref:\"cancel\",staticClass:\"cancel\"},[_c('span',[_vm._v(\"Slide left to cancel\")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default {\r\n  name: \"recordProgress\",\r\n  props: {\r\n    recordTime: {\r\n      type: Number,\r\n      required: true\r\n    },\r\n    rmsData: {\r\n      type: Array,\r\n      required: true\r\n    },\r\n    isRecording: {\r\n      type: Boolean\r\n    },\r\n    opacity: {}\r\n  },\r\n  data() {\r\n    return {\r\n      width: 0,\r\n    }\r\n  },\r\n  computed: {\r\n    timer() {\r\n      let minute = Math.floor(this.recordTime / 60000)\r\n      let sec = Math.floor(this.recordTime / 1000) % 60\r\n      return `${minute ? minute + ':' : '0:'}${(sec < 10) ? '0' + sec : sec}`\r\n    },\r\n\r\n    rmsDataLast(){\r\n      return _.last(this.rmsData, 25)\r\n    }\r\n  },\r\n\r\n  watch : {\r\n    rmsData : _.throttle(function(){\r\n      this.draw()\r\n    }, 30),\r\n\r\n    opacity : function(){\r\n      this.$refs.cancel.style.opacity = this.opacity\r\n    }\r\n  },\r\n\r\n  mounted() {\r\n    this.$refs.cancel.style.opacity = 0\r\n    let width = this.$refs.graph.offsetWidth\r\n    this.width = width - width % 100\r\n\r\n    window.addEventListener(\"resize\", this.resize);\r\n  },\r\n  beforeDestroy() {\r\n    window.removeEventListener('resize', this.resize)\r\n  },\r\n\r\n  methods: {\r\n    resize() {\r\n      let timer = null\r\n\r\n      var re = () => {\r\n        if (!timer) {\r\n          timer = setTimeout(() => {\r\n            timer = null\r\n            let width = this.$refs.graph.offsetWidth\r\n            this.width = width - width % 100\r\n          }, 50)\r\n        }\r\n      }\r\n\r\n      re()\r\n    },\r\n    draw() {\r\n\r\n      if(!this.$refs.canvas) return\r\n\r\n      const ctx = this.$refs.canvas.getContext(`2d`);\r\n      let x = 0\r\n      let count = 50\r\n      let width = 2 //this.width / 200\r\n      var l = this.rmsDataLast.length\r\n      var c = Math.max(Math.floor(l / count), 1)\r\n\r\n      ctx.clearRect(0, 0, this.width, 20);\r\n\r\n      for (let i = 0; i < l; i = i + c) {\r\n        ctx.fillStyle = '#00a4ff'\r\n        ctx.fillRect(i * 2 * width, 10 - this.rmsDataLast[i] / 8, width, this.rmsDataLast[i] / 4 + 1)\r\n      }\r\n\r\n    },\r\n    clear() {\r\n      this.$emit('onClear')\r\n    }\r\n  }\r\n}","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!./index.js?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!./index.js?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=3f87c0fa&scoped=true&\"\nimport script from \"./index.js?vue&type=script&lang=js&\"\nexport * from \"./index.js?vue&type=script&lang=js&\"\nimport style0 from \"./index.scss?vue&type=style&index=0&id=3f87c0fa&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3f87c0fa\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"upload\"},[_c('div',{staticClass:\"uploadWrapper\"},[_c('div',{staticClass:\"contentWrapper\"},[_vm._t(\"content\",function(){return [_c('i',{staticClass:\"fas fa-plus\"})]})],2),_c('div',{staticClass:\"inputWrapper\"},[_c('input',{attrs:{\"type\":\"file\",\"multiple\":_vm.multiple},on:{\"change\":_vm.upload}})])]),(_vm.dropzone)?_c('div',{ref:\"dropzone\",staticClass:\"dropzone\",class:{dropzone : _vm.dropzone}},[_vm._t(\"dropzone\",function(){return [_c('i',{staticClass:\"fas fa-plus\"}),_vm._v(\" \"+_vm._s(_vm.$t(\"caption.dragAndDropAFile\"))+\" \")]})],2):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"upload\">\r\n    <div class=\"uploadWrapper\">\r\n\r\n      <div class=\"contentWrapper\">\r\n        <slot name=\"content\">\r\n          <i class=\"fas fa-plus\"></i>\r\n        </slot>\r\n      </div>\r\n      <div class=\"inputWrapper\">\r\n        <input type=\"file\" :multiple=\"multiple\" @change=\"upload\"> \r\n      </div>\r\n\r\n    </div>\r\n\r\n    <div class=\"dropzone\" :class=\"{dropzone : dropzone}\" v-if=\"dropzone\" ref=\"dropzone\">\r\n      <slot name=\"dropzone\">\r\n        <i class=\"fas fa-plus\"></i> {{ $t(\"caption.dragAndDropAFile\") }}\r\n      </slot>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n\r\n<style scoped lang=\"sass\">\r\n\r\n  .upload\r\n    width: 100%\r\n\r\n  .uploadWrapper\r\n    position: relative\r\n\r\n    .inputWrapper\r\n      position: absolute\r\n      left: 0\r\n      right: 0\r\n      top: 0\r\n      bottom: 0\r\n      opacity: 0\r\n\r\n      input\r\n        position: absolute\r\n        left: 0\r\n        right: 0\r\n        top: 0\r\n        bottom: 0\r\n        opacity: 0\r\n\r\n</style>\r\n\r\n<script>\r\n\r\nimport Images from '@/application/utils/images.js'\r\n\r\n\r\nvar each = require('async-each');\r\n\r\nvar images = new Images()\r\n\r\nexport default {\r\n  name: 'upload',\r\n  directives: {},\r\n  props: {\r\n\r\n    dropzone: String,\r\n    multiple: Boolean,\r\n\r\n    onlyimage : Boolean,\r\n\r\n    maxsize: {\r\n      default: 25,\r\n      type: Number\r\n    },\r\n\r\n    extensions: {\r\n      type: Array,\r\n      default: () => []\r\n    },\r\n    images: {\r\n      type: Object,\r\n      default: () => {\r\n      }\r\n    }\r\n\r\n  },\r\n\r\n  data: function () {\r\n    return {\r\n      loading: false\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    maxSize() {\r\n      return this.maxsize * 1024 * 1024\r\n    }\r\n  },\r\n\r\n  created: () => {\r\n\r\n  },\r\n  methods: {\r\n    \r\n    read: function (file) {\r\n      var reader = new FileReader();\r\n\r\n      return new Promise((resolve, reject) => {\r\n        reader.onloadend = function (e) {\r\n\r\n          resolve({\r\n            base64: e.target.result,\r\n            file: file\r\n          })\r\n\r\n        }\r\n        reader.readAsDataURL(file);\r\n      })\r\n\r\n\r\n    },\r\n    upload: function (event) {\r\n      event.stopPropagation();\r\n      event.preventDefault();\r\n\r\n      var files = event.dataTransfer?.files || event.target?.files || event.files || [];\r\n      var result = {}\r\n\r\n      this.loading = true\r\n\r\n      this.$emit('start', files)\r\n\r\n      var ha = this\r\n\r\n      each(_.toArray(files), (file, next) => {\r\n\r\n        var error = this.check(file)\r\n\r\n        if (error) {\r\n          \r\n          ha.$emit('error', {\r\n            error: error,\r\n            file: file,\r\n            text: this.errorText(error, file)\r\n          })\r\n\r\n          next(new Error(error))\r\n\r\n          return\r\n        }\r\n\r\n        this.read(file).then(data => {\r\n\r\n          result[data.file.name] = data\r\n\r\n          return this.handle(data)\r\n\r\n        }).then(data => {\r\n\r\n          ha.$emit('uploaded', data)\r\n          next()\r\n\r\n        }).catch(e => {\r\n\r\n          ha.$emit('error', {\r\n            error: e,\r\n            file: file,\r\n            text: this.errorText(e, file)\r\n          })\r\n\r\n          next(new Error(error))\r\n\r\n        })\r\n\r\n      }, (err) => {\r\n\r\n        this.loading = false\r\n        ha.$emit('uploadedAll', result)\r\n\r\n      })\r\n\r\n    },\r\n\r\n    errorText: function (error, file) {\r\n      if (error === 'filesize') {\r\n        return \"File Size Error: (\" + file.name + \"). The File can't be more than \"+this.maxsize+\" mbytes\"\r\n      }\r\n\r\n      if (error === 'fileext') {\r\n        return \"File Extension Error:\" + file.name\r\n      }\r\n    },\r\n\r\n    check: function (file) {\r\n      if (!this.checkSize(file)) {\r\n        return 'filesize'\r\n      }\r\n\r\n      if (!this.checkExtension(file)) {\r\n        return 'fileext'\r\n      }\r\n\r\n    },\r\n    checkSize: function (file) {\r\n      return file.size <= this.maxSize\r\n    },\r\n    getExtension: function (file) {\r\n      var name = file.name.split('.');\r\n      var ext = name[name.length - 1].toLowerCase();\r\n\r\n      return ext;\r\n    },\r\n    checkExtension: function (file) {\r\n\r\n      if (this.extensions.length) {\r\n        if (_.indexOf(this.extensions, this.getExtension(file)) == -1) return false\r\n      }\r\n\r\n      return true;\r\n    },\r\n    handle: function (data) {\r\n\r\n      if (data.file.type === 'image/jpeg' || data.file.type === 'image/png' || data.file.type === 'image/webp') {\r\n        return this.handleImages(data)\r\n      }\r\n      \r\n      return Promise.resolve(data)\r\n    },\r\n    sendAnyFile: function (data) {\r\n      this.$emit('anyFile', data)\r\n    },\r\n    resizeIfNeed : function(base64, ftype){\r\n      if (this.images.resize) {\r\n\r\n          var type = this.images.resize.type || 'def'\r\n          \r\n          return images.resize[type](base64, this.images.resize.width || 1024, this.images.resize.height || 1024, ftype, this.images.resize.quality || 0.85).then(base64 => {\r\n\r\n\r\n            return Promise.resolve(base64)\r\n          }).catch(e => {\r\n            return Promise.reject(e)\r\n          })\r\n\r\n        }\r\n        return Promise.resolve(base64)\r\n    },\r\n    handleImages: function (data) {\r\n\r\n      return images.autorotation(data.file, data.base64).then(base64 => {\r\n        data.base64 = base64\r\n\r\n        return Promise.resolve(data)\r\n      }).then(data => {\r\n\r\n        return this.resizeIfNeed(data.base64, data.file.type).then(base64 => {\r\n          data.base64 = base64\r\n\r\n          return Promise.resolve(data)\r\n        })\r\n\r\n        if (this.images.resize) {\r\n\r\n          var type = this.images.resize.type || 'def'\r\n          \r\n          return images.resize[type](data.base64, this.images.resize.width || 1024, this.images.resize.height || 1024, data.file.type, this.images.resize.quality || 0.85).then(base64 => {\r\n\r\n            data.base64 = base64\r\n\r\n            return Promise.resolve(data)\r\n          }).catch(e => {\r\n            return Promise.reject(e)\r\n          })\r\n\r\n        }\r\n        return Promise.resolve(data)\r\n      })\r\n\r\n\r\n    }\r\n\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=a28e80a8&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=a28e80a8&scoped=true&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a28e80a8\",\n  null\n  \n)\n\nexport default component.exports","import f from \"@/application/functions\";\r\nimport InputField from './InputField/InputField.vue'\r\nimport recordVoice from '@/components/assets/recordVoice/index.vue';\r\nimport { mapState } from \"vuex\";\r\nimport Images from '@/application/utils/images.js'\r\n\r\nimport contacts from '@/components/contacts/list/index.vue'\r\nimport preview from '@/components/contacts/preview/index.vue'\r\nimport recordProgress from '@/components/assets/recordProgress/index.vue';\r\n\r\nimport upload from '@/components/assets/upload/index.vue';\r\n\r\nimport { cancelable } from 'cancelable-promise';\r\nexport default {\r\n\tname: 'chatInput',\r\n\tprops: {\r\n\t\tchat: Object,\r\n\t\tu: String,\r\n\t\trelationEvent: Object\r\n\t},\r\n\r\n\tcomponents: { InputField, contacts, preview, recordProgress, recordVoice, upload },\r\n\r\n\tdata: function () {\r\n\r\n\t\treturn {\r\n\t\t\tupload: true,\r\n\t\t\ttest: [],\r\n\t\t\tloading: false,\r\n\t\t\ttext: '',\r\n\t\t\tfile: {},\r\n\t\t\tfileInfo: {},\r\n\t\t\tready: false,\r\n\t\t\tcreating: false,\r\n\t\t\tuserId: '',\r\n\t\t\tshowuserselect: null,\r\n\t\t\tanyUrlMeta: String,\r\n\t\t\tjoinedMembers: [],\r\n\t\t\ttipvalue: null,\r\n\t\t\ttipuserindex: 0,\r\n\t\t\trecord: null,\r\n\t\t\trecordRmsData: [],\r\n\t\t\tisRecording: false,\r\n\r\n\t\t\tmediaRecorder: null,\r\n\t\t\taudioContext: null,\r\n\t\t\taudioAnalyser: null,\r\n\r\n\t\t\trecordTime: 0,\r\n\t\t\tinterval: null,\r\n\t\t\tcancelOpacity: 0,\r\n\t\t\tmicrophoneDisabled: false,\r\n\t\t\tprepareRecording: false,\r\n\r\n\t\t\tcancelledCordovaMediaRecorder: false\r\n\t\t}\r\n\r\n\t},\r\n\r\n\r\n\twatch: {\r\n\t\tusersForKeysHash: {\r\n\t\t\t//immediate: true,\r\n\t\t\thandler: function () {\r\n\t\t\t}\r\n\t\t},\r\n\t\ttipusers: function () {\r\n\r\n\t\t\tif (!this.tipusers.length) {\r\n\t\t\t\tthis.tipuserindex = 0\r\n\t\t\t} else {\r\n\t\t\t\tif (this.tipuserindex > this.tipusers.length - 1) {\r\n\t\t\t\t\tthis.tipuserindex = this.tipusers.length - 1\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t}\r\n\t},\r\n\r\n\tbeforeDestroy() {\r\n\t\tif (this.audioContext)\r\n\t\t\tthis.audioContext.close()\r\n\t},\r\n\r\n\tcomputed: {\r\n\t\tvoiceEnable() {\r\n\t\t\treturn this.$store.state.voiceMessagesEnabled\r\n\t\t},\r\n\r\n\t\tconnect: function () {\r\n\t\t\treturn this.$store.state.contact\r\n\t\t},\r\n\t\tpkoindisabled : function(){\r\n\t\t\treturn this.$store.state.pkoindisabled\r\n\t\t},\r\n\t\tmenuItems: function () {\r\n\t\t\tvar menuItems = []\r\n\r\n\t\t\t\r\n\t\t\tif (window.POCKETNETINSTANCE) {\r\n\t\t\t\tif(window.POCKETNETINSTANCE.mobile.supportimagegallery()) {\r\n\t\t\t\t\tmenuItems.push({\r\n\t\t\t\t\t\tclick: \"cameraHandlerCustom\",\r\n\t\t\t\t\t\ttitle: this.$i18n.t(\"button.takePhotoOrVideo\"),\r\n\t\t\t\t\t\ticon: \"fas fa-camera\",\r\n\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tmenuItems.push({\r\n\t\t\t\t\tclick: \"cameraHandler\",\r\n\t\t\t\t\ttitle: this.$i18n.t(\"button.takePhotoOrVideo\"),\r\n\t\t\t\t\ticon: \"fas fa-camera\",\r\n\r\n\t\t\t\t\tupload: {\r\n\t\t\t\t\t\tmultiple: true,\r\n\t\t\t\t\t\textensions: ['jpg', 'jpeg', 'png', 'webp'],\r\n\t\t\t\t\t\tmaxsize: 100,\r\n\t\t\t\t\t\timages: {\r\n\t\t\t\t\t\t\tresize: {\r\n\t\t\t\t\t\t\t\ttype: 'fit'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\r\n\r\n\t\t\tmenuItems.push({\r\n\t\t\t\tclick: \"fileHandler\",\r\n\t\t\t\ttitle: this.$i18n.t(\"button.sendFile\"),\r\n\t\t\t\ticon: \"fas fa-sticky-note\",\r\n\r\n\t\t\t\tupload: {\r\n\t\t\t\t\tmultiple: true,\r\n\t\t\t\t\textensions: [],\r\n\t\t\t\t\tmaxsize: 25,\r\n\t\t\t\t\timages: {\r\n\t\t\t\t\t\tresize: {\r\n\t\t\t\t\t\t\ttype: 'fit'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t})\r\n\t\t\t\r\n\r\n\r\n\t\t\tif (this.transaction && !this.pkoindisabled) {\r\n\t\t\t\tmenuItems.unshift({\r\n\t\t\t\t\tclick: \"sendtransactionWrapper\",\r\n\t\t\t\t\ttitle: this.$i18n.t(\"button.sendCoins\"),\r\n\t\t\t\t\ticon: \"fas fa-wallet\"\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t}\r\n\r\n\t\t\treturn menuItems\r\n\t\t},\r\n\t\t...mapState([\r\n\t\t\t'chats'\r\n\t\t]),\r\n\r\n\t\tuserlist: function () {\r\n\r\n\r\n\t\t\tif (!this.chat) return []\r\n\r\n\t\t\treturn this.core.mtrx.chatUsersInfo(this.chat.roomId, 'anotherChatUsers')\r\n\r\n\t\t},\r\n\r\n\t\ttransaction: function () {\r\n\t\t\treturn f.deep(window, 'POCKETNETINSTANCE.platform.ui.wallet.send')\r\n\t\t},\r\n\r\n\t\tuusers: function () {\r\n\t\t\tif (this.u) {\r\n\t\t\t\treturn _.map(this.u.split(','), (u) => {\r\n\t\t\t\t\treturn u\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\treturn []\r\n\t\t},\r\n\t\tausers: function () {\r\n\t\t\tif (this.u) {\r\n\t\t\t\treturn _.map(this.u.split(','), (u) => {\r\n\t\t\t\t\treturn this.core.user.matrixId(u)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\treturn []\r\n\t\t},\r\n\t\tstateChat: function () {\r\n\t\t\tvar id = this.$route.query.id\r\n\t\t\treturn this.$store.state.chatsMap[id]\r\n\t\t},\r\n\t\tinvited: function () {\r\n\r\n\t\t\tif (!this.chat) {\r\n\t\t\t\tif (this.u) return this.ausers\r\n\t\t\t\treturn []\r\n\t\t\t}\r\n\r\n\t\t\treturn _.map(_.filter(this.chat.currentState.getMembers(), function (m, v) {\r\n\t\t\t\treturn m.membership === 'invite'\r\n\t\t\t}), function (u) {\r\n\t\t\t\treturn u.userId\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\tjoined: function () {\r\n\r\n\t\t\tif (!this.chat) return []\r\n\r\n\t\t\tlet roomId = this.chat.roomId\r\n\t\t\tlet self = this\r\n\t\t\tlet arr = []\r\n\t\t\tlet members = 0\r\n\r\n\t\t\tthis.chat.currentState.getMembers().forEach(function (user) {\r\n\t\t\t\tif (user.membership === 'join') {\r\n\t\t\t\t\tarr.push(user.userId)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\treturn arr\r\n\t\t},\r\n\r\n\t\ttipusers: function () {\r\n\r\n\t\t\tif (this.tipvalue === null) return []\r\n\t\t\tif (this.tipvalue === '') return this.userlist\r\n\r\n\t\t\tvar value = this.tipvalue.toLowerCase()\r\n\r\n\t\t\tvar u = _.filter(this.userlist, function (u) {\r\n\t\t\t\treturn u.name.toLowerCase().indexOf(value) == 0 && u.name.toLowerCase() != value\r\n\t\t\t})\r\n\r\n\t\t\treturn u\r\n\r\n\t\t},\r\n\r\n\t\tmaintipuser: function () {\r\n\t\t\tif (this.tipusers.length) {\r\n\t\t\t\treturn this.tipusers[this.tipuserindex || 0]\r\n\t\t\t}\r\n\r\n\t\t\treturn null\r\n\t\t},\r\n\t},\r\n\r\n\tcreated() {\r\n\r\n\t},\r\n\r\n\t///\r\n\r\n\tmounted() {\r\n\t\tthis.ready = true\r\n\r\n\t\tif (!this.chat && this.core.mtrx.client) {\r\n\t\t\tthis.newchat().catch(e => {\r\n\t\t\t\treturn Promise.resolve()\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tmethods: {\r\n\t\twait: function () {\r\n\t\t\treturn this.$f.pretry(() => {\r\n\t\t\t\treturn this.core.mtrx.client && this.core.mtrx.access\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\tbrowsetip: function (increase) {\r\n\r\n\t\t\tincrease ? this.tipuserindex++ : this.tipuserindex--\r\n\r\n\t\t\tif (this.tipuserindex > this.tipusers.length - 1) {\r\n\t\t\t\tthis.tipuserindex = 0\r\n\t\t\t}\r\n\r\n\t\t\tif (this.tipuserindex < 0) {\r\n\t\t\t\tthis.tipuserindex = this.tipusers.length - 1\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tselectcurrenttip: function () {\r\n\t\t\tthis.insertuser(this.tipusers[this.tipuserindex || 0])\r\n\t\t},\r\n\r\n\t\tinsertuser: function (user = {}) {\r\n\t\t\tvar name = user.name || ''\r\n\r\n\t\t\tthis.$refs['newinput'].inserttip(name)\r\n\t\t},\r\n\r\n\t\ttipBySearch: function (value) {\r\n\t\t\tthis.tipvalue = value\r\n\t\t},\r\n\r\n\t\tshowuserselected: function (contact, action) {\r\n\t\t\tthis[action](contact)\r\n\t\t},\r\n\r\n\r\n\t\tresizeImage: function (base64) {\r\n\r\n\t\t\tvar ftype = base64.split(';')[0].split('/')[1];\r\n\t\t\tvar images = new Images()\r\n\r\n\t\t\treturn images.resize['fit'](base64, 1024, 1024, ftype, 0.95).then(base64 => {\r\n\r\n\t\t\t\treturn Promise.resolve(base64)\r\n\t\t\t}).catch(e => {\r\n\t\t\t\treturn Promise.reject(e)\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\tcameraHandlerCustom: function () {\r\n\t\t\tvar result = []\r\n\r\n\t\t\tthis.$refs.dropdownMenu.hidePopup();\r\n\r\n\t\t\twindow.POCKETNETINSTANCE.platform.ui.uploadImage({\r\n\t\t\t\tmultiple: true,\r\n\r\n\t\t\t\taction: ({ base64 }, resolve) => {\r\n\r\n\r\n\t\t\t\t\treturn this.resizeImage(base64).then(base64 => {\r\n\r\n\t\t\t\t\t\treturn f.Base64.toFile(base64).then(file => {\r\n\t\t\t\t\t\t\tvar data = {\r\n\t\t\t\t\t\t\t\tbase64,\r\n\t\t\t\t\t\t\t\tfile\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tresult.push(data)\r\n\r\n\t\t\t\t\t\t\tthis.uploadUploaded(null, data)\r\n\r\n\t\t\t\t\t\t\tresolve()\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t}).catch(e => {\r\n\t\t\t\t\t\tconsole.error(e)\r\n\t\t\t\t\t\tresolve()\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tonSuccess: (imgs) => {\r\n\t\t\t\t\tthis.uploadUploadedAll()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\tsendtransactionWrapper: function () {\r\n\r\n\t\t\tthis.menuIsVisible = false\r\n\r\n\t\t\tvar users = _.filter(_.map(this.joined, (j) => {\r\n\t\t\t\treturn this.$f.deep(this, '$store.state.users.' + this.$f.getmatrixid(j)) || null\r\n\t\t\t}), (r) => {\r\n\t\t\t\treturn r && r.source && r.id != this.core.user.userinfo?.id\r\n\t\t\t})\r\n\r\n\t\t\tif (!users.length) {\r\n\r\n\t\t\t\treturn 'users.length'\r\n\t\t\t}\r\n\r\n\t\t\tif (users.length > 1) {\r\n\r\n\t\t\t\tthis.core.store.commit('setmodal', {\r\n\t\t\t\t\tcaption: this.$i18n.t(\"caption.sendTransactionTo\"),\r\n\t\t\t\t\ttype: 'showuserselect',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tusers: users,\r\n\t\t\t\t\t\taction: 'sendtransaction',\r\n\t\t\t\t\t\tuserselected: (c) => {\r\n\t\t\t\t\t\t\tthis.showuserselected(c, 'sendtransaction')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\t/*this.showuserselect = {\r\n\t\t\t\t  users : users,\r\n\t\t\t\t  action : 'sendtransaction'\r\n\t\t\t\t}*/\r\n\t\t\t} else {\r\n\t\t\t\tthis.sendtransaction(users[0])\r\n\t\t\t}\r\n\r\n\r\n\t\t\tthis.$refs.dropdownMenu.hidePopup();\r\n\r\n\t\t},\r\n\r\n\t\tsendtransaction: function (user) {\r\n\t\t\tvar api = this.transaction\r\n\r\n\t\t\t//TODO get address and send transaction\r\n\r\n\t\t\tapi({\r\n\t\t\t\troomid: this.chat.roomId,\r\n\t\t\t\taddress: user.source.address\r\n\t\t\t})\r\n\r\n\t\t\t/*.then(({txid, from}) => {\r\n\r\n\t\t\t  return this.core.mtrx.transaction(this.chat.roomId, txid)\r\n\r\n\t\t\t})*/\r\n\r\n\t\t},\r\n\r\n\t\temitInputData: function () {\r\n\t\t\tthis.$emit('emptyInput')\r\n\t\t\tthis.upload = true\r\n\t\t},\r\n\r\n\t\tHideUploadPic() {\r\n\t\t\tthis.upload = false\r\n\t\t},\r\n\r\n\t\temitUrl: function (url) {\r\n\t\t\tthis.$emit('setMetaUrl', url)\r\n\t\t},\r\n\r\n\t\tnewchat() {\r\n\r\n\t\t\tif (this.u) {\r\n\t\t\t\tthis.$store.state.globalpreloader = true\r\n\t\t\t\tvar matrixId = null\r\n\t\t\t\tvar myMatrixId = null\r\n\t\t\t\tvar chat = null\r\n\t\t\t\tvar id = ''\r\n\r\n\t\t\t\tthis.creating = true\r\n\t\t\t\treturn this.core.user.usersInfo(this.uusers).then(info => {\r\n\r\n\t\t\t\t\tif (this.uusers.length == 1) {\r\n\r\n\t\t\t\t\t\tvar _info = info[0]\r\n\r\n\t\t\t\t\t\tif (!_info || !_info.keys || _info.keys.length < 12) {\r\n\r\n\t\t\t\t\t\t\tthis.$emit('cantchatcrypto')\r\n\t\t\t\t\t\t\treturn Promise.reject('ny2')\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.core.user.userinfo.keys.length < 12) {\r\n\t\t\t\t\t\tthis.$emit('cantchatcrypto')\r\n\t\t\t\t\t\treturn Promise.reject('ny2')\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t//return Promise.reject('ny3')\r\n\r\n\t\t\t\t\tid = this.core.mtrx.kit.tetatetid(info[0], this.core.user.userinfo)\r\n\r\n\t\t\t\t\tmatrixId = this.core.user.matrixId(info[0].id)\r\n\t\t\t\t\tmyMatrixId = this.core.user.matrixId(this.core.user.userinfo.id)\r\n\r\n\t\t\t\t\tvar initialstate = [{\r\n\t\t\t\t\t\t\"type\": \"m.set.encrypted\",\r\n\t\t\t\t\t\t\"state_key\": \"\",\r\n\t\t\t\t\t\t\"content\": {\r\n\t\t\t\t\t\t\tencrypted: true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\r\n\t\t\t\t\treturn this.core.mtrx.client.createRoom(\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\troom_alias_name: id,\r\n\t\t\t\t\t\t\tvisibility: 'private',\r\n\t\t\t\t\t\t\tinvite: [matrixId],\r\n\t\t\t\t\t\t\tname: '#' + id,\r\n\t\t\t\t\t\t\tinitial_state: initialstate\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t)\r\n\r\n\t\t\t\t}).then(_chat => {\r\n\r\n\t\t\t\t\tchat = _chat\r\n\t\t\t\t\tthis.$store.state.globalpreloader = false\r\n\r\n\t\t\t\t\tlet m_chat = this.core.mtrx.client.getRoom(_chat.room_id)\r\n\t\t\t\t\tlet event = m_chat.currentState.getStateEvents(\"m.room.power_levels\")\r\n\r\n\t\t\t\t\treturn this.core.mtrx.client.setPowerLevel(chat.room_id, matrixId, 100, event[0]).catch(e => {\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t}).then(r => {\r\n\t\t\t\t\tthis.creating = false\r\n\r\n\r\n\t\t\t\t\tif (this.connect && this.connect == id) {\r\n\t\t\t\t\t\tthis.greetings()\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.$store.commit('CONTACT', false)\r\n\r\n\t\t\t\t\treturn Promise.resolve()\r\n\r\n\t\t\t\t}).catch(e => {\r\n\r\n\t\t\t\t\tthis.creating = false\r\n\r\n\t\t\t\t\tthis.$store.state.globalpreloader = false\r\n\r\n\t\t\t\t\tif (e && e.errcode == 'M_ROOM_IN_USE') {\r\n\r\n\t\t\t\t\t\treturn this.core.mtrx.client.joinRoom('#' + id + ':' + this.core.mtrx.baseUrl.replace(\"https://\", \"\")).then(() => {\r\n\t\t\t\t\t\t}).catch(e => {\r\n\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn Promise.reject(e)\r\n\r\n\t\t\t\t})\r\n\r\n\t\t\t} else {\r\n\t\t\t\treturn Promise.reject('u')\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tmaySendMessage() {\r\n\t\t\treturn this.chat && this.chat.maySendMessage()\r\n\t\t},\r\n\r\n\t\tgreetings() {\r\n\t\t\tthis.send('👋').then(r => {\r\n\t\t\t\treturn Promise.resolve(r)\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\tsendinput(text) {\r\n\r\n\t\t\tthis.send(text).then(r => {\r\n\r\n\t\t\t\treturn Promise.resolve(r)\r\n\r\n\t\t\t})\r\n\r\n\t\t},\r\n\r\n\t\ttextCutLimit: function (text, limit) {\r\n\t\t\ttext = text.trim();\r\n\t\t\tif (text.length <= limit) return text;\r\n\r\n\t\t\ttext = text.slice(0, limit);\r\n\r\n\t\t\treturn text.trim() + \"...\";\r\n\t\t},\r\n\r\n\t\treplaceMentions(text) {\r\n\r\n\t\t\t_.each(this.userlist, function (user) {\r\n\t\t\t\ttext = text.replace(new RegExp('@' + user.name, 'g'), '@' + user.id + ':' + user.name)\r\n\t\t\t})\r\n\r\n\t\t\treturn text\r\n\t\t},\r\n\r\n\t\tsend(text) {\r\n\r\n\t\t\tif (!this.chat) {\r\n\t\t\t\tthis.newchat().catch(e => {\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\t//return this.chat.pcrypto.getOrCreateCommonKey()\r\n\r\n\t\t\t//return this.chat.pcrypto.sendCommonKey()\r\n\r\n\t\t\t//return\r\n\r\n\t\t\tthis.$emit(\"sending\")\r\n\r\n\r\n\t\t\tif (!this.relationEvent) {\r\n\t\t\t\tthis.focus()\r\n\t\t\t}\r\n\r\n\t\t\treturn this.$f.pretry(() => {\r\n\r\n\t\t\t\treturn this.chat && !this.creating\r\n\r\n\t\t\t}).then((r) => {\r\n\r\n\t\t\t\tthis.$emit('sent')\r\n\r\n\t\t\t\ttext = this.replaceMentions(text)\r\n\r\n\t\t\t\tif (this.relationEvent) {\r\n\r\n\t\t\t\t\tif (this.relationEvent.type == 'm.replace' && this.relationEvent.event) {\r\n\r\n\t\t\t\t\t\treturn this.core.mtrx.textEvent(this.chat, text).then(r => {\r\n\r\n\t\t\t\t\t\t\tr['m.relates_to'] = {\r\n\t\t\t\t\t\t\t\t\"rel_type\": \"m.replace\",\r\n\t\t\t\t\t\t\t\t\"event_id\": this.core.mtrx.clearEventId(this.relationEvent.event) || f.makeid(),\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tvar editEvent = r\r\n\r\n\t\t\t\t\t\t\tthis.relationEvent.event.event.content.body = r.body\r\n\t\t\t\t\t\t\tthis.relationEvent.event.event.content.block = r.block\r\n\t\t\t\t\t\t\tthis.relationEvent.event.event.content.msgtype = r.msgtype\r\n\r\n\t\t\t\t\t\t\tdelete this.relationEvent.event.event.decryptKey\r\n\t\t\t\t\t\t\tdelete this.relationEvent.event.event.decrypted\r\n\r\n\t\t\t\t\t\t\treturn this.core.mtrx.client.sendEvent(this.chat.roomId, 'm.room.message', editEvent)\r\n\r\n\t\t\t\t\t\t}).then(r => {\r\n\r\n\t\t\t\t\t\t\tthis.core.store.dispatch('FETCH_EVENTS')\r\n\r\n\t\t\t\t\t\t\tthis.$emit('clearRelationEvent')\r\n\r\n\t\t\t\t\t\t\tthis.$emit('force')\r\n\r\n\t\t\t\t\t\t\treturn Promise.resolve()\r\n\t\t\t\t\t\t}).catch(e => {\r\n\r\n\t\t\t\t\t\t\tconsole.error(e)\r\n\t\t\t\t\t\t\treturn Promise.reject(e)\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this.core.mtrx.sendtext(this.chat, text, { relation: this.relationEvent })\r\n\r\n\t\t\t}).catch(e => {\r\n\r\n\r\n\t\t\t\tthis.$emit('sentMessageError', {\r\n\t\t\t\t\terror: e\r\n\t\t\t\t})\r\n\r\n\t\t\t})\r\n\r\n\t\t},\r\n\r\n\t\tpasteImage(data) {\r\n\t\t\tthis.sendImage({ base64: data })\r\n\t\t},\r\n\r\n\t\tsendImage: function ({ base64, file }) {\r\n\r\n\t\t\tvar id = f.makeid()\r\n\r\n\t\t\tvar meta = {\r\n\t\t\t\ttype: \"image\",\r\n\t\t\t\tid: id,\r\n\t\t\t\tbase64: base64,\r\n\t\t\t}\r\n\r\n\t\t\tthis.$emit(\"sendingData\", meta)\r\n\t\t\t//setTimeout(() => {\r\n\t\t\tthis.$f.pretry(() => {\r\n\r\n\t\t\t\treturn this.chat\r\n\r\n\t\t\t}).then(() => {\r\n\t\t\t\tif (meta.aborted)\r\n\t\t\t\t\treturn Promise.reject('aborted')\r\n\t\t\t\tif(this.relationEvent) {\r\n\t\t\t\t\tmeta.event = this.relationEvent ? this.relationEvent : {}\r\n\t\t\t\t\tthis.$emit('sent')\r\n\t\t\t\t}\r\n\t\t\t\treturn this.core.mtrx.sendImage(this.chat, base64, null, meta, { relation: this.relationEvent })\r\n\r\n\t\t\t}).then(r => {\r\n\r\n\t\t\t\tthis.$emit(\"sentData\", {\r\n\t\t\t\t\tid: id\r\n\t\t\t\t})\r\n\r\n\t\t\t\treturn Promise.resolve()\r\n\r\n\t\t\t}).catch(e => {\r\n\r\n\t\t\t\tthis.$emit('sentError', {\r\n\t\t\t\t\tid: id,\r\n\t\t\t\t\terror: e\r\n\t\t\t\t})\r\n\r\n\t\t\t\treturn Promise.resolve()\r\n\r\n\t\t\t})\r\n\t\t\t//}, 5000)\r\n\r\n\r\n\t\t},\r\n\r\n\t\tcanencryptfilesize: function (file) {\r\n\r\n\t\t\tvar s = 10 * 1024 * 1024\r\n\r\n\t\t\tif (!this.chat.pcrypto.canBeEncrypt()) {\r\n\t\t\t\treturn Promise.resolve(false)\r\n\t\t\t}\r\n\r\n\t\t\tif (file.size > s) {\r\n\r\n\r\n\t\t\t\treturn this.$dialog.confirm(\r\n\t\t\t\t\t'Files larger than 10 megabytes are not encrypted. Do you want to send the file unencrypted?', {\r\n\t\t\t\t\tokText: 'Yes',\r\n\t\t\t\t\tcancelText: 'No, cancel'\r\n\t\t\t\t})\r\n\r\n\t\t\t\t\t.then((dialog) => {\r\n\r\n\t\t\t\t\t\treturn Promise.resolve(true)\r\n\r\n\t\t\t\t\t}).catch(e => {\r\n\t\t\t\t\t\treturn Promise.reject('cancel')\r\n\t\t\t\t\t})\r\n\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn Promise.resolve(false)\r\n\t\t},\r\n\r\n\t\tsendFile: function ({ file }) {\r\n\r\n\t\t\tvar id = f.makeid()\r\n\r\n\t\t\tvar meta = {\r\n\t\t\t\ttype: \"file\",\r\n\t\t\t\tid: id,\r\n\t\t\t\tinfo: {\r\n\t\t\t\t\tname: file.name,\r\n\t\t\t\t\tsize: file.size\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.$emit(\"sendingData\", meta)\r\n\r\n\t\t\tthis.$f.pretry(() => {\r\n\r\n\t\t\t\treturn this.chat\r\n\r\n\t\t\t}).then(() => {\r\n\r\n\t\t\t\treturn this.canencryptfilesize(file)\r\n\r\n\r\n\t\t\t}).then((notenc) => {\r\n\t\t\t\tif(this.relationEvent) {\r\n\t\t\t\t\tthis.$emit('sent')\r\n\t\t\t\t}\r\n\t\t\t\treturn this.core.mtrx.sendFile(this.chat, file, meta, { relation: this.relationEvent }, notenc)\r\n\r\n\t\t\t}).then(() => {\r\n\r\n\t\t\t\tthis.$emit(\"sentData\", {\r\n\t\t\t\t\tid: id\r\n\t\t\t\t})\r\n\r\n\t\t\t\treturn Promise.resolve()\r\n\r\n\t\t\t}).catch(e => {\r\n\r\n\t\t\t\tconsole.error(e)\r\n\r\n\t\t\t\tthis.$emit('sentError', {\r\n\t\t\t\t\tid: id,\r\n\t\t\t\t\terror: e\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\r\n\t\t},\r\n\r\n\t\tfocus: function () {\r\n\t\t\tif (this.$refs['newinput'])\r\n\t\t\t\tthis.$refs['newinput'].focus()\r\n\t\t},\r\n\r\n\t\tfocused: function () {\r\n\t\t\tthis.$emit('focused')\r\n\t\t},\r\n\r\n\t\tblur: function () {\r\n\t\t\tif (this.$refs['newinput'])\r\n\t\t\t\tthis.$refs['newinput'].blur()\r\n\t\t},\r\n\r\n\t\tblurifempty: function () {\r\n\t\t\tif (this.$refs['newinput'])\r\n\t\t\t\tthis.$refs['newinput'].blurifempty()\r\n\t\t},\r\n\r\n\t\tchange: function () {\r\n\t\t},\r\n\r\n\t\tsetText: function (text) {\r\n\t\t\tthis.text = text\r\n\r\n\t\t\tif (this.$refs['newinput'])\r\n\t\t\t\tthis.$refs['newinput'].setText(text)\r\n\t\t},\r\n\r\n\t\tkeyup: function (evt) {\r\n\t\t\tvar value = evt.target.value\r\n\r\n\t\t\tif (value === '') {\r\n\t\t\t\tthis.$emit('inputClean', false)\r\n\t\t\t\treturn\r\n\t\t\t} else {\r\n\t\t\t\tthis.$emit('inputClean', true)\r\n\t\t\t}\r\n\r\n\t\t\tthis.text = value\r\n\t\t\tthis.anyUrlMeta = f.getUrl(this.text)\r\n\r\n\r\n\t\t\tif (this.anyUrlMeta !== undefined) {\r\n\t\t\t\tthis.$emit('setMetaUrl', this.anyUrlMeta)\r\n\t\t\t} else {\r\n\t\t\t\tthis.$emit('inputClean', false)\r\n\t\t\t}\r\n\r\n\t\t\tif (this.chat)\r\n\t\t\t\tthis.core.mtrx.client.sendTyping(this.chat.roomId, true, 100)\r\n\t\t},\r\n\r\n\t\tmenuItemClick(item, rowObject) {\r\n\t\t\tthis[item.click](rowObject);\r\n\t\t},\r\n\r\n\t\tmenuItemLoadedHandler: function (value) {\r\n\r\n\t\t\tthis.menuIsVisible = value\r\n\r\n\t\t\treturn this.menuIsVisible\r\n\t\t},\r\n\r\n\t\tuploadStart(item, files) {\r\n\r\n\t\t},\r\n\r\n\t\tuploadError(item, error) {\r\n\t\t\tthis.$store.commit('icon', {\r\n\t\t\t\ticon: 'error',\r\n\t\t\t\tmessage: error.text\r\n\t\t\t})\r\n\t\t},\r\n\t\tgetImg() {\r\n\t\t\treturn this.imgs = true\r\n\t\t},\r\n\t\tuploadSizeError(value) {\r\n\t\t\tif (!value) {\r\n\t\t\t\tthis.$refs.dropdownMenu.hidePopup();\r\n\t\t\t}\r\n\t\t},\r\n\t\tuploadUploaded(item, data) {\r\n\t\t\tconst validImageTypes = ['image/gif', 'image/jpeg', 'image/png', 'image/webp'];\r\n\r\n\r\n\t\t\tif (!validImageTypes.includes(data.file.type)) {\r\n\t\t\t\tthis.sendFile(data)\r\n\t\t\t} else {\r\n\t\t\t\treturn this.sendImage(data)\r\n\t\t\t}\r\n\t\t},\r\n\t\timageWH(file) {\r\n\t\t\tconst img = new Image();\r\n\t\t\tvar imgInfo = {};\r\n\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\r\n\t\t\t\timg.onload = function () {\r\n\t\t\t\t\timgInfo.w = this.width\r\n\t\t\t\t\timgInfo.h = this.height\r\n\t\t\t\t\tresolve(imgInfo)\r\n\t\t\t\t}\r\n\r\n\t\t\t\timg.onerror = function (e) {\r\n\t\t\t\t\treject(e)\r\n\t\t\t\t}\r\n\r\n\t\t\t\timg.src = file.base64\r\n\t\t\t})\r\n\r\n\t\t},\r\n\t\tuploadUploadedAll(item, result) {\r\n\t\t\tthis.$store.state.loading = false\r\n\t\t\tthis.$refs.dropdownMenu.hidePopup();\r\n\t\t},\r\n\r\n\t\tcatchPermissonsError(err) {\r\n\r\n\t\t\tif (err == 'permissions' || (err.toString && err.toString().indexOf('Permission') > -1)) {\r\n\t\t\t\tthis.microphoneDisabled = true\r\n\r\n\t\t\t\tif (window.cordova) {\r\n\t\t\t\t\tthis.$dialog.confirm(\r\n\t\t\t\t\t\tthis.$i18n.t('micaccesscordova'), {\r\n\t\t\t\t\t\tokText: this.$i18n.t(\"button.ok\"),\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.$dialog.confirm(\r\n\t\t\t\t\t\tthis.$i18n.t('micaccessbrowser'), {\r\n\t\t\t\t\t\tokText: this.$i18n.t(\"button.ok\"),\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\tif ((err.toString && err.toString().indexOf('device not found') > -1)) {\r\n\t\t\t\tthis.$dialog.confirm(\r\n\t\t\t\t\tthis.$i18n.t('micdevicenotfound'), {\r\n\t\t\t\t\tokText: this.$i18n.t(\"button.ok\"),\r\n\t\t\t\t})\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\r\n\t\t\tthis.$dialog.confirm(\r\n\t\t\t\tthis.$i18n.t('micaccesscommonproblem'), {\r\n\t\t\t\tokText: this.$i18n.t(\"button.ok\"),\r\n\t\t\t})\r\n\r\n\t\t\tconsole.error(err)\r\n\t\t},\r\n\r\n\t\tgetFileIosCordova (path) {\r\n\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\twindow.resolveLocalFileSystemURL(path, (entry) => {\r\n\r\n\r\n\t\t\t\t\tif(!entry){\r\n\t\t\t\t\t\treturn reject('noentry')\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tentry.file((file) => {\r\n\t\t\t\t\t\tvar reader = new FileReader()\r\n\t\r\n\t\t\t\t\t\treader.onloadend = function() {\r\n\t\t\t\t\t\t\tvar blob = new Blob([new Uint8Array(this.result)], {type : file.type})\r\n\r\n\t\t\t\t\t\t\tentry.remove()\r\n\r\n\t\t\t\t\t\t\tresolve(blob)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treader.onerror = (e) => {\r\n\r\n\t\t\t\t\t\t\tentry.remove()\r\n\r\n\t\t\t\t\t\t\treject(e)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treader.readAsArrayBuffer(file)\r\n\t\t\t\t\t})\r\n\t\t\t\t}, (e) => {\r\n\t\t\t\t\treject(e)\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\t\t},\r\n\r\n\t\tinitRecordingCordova() {\r\n\r\n\t\t\tthis.prepareRecording = cancelable(this.core.media.permissions({ audio: true }).then(() => {\r\n\t\t\t\tthis.microphoneDisabled = false\r\n\r\n\t\t\t\treturn Promise.resolve()\r\n\t\t\t}).catch(err => {\r\n\r\n\t\t\t\tconsole.error(err)\r\n\r\n\t\t\t\tthis.catchPermissonsError(err)\r\n\r\n\t\t\t\treturn Promise.reject(err)\r\n\r\n\t\t\t}))\r\n\r\n\t\t\tthis.prepareRecording.then(() => {\r\n\r\n\t\t\t\tthis.microphoneDisabled = false\r\n\r\n\t\t\t\tvar path = 'recording.mp3'\r\n\r\n\t\t\t\tif(f.isios()) path = 'cdvfile://localhost/temporary/recording.m4a'\r\n\r\n\t\t\t\tvar sec = 0\r\n\r\n\t\t\t\tthis.audioContext = this.core.getAudioContext()\r\n\r\n\t\t\t\t//var startedTime = (new Date()).getTime() / 1000\r\n\r\n\t\t\t\tvar media = this.cordovaMediaRecorder = new Media(path, () => {\r\n\r\n\t\t\t\t\tthis.recordTime = 0\r\n\r\n\t\t\t\t\tmedia.release()\r\n\r\n\t\t\t\t\tif (this.cancelledCordovaMediaRecorder) {\r\n\r\n\t\t\t\t\t\tthis.cancelledCordovaMediaRecorder = false\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar fu = null\r\n\r\n\t\t\t\t\t/*if(f.isios()){ */\r\n\r\n\t\t\t\t\t\tfu = this.getFileIosCordova(f.isios() ? path : window.cordova.file.externalDataDirectory + path).then(blob => {\r\n\t\t\t\t\t\t\treturn Promise.resolve({\r\n\t\t\t\t\t\t\t\tdata : blob\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t/*}\r\n\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tfu = f.fetchLocal(path)\r\n\t\t\t\t\t}*/\r\n\r\n\t\t\t\t\tfu.then(r => {\r\n\t\t\t\t\t\t///temp\r\n\t\t\t\t\t\t/*if (f.isios())\r\n\t\t\t\t\t\t\tr.duration = (new Date()).getTime() / 1000 - startedTime\r\n\r\n\t\t\t\t\t\tconsole.log(\"R\", r)\r\n\r\n\t\t\t\t\t\t/*var e = {\r\n\t\t\t\t\t\t\tdata : r.data\r\n\t\t\t\t\t\t}*/\r\n\r\n\r\n\t\t\t\t\t\tif (media.duration && media.duration > 0){\r\n\t\t\t\t\t\t\tr.duration = media.duration\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.createVoiceMessage(r, true)\r\n\r\n\t\t\t\t\t\treturn Promise.resolve()\r\n\r\n\t\t\t\t\t}).catch(e => {\r\n\r\n\t\t\t\t\t\tthis.clear()\r\n\r\n\t\t\t\t\t\tconsole.error(e)\r\n\t\t\t\t\t}).finally(() => {\r\n\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t}, (e) => {\r\n\r\n\t\t\t\t\tconsole.error(e)\r\n\r\n\t\t\t\t\tthis.isRecording = false\r\n\t\t\t\t\tthis.clear()\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\tvar rmsdata = []\r\n\r\n\t\t\t\tlet currentPlaying = this.$store.state.currentPlayingVoiceMessage\r\n\r\n\t\t\t\tif (currentPlaying) {\r\n\t\t\t\t\tcurrentPlaying.pause()\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tthis.interval = setInterval(() => {\r\n\t\t\t\t\t// get media amplitude\r\n\r\n\t\t\t\t\tif(f.isios()){\r\n\t\t\t\t\t\trmsdata.push(1)\r\n\r\n\t\t\t\t\t\tif (rmsdata.length > 50) rmsdata = _.last(rmsdata, 50)\r\n\r\n\t\t\t\t\t\tthis.recordRmsData = _.clone(rmsdata)\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tthis.cordovaMediaRecorder.getCurrentAmplitude(\r\n\t\t\t\t\t\t\t// success callback\r\n\t\t\t\t\t\t\t(amp) => {\r\n\r\n\t\t\t\t\t\t\t\trmsdata.push(amp * 1000)\r\n\r\n\t\t\t\t\t\t\t\tif (rmsdata.length > 50) rmsdata = _.last(rmsdata, 50)\r\n\r\n\t\t\t\t\t\t\t\tthis.recordRmsData = _.clone(rmsdata)\r\n\r\n\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfunction (e) {\r\n\t\t\t\t\t\t\t\tconsole.log(\"E\", e)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\r\n\r\n\r\n\r\n\t\t\t\t\tsec = sec + 50\r\n\r\n\t\t\t\t\tif (sec % 1000 === 0) this.recordTime = sec\r\n\r\n\t\t\t\t}, 50);\r\n\r\n\t\t\t\tthis.isRecording = true\r\n\t\t\t\tthis.cancelOpacity = 0\r\n\t\t\t\tthis.recordRmsData = []\r\n\t\t\t\tthis.recordTime = 0\r\n\t\t\t\tthis.record = null\r\n\r\n\t\t\t\tthis.cordovaMediaRecorder.startRecord();\r\n\r\n\t\t\t}).catch((e) => {\r\n\t\t\t\tconsole.error(e)\r\n\r\n\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tthis.prepareRecording = null\r\n\t\t\t})\r\n\r\n\t\t},\r\n\r\n\t\tinitRecording() {\r\n\r\n\t\t\tif (this.prepareRecording || this.isRecording || this.cordovaMediaRecorder) return\r\n\r\n\t\t\tif (window.cordova) {\r\n\t\t\t\treturn this.initRecordingCordova()\r\n\t\t\t}\r\n\r\n\t\t\tthis.prepareRecording = cancelable(this.core.initMediaRecorder().then((recorder) => {\r\n\r\n\t\t\t\tthis.microphoneDisabled = false\r\n\r\n\t\t\t\tif (this.prepareRecording) {\r\n\t\t\t\t\treturn Promise.resolve(recorder)\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\trecorder.stream.getTracks().forEach((track) => {\r\n\t\t\t\t\t\ttrack.stop();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t}).catch(err => {\r\n\r\n\t\t\t\tthis.catchPermissonsError(err)\r\n\t\t\t\treturn Promise.reject(err)\r\n\r\n\t\t\t}))\r\n\r\n\r\n\t\t\tthis.prepareRecording.then((recorder) => {\r\n\r\n\r\n\t\t\t\tthis.mediaRecorder = recorder\r\n\r\n\t\t\t\tthis.audioContext = this.core.getAudioContext()\r\n\t\t\t\tthis.audioAnalyser = this.audioContext.createAnalyser()\r\n\r\n\t\t\t\t//var audioDataArray = new Uint8Array(this.audioAnalyser.frequencyBinCount)\r\n\r\n\t\t\t\tvar src = this.audioContext.createMediaStreamSource(this.mediaRecorder.stream)\r\n\t\t\t\tsrc.connect(this.audioAnalyser)\r\n\r\n\t\t\t\tthis.startRecording()\r\n\r\n\t\t\t}).catch(() => { }).finally(() => {\r\n\t\t\t\tthis.prepareRecording = null\r\n\t\t\t})\r\n\r\n\r\n\t\t},\r\n\r\n\t\tstartRecording() {\r\n\r\n\t\t\tlet currentPlaying = this.$store.state.currentPlayingVoiceMessage\r\n\r\n\t\t\tif (currentPlaying) {\r\n\t\t\t\tcurrentPlaying.pause()\r\n\t\t\t}\r\n\r\n\t\t\tthis.$store.commit('SET_VOICERECORDING', true)\r\n\r\n\t\t\tthis.isRecording = true\r\n\t\t\tthis.cancelOpacity = 0\r\n\t\t\tthis.recordRmsData = []\r\n\t\t\tthis.recordTime = 0\r\n\t\t\tthis.record = null\r\n\t\t\tthis.mediaRecorder.start()\r\n\r\n\t\t\tvar sec = 0\r\n\t\t\tvar rmsdata = []\r\n\r\n\r\n\t\t\tthis.interval = setInterval(() => {\r\n\t\t\t\tvar dataArray = new Uint8Array(this.audioAnalyser.frequencyBinCount)\r\n\r\n\t\t\t\tthis.audioAnalyser.getByteFrequencyData(dataArray)\r\n\r\n\r\n\t\t\t\trmsdata.push(this.generateRms(dataArray))\r\n\r\n\t\t\t\tif (rmsdata.length > 50) rmsdata = _.last(rmsdata, 50)\r\n\r\n\t\t\t\tsec = sec + 50\r\n\r\n\t\t\t\tthis.recordRmsData = _.clone(rmsdata)\r\n\r\n\t\t\t\tif (sec % 1000 === 0) {\r\n\t\t\t\t\tthis.recordTime = sec\r\n\t\t\t\t}\r\n\r\n\t\t\t}, 50)\r\n\r\n\t\t},\r\n\r\n\r\n\t\tcheckaudioForSend: function (record, sendnow) {\r\n\r\n\t\t\tif (record.duration < 1) {\r\n\t\t\t\tthis.clear()\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (sendnow) {\r\n\t\t\t\t\tthis.sendVoiceMessage(record)\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tthis.record = record\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgetduration(file){\r\n\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tf.readFile(file).then(arraybuffer => {\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\tthis.audioContext.decodeAudioData(arraybuffer, (buffer) => {\r\n\t\t\t\t\t\t\tresolve(buffer.duration)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}catch(e){\r\n\t\t\t\t\t\treject(e)\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}).catch(reject)\r\n\t\t\t})\r\n\r\n\r\n\r\n\t\t},\r\n\r\n\t\tcreateVoiceMessage(event, sendnow) {\r\n\t\t\tvar c = () => {\r\n\r\n\t\t\t\t//this.record =\r\n\r\n\t\t\t\tthis.checkaudioForSend({\r\n\t\t\t\t\tfile: event.data,\r\n\t\t\t\t\tid: f.makeid(),\r\n\t\t\t\t\tduration : event.duration\r\n\t\t\t\t}, sendnow)\r\n\t\t\t}\r\n\r\n\t\t\tif(event.duration){\r\n\r\n\t\t\t\tc()\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tthis.getduration(event.data).then(duration => {\r\n\t\t\t\t\tevent.duration = duration\r\n\r\n\t\t\t\t\tc()\r\n\t\t\t\t}).catch((e) => {\r\n\t\t\t\t\tconsole.error(e)\r\n\r\n\t\t\t\t\tthis.clear()\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\r\n\t\t\t/*f.readFile(event.data).then(arraybuffer => {\r\n\r\n\t\t\t\tconsole.log('arraybuffer', arraybuffer)\r\n\r\n\t\t\t\tthis.audioContext.decodeAudioData(arraybuffer, (buffer) => {\r\n\r\n\t\t\t\t\tconsole.log('this.record', this.record)\r\n\t\t\t\t\tconsole.log('this.buffer', buffer)\r\n\r\n\r\n\t\t\t\t\tthis.record = {\r\n\t\t\t\t\t\tfile: event.data,\r\n\t\t\t\t\t\tid: f.makeid()\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.record.duration = buffer.duration\r\n\r\n\t\t\t\t\tthis.checkaudioForSend(sendnow)\r\n\r\n\t\t\t\t})\r\n\r\n\t\t\t}).catch(e => {\r\n\t\t\t\tconsole.error('e', e)\r\n\t\t\t\tthis.clear()\r\n\t\t\t\t//\r\n\t\t\t})*/\r\n\r\n\t\t},\r\n\r\n\t\tgenerateRms(frequencies) {\r\n\t\t\treturn +Math.sqrt(frequencies.reduce((a, b) => a + b ** 2) / frequencies.length).toPrecision(4)\r\n\t\t},\r\n\r\n\t\tstopRecording({ cancel, sendnow }) {\r\n\r\n\t\t\tconsole.log(\"STOP RECORDING\", this.isRecording)\r\n\r\n\r\n\t\t\tthis.$store.commit('SET_VOICERECORDING', false)\r\n\r\n\t\t\tif (this.prepareRecording) {\r\n\r\n\t\t\t\tthis.prepareRecording.cancel()\r\n\t\t\t\tthis.prepareRecording = null\r\n\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\tthis.isRecording = false\r\n\r\n\t\t\tif (this.interval) {\r\n\t\t\t\tclearInterval(this.interval)\r\n\t\t\t\tthis.interval = null\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif (this.mediaRecorder) {\r\n\r\n\t\t\t\tif (cancel) {\r\n\t\t\t\t\t//this.mediaRecorder.ondataavailable = () => { }\r\n\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.mediaRecorder.addEventListener('dataavailable', (event) => {\r\n\t\t\t\t\t\tthis.createVoiceMessage(event, sendnow)\r\n\t\t\t\t\t})//ondataavailable = (event) => this.createVoiceMessage(event, sendnow)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.mediaRecorder.stop()\r\n\r\n\t\t\t\tthis.mediaRecorder.stream.getTracks().forEach((track) => {\r\n\t\t\t\t\ttrack.stop();\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.mediaRecorder = null\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif (this.cordovaMediaRecorder) {\r\n\r\n\t\t\t\tif (cancel) {\r\n\t\t\t\t\tthis.cancelledCordovaMediaRecorder = true\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.cancelledCordovaMediaRecorder = false\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.cordovaMediaRecorder.stopRecord()\r\n\t\t\t\tthis.cordovaMediaRecorder = null\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tasync sendVoiceMessage(record) {\r\n\r\n\t\t\tif(!record) record = this.record\r\n\r\n\t\t\tif(!record) {\r\n\t\t\t\tthis.clear()\r\n\t\t\t}\r\n\r\n\t\t\tthis.recordRmsData = []\r\n\r\n\t\t\tconst base64 = await this.core.convertAudioToBase64(record.file)\r\n\r\n\t\t\tconst id = f.makeid()\r\n\r\n\t\t\tconst meta = {\r\n\t\t\t\ttype: \"audio\",\r\n\t\t\t\tid: id,\r\n\t\t\t\tbase64: base64,\r\n\t\t\t}\r\n\r\n\t\t\tthis.clear()\r\n\r\n\t\t\tthis.$f.pretry(() => {\r\n\t\t\t\treturn this.chat\r\n\t\t\t}).then(() => {\r\n\t\t\t\tif(this.relationEvent) {\r\n\t\t\t\t\tmeta.event = this.relationEvent ? this.relationEvent : {}\r\n\t\t\t\t\tthis.$emit('sent')\r\n\t\t\t\t}\r\n\t\t\t\treturn this.core.mtrx.sendAudio(this.chat, base64, null, meta, { relation: this.relationEvent })\r\n\t\t\t}).catch(e => {\r\n\t\t\t\tthis.$emit('sentError', {\r\n\t\t\t\t\tid: id,\r\n\t\t\t\t\terror: e\r\n\t\t\t\t})\r\n\t\t\t\treturn Promise.resolve()\r\n\t\t\t})\r\n\r\n\r\n\t\t},\r\n\r\n\t\tclear() {\r\n\t\t\tthis.record = null\r\n\t\t\tthis.recordRmsData = []\r\n\t\t\tthis.recordTime = 0\r\n\r\n\t\t\tif (this.interval) {\r\n\t\t\t\tclearInterval(this.interval)\r\n\t\t\t\tthis.interval = null\r\n\t\t\t}\r\n\r\n\t\t\tif (this.cordovaMediaRecorder) {\r\n\t\t\t\tthis.cordovaMediaRecorder = null\r\n\t\t\t}\r\n\r\n\t\t\tif (this.mediaRecorder) {\r\n\r\n\t\t\t\tthis.mediaRecorder.stop()\r\n\t\t\t\tthis.mediaRecorder.stream.getTracks().forEach((track) => {\r\n\t\t\t\t\ttrack.stop();\r\n\t\t\t\t});\r\n\t\t\t\tthis.mediaRecorder = null\r\n\t\t\t}\r\n\r\n\t\t\t/*if (this.audioContext){\r\n\t\t\t\tthis.audioContext.close()\r\n\t\t\t}*/\r\n\t\t},\r\n\r\n\t\t/*async convertAudioToBase64(blob) {\r\n\t\t\tconst reader = new FileReader()\r\n\t\t\treader.readAsDataURL(blob)\r\n\t\t\treturn new Promise(resolve => {\r\n\t\t\t\treader.onloadend = () => {\r\n\t\t\t\t\tresolve(reader.result)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},*/\r\n\r\n\t\tsetOpacity(opacity) {\r\n\t\t\tthis.cancelOpacity = opacity\r\n\t\t}\r\n\r\n\t},\r\n}\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!./index.js?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!./index.js?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=e8b463ac&scoped=true&\"\nimport script from \"./index.js?vue&type=script&lang=js&\"\nexport * from \"./index.js?vue&type=script&lang=js&\"\nimport style0 from \"./index.sass?vue&type=style&index=0&id=e8b463ac&scoped=true&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e8b463ac\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}