{"version":3,"sources":["webpack:///./node_modules/cancelable-promise/umd/CancelablePromise.js","webpack:///./src/components/assets/recordProgress/index.scss?7174","webpack:///./src/components/assets/upload/index.vue?4a8e","webpack:///./node_modules/async-each/index.js","webpack:///./src/components/assets/recordProgress/index.scss?cee1","webpack:///./src/components/chat/input/index.sass?2730","webpack:///./src/components/assets/upload/index.vue?6d1f","webpack:///./src/components/assets/recordVoice/index.scss?ad6e","webpack:///./src/components/chat/input/index.sass?ea34","webpack:///./src/components/assets/recordVoice/index.scss?76f8","webpack:///./src/components/assets/upload/index.vue?fdd5","webpack:///./src/components/chat/input/index.sass","webpack:///./src/components/assets/recordVoice/index.scss","webpack:///./src/components/assets/recordProgress/index.scss","webpack:///./src/components/chat/input/index.vue?8e49","webpack:///./src/components/assets/recordVoice/index.vue?b4ee","webpack:///./src/components/assets/recordVoice/index.js","webpack:///./src/components/assets/recordVoice","webpack:///./src/components/assets/recordVoice/index.vue","webpack:///./src/components/assets/recordProgress/index.vue?439b","webpack:///./src/components/assets/recordProgress/index.js","webpack:///./src/components/assets/recordProgress","webpack:///./src/components/assets/recordProgress/index.vue","webpack:///./src/components/assets/upload/index.vue?d50b","webpack:///src/components/assets/upload/index.vue","webpack:///./src/components/assets/upload/index.vue?f5f6","webpack:///./src/components/assets/upload/index.vue","webpack:///./src/components/chat/input/index.js","webpack:///./src/components/chat/input","webpack:///./src/components/chat/input/index.vue"],"names":["_typeof","Symbol","iterator","obj","constructor","prototype","global","factory","globalThis","self","_exports","_inherits","subClass","superClass","TypeError","Object","create","value","writable","configurable","defineProperty","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","result","Super","_getPrototypeOf","NewTarget","this","Reflect","construct","arguments","apply","_possibleConstructorReturn","call","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","_defineProperty","key","enumerable","_createForOfIteratorHelper","allowArrayLike","it","Array","isArray","_unsupportedIterableToArray","length","i","F","s","n","done","_e","f","err","normalCompletion","didErr","step","next","_e2","return","minLen","_arrayLikeToArray","toString","slice","name","from","test","arr","len","arr2","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","_createClass","protoProps","staticProps","_classPrivateFieldInitSpec","privateMap","_checkPrivateRedeclaration","set","privateCollection","has","_classPrivateFieldGet","receiver","_classExtractFieldDescriptor","_classApplyDescriptorGet","get","_classPrivateFieldSet","_classApplyDescriptorSet","action","CancelablePromise","cancelable","default","isCancelablePromise","_internals","WeakMap","_promise","CancelablePromiseInternal","_ref","_ref$executor","executor","_ref$internals","internals","defaultInternals","_ref$promise","promise","Promise","resolve","reject","onCancel","onCancelList","push","cancel","bind","onfulfilled","onrejected","makeCancelable","then","createCallback","catch","onfinally","runWhenCanceled","_this","finally","filter","callback","isCanceled","callbacks","_step","_iterator","console","error","_CancelablePromiseInt","_super","iterable","makeAllCancelable","all","allSettled","any","race","reason","_default","onResult","arg","_step2","_iterator2","resolvable","content","__esModule","module","locals","exports","add","__inject__","shadowRoot","globals","each","items","Function","undefined","transformed","count","returned","forEach","item","index","transformedItem","___CSS_LOADER_API_IMPORT___","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","tipusers","_l","user","id","class","selected","tipuserindex","on","$event","insertuser","voiceEnable","isRecording","record","recordTime","recordRmsData","cancelOpacity","clear","ref","chat","roomId","sendinput","emitInputData","HideUploadPic","pasteImage","focused","tipBySearch","browsetip","selectcurrenttip","upload","extended","menuItems","scopedSlots","_u","fn","slotProps","onlyimage","multiple","extensions","images","files","uploadStart","data","uploadUploaded","uploadUploadedAll","uploadError","icon","_v","_s","title","proxy","menuItemClick","directives","rawName","expression","prepareRecording","microphoneDisabled","initRecording","stopRecording","setOpacity","sendVoiceMessage","_m","staticRenderFns","hold","isHold","active","disabled","mousedown","mouseup","handleTouchStart","handleTouchEnd","recordEnd","type","required","start","direction","computed","mapState","mobile","state","mounted","beforeDestroy","document","removeEventListener","handleMove","$emit","methods","Y","changedTouches","pageY","X","pageX","addEventListener","sendnow","clearStyle","$refs","toggle","style","transform","classList","remove","holder","deltaY","deltaX","contains","component","timer","width","opacity","Number","rmsData","minute","Math","floor","sec","rmsDataLast","_","last","watch","throttle","draw","graph","offsetWidth","window","resize","re","setTimeout","canvas","ctx","getContext","l","c","max","clearRect","fillStyle","fillRect","_t","dropzone","$t","maxsize","loading","maxSize","created","read","reader","base64","file","event","ha","text","errorText","check","checkSize","getExtension","checkExtension","handle","sendAnyFile","resizeIfNeed","handleImages","u","String","relationEvent","components","InputField","contacts","preview","recordProgress","recordVoice","fileInfo","ready","creating","userId","showuserselect","anyUrlMeta","joinedMembers","tipvalue","mediaRecorder","audioContext","audioAnalyser","interval","cancelledCordovaMediaRecorder","usersForKeysHash","handler","close","$store","voiceMessagesEnabled","connect","contact","pkoindisabled","POCKETNETINSTANCE","supportimagegallery","click","$i18n","t","transaction","unshift","userlist","core","mtrx","chatUsersInfo","deep","uusers","map","split","ausers","matrixId","stateChat","$route","query","chatsMap","invited","currentState","getMembers","m","v","membership","joined","toLowerCase","indexOf","maintipuser","client","newchat","wait","$f","pretry","access","increase","inserttip","showuserselected","resizeImage","ftype","Images","cameraHandlerCustom","dropdownMenu","hidePopup","platform","ui","uploadImage","Base64","toFile","onSuccess","imgs","sendtransactionWrapper","menuIsVisible","users","j","getmatrixid","r","source","userinfo","store","commit","caption","userselected","sendtransaction","api","roomid","address","emitUrl","url","globalpreloader","usersInfo","info","_info","keys","kit","tetatetid","initialstate","encrypted","createRoom","room_alias_name","visibility","invite","initial_state","_chat","m_chat","getRoom","room_id","getStateEvents","setPowerLevel","greetings","errcode","joinRoom","baseUrl","replace","maySendMessage","send","textCutLimit","limit","trim","replaceMentions","RegExp","focus","textEvent","clearEventId","makeid","editEvent","body","block","msgtype","decryptKey","decrypted","sendEvent","dispatch","sendtext","relation","sendImage","meta","aborted","canencryptfilesize","pcrypto","canBeEncrypt","size","$dialog","confirm","okText","cancelText","dialog","sendFile","notenc","blur","blurifempty","change","setText","keyup","evt","getUrl","sendTyping","rowObject","menuItemLoadedHandler","message","getImg","uploadSizeError","validImageTypes","includes","imageWH","img","Image","imgInfo","onload","w","h","height","onerror","src","catchPermissonsError","cordova","getFileIosCordova","path","resolveLocalFileSystemURL","entry","FileReader","onloadend","blob","Blob","Uint8Array","readAsArrayBuffer","initRecordingCordova","media","permissions","audio","isios","getAudioContext","cordovaMediaRecorder","Media","release","fu","externalDataDirectory","duration","createVoiceMessage","rmsdata","currentPlaying","currentPlayingVoiceMessage","pause","setInterval","clone","getCurrentAmplitude","amp","log","startRecord","initMediaRecorder","recorder","stream","getTracks","track","stop","createAnalyser","createMediaStreamSource","startRecording","dataArray","frequencyBinCount","getByteFrequencyData","generateRms","checkaudioForSend","getduration","readFile","arraybuffer","decodeAudioData","buffer","frequencies","sqrt","reduce","a","b","toPrecision","clearInterval","stopRecord","convertAudioToBase64","sendAudio"],"mappings":"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","file":"matrix-element.6.min.js","sourcesContent":["function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\n(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define([\"exports\"], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(exports);\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(mod.exports);\n    global.CancelablePromise = mod.exports;\n  }\n})(typeof globalThis !== \"undefined\" ? globalThis : typeof self !== \"undefined\" ? self : this, function (_exports) {\n  \"use strict\";\n\n  Object.defineProperty(_exports, \"__esModule\", {\n    value: true\n  });\n  _exports.CancelablePromise = void 0;\n  _exports.cancelable = cancelable;\n  _exports.default = void 0;\n  _exports.isCancelablePromise = isCancelablePromise;\n\n  function _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\n  function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\n  function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\n  function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\n  function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\n  function _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\n  function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  function _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\n  function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\n  function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n  function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n  function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\n  function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\n  function _classPrivateFieldInitSpec(obj, privateMap, value) { _checkPrivateRedeclaration(obj, privateMap); privateMap.set(obj, value); }\n\n  function _checkPrivateRedeclaration(obj, privateCollection) { if (privateCollection.has(obj)) { throw new TypeError(\"Cannot initialize the same private elements twice on an object\"); } }\n\n  function _classPrivateFieldGet(receiver, privateMap) { var descriptor = _classExtractFieldDescriptor(receiver, privateMap, \"get\"); return _classApplyDescriptorGet(receiver, descriptor); }\n\n  function _classApplyDescriptorGet(receiver, descriptor) { if (descriptor.get) { return descriptor.get.call(receiver); } return descriptor.value; }\n\n  function _classPrivateFieldSet(receiver, privateMap, value) { var descriptor = _classExtractFieldDescriptor(receiver, privateMap, \"set\"); _classApplyDescriptorSet(receiver, descriptor, value); return value; }\n\n  function _classExtractFieldDescriptor(receiver, privateMap, action) { if (!privateMap.has(receiver)) { throw new TypeError(\"attempted to \" + action + \" private field on non-instance\"); } return privateMap.get(receiver); }\n\n  function _classApplyDescriptorSet(receiver, descriptor, value) { if (descriptor.set) { descriptor.set.call(receiver, value); } else { if (!descriptor.writable) { throw new TypeError(\"attempted to set read only private field\"); } descriptor.value = value; } }\n\n  var _internals = /*#__PURE__*/new WeakMap();\n\n  var _promise = /*#__PURE__*/new WeakMap();\n\n  var CancelablePromiseInternal = /*#__PURE__*/function () {\n    function CancelablePromiseInternal(_ref) {\n      var _ref$executor = _ref.executor,\n          executor = _ref$executor === void 0 ? function () {} : _ref$executor,\n          _ref$internals = _ref.internals,\n          internals = _ref$internals === void 0 ? defaultInternals() : _ref$internals,\n          _ref$promise = _ref.promise,\n          promise = _ref$promise === void 0 ? new Promise(function (resolve, reject) {\n        return executor(resolve, reject, function (onCancel) {\n          internals.onCancelList.push(onCancel);\n        });\n      }) : _ref$promise;\n\n      _classCallCheck(this, CancelablePromiseInternal);\n\n      _classPrivateFieldInitSpec(this, _internals, {\n        writable: true,\n        value: void 0\n      });\n\n      _classPrivateFieldInitSpec(this, _promise, {\n        writable: true,\n        value: void 0\n      });\n\n      this.cancel = this.cancel.bind(this);\n\n      _classPrivateFieldSet(this, _internals, internals);\n\n      _classPrivateFieldSet(this, _promise, promise || new Promise(function (resolve, reject) {\n        return executor(resolve, reject, function (onCancel) {\n          internals.onCancelList.push(onCancel);\n        });\n      }));\n    }\n\n    _createClass(CancelablePromiseInternal, [{\n      key: \"then\",\n      value: function then(onfulfilled, onrejected) {\n        return makeCancelable(_classPrivateFieldGet(this, _promise).then(createCallback(onfulfilled, _classPrivateFieldGet(this, _internals)), createCallback(onrejected, _classPrivateFieldGet(this, _internals))), _classPrivateFieldGet(this, _internals));\n      }\n    }, {\n      key: \"catch\",\n      value: function _catch(onrejected) {\n        return makeCancelable(_classPrivateFieldGet(this, _promise).catch(createCallback(onrejected, _classPrivateFieldGet(this, _internals))), _classPrivateFieldGet(this, _internals));\n      }\n    }, {\n      key: \"finally\",\n      value: function _finally(onfinally, runWhenCanceled) {\n        var _this = this;\n\n        if (runWhenCanceled) {\n          _classPrivateFieldGet(this, _internals).onCancelList.push(onfinally);\n        }\n\n        return makeCancelable(_classPrivateFieldGet(this, _promise).finally(createCallback(function () {\n          if (onfinally) {\n            if (runWhenCanceled) {\n              _classPrivateFieldGet(_this, _internals).onCancelList = _classPrivateFieldGet(_this, _internals).onCancelList.filter(function (callback) {\n                return callback !== onfinally;\n              });\n            }\n\n            return onfinally();\n          }\n        }, _classPrivateFieldGet(this, _internals))), _classPrivateFieldGet(this, _internals));\n      }\n    }, {\n      key: \"cancel\",\n      value: function cancel() {\n        _classPrivateFieldGet(this, _internals).isCanceled = true;\n\n        var callbacks = _classPrivateFieldGet(this, _internals).onCancelList;\n\n        _classPrivateFieldGet(this, _internals).onCancelList = [];\n\n        var _iterator = _createForOfIteratorHelper(callbacks),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var callback = _step.value;\n\n            if (typeof callback === 'function') {\n              try {\n                callback();\n              } catch (err) {\n                console.error(err);\n              }\n            }\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      }\n    }, {\n      key: \"isCanceled\",\n      value: function isCanceled() {\n        return _classPrivateFieldGet(this, _internals).isCanceled === true;\n      }\n    }]);\n\n    return CancelablePromiseInternal;\n  }();\n\n  var CancelablePromise = /*#__PURE__*/function (_CancelablePromiseInt) {\n    _inherits(CancelablePromise, _CancelablePromiseInt);\n\n    var _super = _createSuper(CancelablePromise);\n\n    function CancelablePromise(executor) {\n      _classCallCheck(this, CancelablePromise);\n\n      return _super.call(this, {\n        executor: executor\n      });\n    }\n\n    return _createClass(CancelablePromise);\n  }(CancelablePromiseInternal);\n\n  _exports.CancelablePromise = CancelablePromise;\n\n  _defineProperty(CancelablePromise, \"all\", function all(iterable) {\n    return makeAllCancelable(iterable, Promise.all(iterable));\n  });\n\n  _defineProperty(CancelablePromise, \"allSettled\", function allSettled(iterable) {\n    return makeAllCancelable(iterable, Promise.allSettled(iterable));\n  });\n\n  _defineProperty(CancelablePromise, \"any\", function any(iterable) {\n    return makeAllCancelable(iterable, Promise.any(iterable));\n  });\n\n  _defineProperty(CancelablePromise, \"race\", function race(iterable) {\n    return makeAllCancelable(iterable, Promise.race(iterable));\n  });\n\n  _defineProperty(CancelablePromise, \"resolve\", function resolve(value) {\n    return cancelable(Promise.resolve(value));\n  });\n\n  _defineProperty(CancelablePromise, \"reject\", function reject(reason) {\n    return cancelable(Promise.reject(reason));\n  });\n\n  _defineProperty(CancelablePromise, \"isCancelable\", isCancelablePromise);\n\n  var _default = CancelablePromise;\n  _exports.default = _default;\n\n  function cancelable(promise) {\n    return makeCancelable(promise, defaultInternals());\n  }\n\n  function isCancelablePromise(promise) {\n    return promise instanceof CancelablePromise || promise instanceof CancelablePromiseInternal;\n  }\n\n  function createCallback(onResult, internals) {\n    if (onResult) {\n      return function (arg) {\n        if (!internals.isCanceled) {\n          var result = onResult(arg);\n\n          if (isCancelablePromise(result)) {\n            internals.onCancelList.push(result.cancel);\n          }\n\n          return result;\n        }\n\n        return arg;\n      };\n    }\n  }\n\n  function makeCancelable(promise, internals) {\n    return new CancelablePromiseInternal({\n      internals: internals,\n      promise: promise\n    });\n  }\n\n  function makeAllCancelable(iterable, promise) {\n    var internals = defaultInternals();\n    internals.onCancelList.push(function () {\n      var _iterator2 = _createForOfIteratorHelper(iterable),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var resolvable = _step2.value;\n\n          if (isCancelablePromise(resolvable)) {\n            resolvable.cancel();\n          }\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n    });\n    return new CancelablePromiseInternal({\n      internals: internals,\n      promise: promise\n    });\n  }\n\n  function defaultInternals() {\n    return {\n      isCanceled: false,\n      onCancelList: []\n    };\n  }\n});\n//# sourceMappingURL=CancelablePromise.js.map","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!./index.scss?vue&type=style&index=0&id=3f87c0fa&scoped=true&lang=scss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to Shadow Root\nvar add = require(\"!../../../../node_modules/vue-style-loader/lib/addStylesShadow.js\").default\nmodule.exports.__inject__ = function (shadowRoot) {\n  add(\"2ab77a92\", content, shadowRoot)\n};","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=a28e80a8&scoped=true&lang=sass&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to Shadow Root\nvar add = require(\"!../../../../node_modules/vue-style-loader/lib/addStylesShadow.js\").default\nmodule.exports.__inject__ = function (shadowRoot) {\n  add(\"cb65d9a2\", content, shadowRoot)\n};","// async-each MIT license (by Paul Miller from https://paulmillr.com).\n(function(globals) {\n  'use strict';\n  var each = function(items, next, callback) {\n    if (!Array.isArray(items)) throw new TypeError('each() expects array as first argument');\n    if (typeof next !== 'function') throw new TypeError('each() expects function as second argument');\n    if (typeof callback !== 'function') callback = Function.prototype; // no-op\n\n    if (items.length === 0) return callback(undefined, items);\n\n    var transformed = new Array(items.length);\n    var count = 0;\n    var returned = false;\n\n    items.forEach(function(item, index) {\n      next(item, function(error, transformedItem) {\n        if (returned) return;\n        if (error) {\n          returned = true;\n          return callback(error);\n        }\n        transformed[index] = transformedItem;\n        count += 1;\n        if (count === items.length) return callback(undefined, transformed);\n      });\n    });\n  };\n\n  if (typeof define !== 'undefined' && define.amd) {\n    define([], function() {\n      return each;\n    }); // RequireJS\n  } else if (typeof module !== 'undefined' && module.exports) {\n    module.exports = each; // CommonJS\n  } else {\n    globals.asyncEach = each; // <script>\n  }\n})(this);\n","export * from \"-!../../../../node_modules/vue-style-loader/index.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!./index.scss?vue&type=style&index=0&id=3f87c0fa&scoped=true&lang=scss&\"","export * from \"-!../../../../node_modules/vue-style-loader/index.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!./index.sass?vue&type=style&index=0&id=e8b463ac&scoped=true&lang=sass&\"","export * from \"-!../../../../node_modules/vue-style-loader/index.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=a28e80a8&scoped=true&lang=sass&\"","export * from \"-!../../../../node_modules/vue-style-loader/index.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!./index.scss?vue&type=style&index=0&id=34d15f18&scoped=true&lang=scss&\"","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!./index.sass?vue&type=style&index=0&id=e8b463ac&scoped=true&lang=sass&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to Shadow Root\nvar add = require(\"!../../../../node_modules/vue-style-loader/lib/addStylesShadow.js\").default\nmodule.exports.__inject__ = function (shadowRoot) {\n  add(\"3160b183\", content, shadowRoot)\n};","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!./index.scss?vue&type=style&index=0&id=34d15f18&scoped=true&lang=scss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add CSS to Shadow Root\nvar add = require(\"!../../../../node_modules/vue-style-loader/lib/addStylesShadow.js\").default\nmodule.exports.__inject__ = function (shadowRoot) {\n  add(\"0810035e\", content, shadowRoot)\n};","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".upload[data-v-a28e80a8]{width:100%}.uploadWrapper[data-v-a28e80a8]{position:relative}.uploadWrapper .inputWrapper[data-v-a28e80a8],.uploadWrapper .inputWrapper input[data-v-a28e80a8]{position:absolute;left:0;right:0;top:0;bottom:0;opacity:0}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"#chatInput[data-v-e8b463ac]{padding-bottom:.5em}[data-v-e8b463ac] #modal.minimized .modal-wrapper{left:0}[data-v-e8b463ac] .previewWrapper{padding-left:.5em!important;padding-right:.5em!important}.inputWrapper[data-v-e8b463ac]{display:flex}.inputWrapper .left[data-v-e8b463ac]{width:35px;display:flex;justify-content:flex-end;align-items:center;text-align:center}.inputWrapper .left .iconbutton[data-v-e8b463ac]{display:flex;align-items:center;justify-content:center;height:35px;width:35px;-webkit-tap-highlight-color:transparent}.inputWrapper .extended[data-v-e8b463ac]{width:70px;margin-left:7px}.inputWrapper .leftdummy[data-v-e8b463ac]{width:.5em}.inputWrapper>div[data-v-e8b463ac]{transition:.3s}.inputWrapper .center[data-v-e8b463ac]{max-height:110px;max-width:100%;display:flex;justify-content:space-between;align-items:center;flex-grow:1;border:1px solid transparent;border-radius:30px;background:rgb(var(--background-secondary-theme))}.inputWrapper input[data-v-e8b463ac]{border:1px solid rgb(var(--neutral-grad-0));background:rgba(var(--background-main),.5);border-radius:30px;width:100%;padding:.5em 1em}.notready[data-v-e8b463ac],.waitjoined[data-v-e8b463ac]{padding:.5em 0;text-align:center}.waitjoined span[data-v-e8b463ac]{font-size:.8em}.greetings[data-v-e8b463ac]{padding:.5em 0}.greetings[data-v-e8b463ac],[data-v-e8b463ac] .iconWrapper{text-align:center}.menu-item[data-v-e8b463ac]{padding:.5em;background:rgb(var(--background-total-theme));line-height:44px;border-radius:5px;display:flex}.menu-item .title[data-v-e8b463ac]{flex-grow:2;padding-right:44px;text-align:center}.menu-item .iconWrapper[data-v-e8b463ac]{width:44px}.tipusers[data-v-e8b463ac]{position:absolute;max-height:300px;border-radius:.5em;border:1px solid rgba(var(--neutral-grad-0),.9);overflow-y:overlay;background-color:rgba(var(--background-total-theme),.95);backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px);padding:.25em 0;bottom:100%;margin-bottom:.5em;left:.25em;right:.25em}.tipusers .previewWrapperExt[data-v-e8b463ac]{border-radius:.75em;margin-left:.25em;margin-right:.25em;padding-top:.25em;padding-bottom:.25em;transition:.4s}.tipusers .previewWrapperExt[data-v-e8b463ac] .previewWrapper{padding-left:.25em!important;padding-right:.25em!important}.tipusers .previewWrapperExt[data-v-e8b463ac]:hover{cursor:pointer;transition:.4s}.tipusers .previewWrapperExt.selected[data-v-e8b463ac],.tipusers .previewWrapperExt[data-v-e8b463ac]:hover{background:rgb(var(--background-main))}.disabled[data-v-e8b463ac]{display:flex;justify-content:center;align-items:center;width:35px;height:35px;color:rgb(var(--neutral-grad-3))}.disabled i[data-v-e8b463ac]{padding-top:1px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".recordButton_wrapper[data-v-34d15f18]{position:relative}.recordButton_holder[data-v-34d15f18]{visibility:hidden;position:absolute;display:flex;justify-content:center;align-items:center;height:16px;width:16px;background:#789;border-radius:50%;bottom:98px;transition:.1s;right:9px}.recordButton_holder .icon[data-v-34d15f18]{color:#fff;font-size:7px}.recordButton_holder.active[data-v-34d15f18]{visibility:visible}.recordButton_holder.hold[data-v-34d15f18]{background:#789;visibility:visible;bottom:38px}.recordButton_holder.hold .icon[data-v-34d15f18]{color:#fff}.recordButton_main[data-v-34d15f18]{padding-top:1px;touch-action:none;display:flex;align-items:center;justify-content:center;width:35px;height:35px;line-height:35px!important;background:transparent;border-radius:50%;outline:none;position:relative}.recordButton_main.active[data-v-34d15f18]{background:rgb(var(--color-bg-ac));-webkit-animation:pulse-data-v-34d15f18 1.2s infinite;animation:pulse-data-v-34d15f18 1.2s infinite}.recordButton_main.active .icon[data-v-34d15f18]{color:rgb(var(--text-on-bg-shadow-color))}.recordButton_main.active[data-v-34d15f18]:before{position:absolute;left:-30px;bottom:-30px;right:-30px;top:-30px;content:\\\"\\\";border-radius:50%;border:35px solid rgba(var(--color-bg-ac),.5);-webkit-animation:pulse-data-v-34d15f18 1.2s infinite;animation:pulse-data-v-34d15f18 1.2s infinite}.recordButton_main.disabled .icon[data-v-34d15f18]{color:rgb(var(--neutral-grad-2))}.recordButton_main.outside[data-v-34d15f18],.recordButton_stop[data-v-34d15f18]{background:rgb(var(--color-bad))}.recordButton_stop[data-v-34d15f18]{color:rgb(var(--text-on-bg-shadow-color));font-size:.7em}@-webkit-keyframes pulse-data-v-34d15f18{0%{opacity:1}50%{opacity:.8}to{opacity:1}}@keyframes pulse-data-v-34d15f18{0%{opacity:1}50%{opacity:.8}to{opacity:1}}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".recordProgress[data-v-3f87c0fa]{display:flex;height:20px;justify-content:flex-start;padding:0 1em;align-items:center;max-width:80%;flex-grow:2}.recordProgress .indicatorWrapper[data-v-3f87c0fa]{min-width:20px;width:20px;margin-right:1em;display:flex;justify-content:center;align-items:center}.recordProgress .indicator[data-v-3f87c0fa]{height:6px;width:6px;background:#ff033e;border-radius:50%}.recordProgress .indicator.recording[data-v-3f87c0fa]{-webkit-animation:pulse-data-v-3f87c0fa 1.2s ease infinite;animation:pulse-data-v-3f87c0fa 1.2s ease infinite}.recordProgress .del[data-v-3f87c0fa]{min-width:20px;cursor:pointer;display:flex;justify-content:center;align-items:center;width:20px;height:20px;margin-right:1em}.recordProgress .del i[data-v-3f87c0fa]{color:red;font-size:13px}.recordProgress .timer[data-v-3f87c0fa]{margin-right:1em}.recordProgress .graph[data-v-3f87c0fa]{margin:0 auto;width:100px;overflow:hidden;border-radius:15px}.cancel[data-v-3f87c0fa],.recordProgress .graph[data-v-3f87c0fa]{display:flex;justify-content:center}.cancel[data-v-3f87c0fa]{position:absolute;left:0;right:0;top:0;bottom:0;background:rgb(var(--background-secondary-theme));opacity:0;text-align:center;align-items:center}.cancel span[data-v-3f87c0fa]{white-space:nowrap;font-size:.9em}@-webkit-keyframes pulse-data-v-3f87c0fa{0%{opacity:1}50%{opacity:.1}to{opacity:1}}@keyframes pulse-data-v-3f87c0fa{0%{opacity:1}50%{opacity:.1}to{opacity:1}}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"noswipepnt\",attrs:{\"id\":\"chatInput\"}},[(_vm.ready)?_c('div',{staticClass:\"work\"},[(_vm.chat)?_c('div',{staticClass:\"inputWrapper\"},[(_vm.tipusers.length)?_c('div',{staticClass:\"tipusers\"},_vm._l((_vm.tipusers),function(user,i){return _c('div',{key:user.id,staticClass:\"previewWrapperExt\",class:{selected : _vm.tipuserindex == i},on:{\"click\":function($event){return _vm.insertuser(user)}}},[_c('preview',{attrs:{\"contact\":user,\"mode\":\"\"}})],1)}),0):_vm._e(),_c('div',{staticClass:\"center\"},[(_vm.voiceEnable && (_vm.isRecording || _vm.record))?_c('record-progress',{attrs:{\"recordTime\":_vm.recordTime,\"isRecording\":_vm.isRecording,\"rmsData\":_vm.recordRmsData,\"opacity\":_vm.cancelOpacity},on:{\"onClear\":_vm.clear}}):_c('InputField',{ref:\"newinput\",attrs:{\"storagekey\":'chatinput' + _vm.chat.roomId,\"tipusers\":_vm.tipusers},on:{\"chatMessage\":_vm.sendinput,\"emptyInput\":_vm.emitInputData,\"FilledInput\":_vm.HideUploadPic,\"base64\":_vm.pasteImage,\"focused\":_vm.focused,\"tipsearchrequest\":_vm.tipBySearch,\"browsetip\":_vm.browsetip,\"selectcurrenttip\":_vm.selectcurrenttip}}),(_vm.upload && _vm.chat)?_c('div',{staticClass:\"left\",class:{extended: _vm.voiceEnable}},[(!_vm.isRecording && !_vm.record)?_c('div',{staticClass:\"iconbutton\"},[_c('dropdownMenu',{ref:\"dropdownMenu\",attrs:{\"menuItems\":_vm.menuItems,\"rowObject\":{},\"icon\":\"fas fa-plus\"},scopedSlots:_vm._u([{key:\"default\",fn:function(slotProps){return [(!slotProps.item.upload)?_c('div',{staticClass:\"menu-item\",on:{\"click\":function($event){return _vm.menuItemClick(slotProps.item)}}},[_c('div',{staticClass:\"iconWrapper\"},[(slotProps.item.icon)?_c('i',{class:slotProps.item.icon}):_vm._e()]),_c('div',{staticClass:\"title\"},[_vm._v(\" \"+_vm._s(slotProps.item.title)+\" \")])]):_c('upload',{attrs:{\"onlyimage\":slotProps.item.upload.onlyimage,\"multiple\":slotProps.item.upload.multiple,\"extensions\":slotProps.item.upload.extensions,\"images\":slotProps.item.upload.images},on:{\"start\":function (files) { return _vm.uploadStart(slotProps.item, files); },\"uploaded\":function (data) { return _vm.uploadUploaded(slotProps.item, data); },\"uploadedAll\":function (result) { return _vm.uploadUploadedAll(slotProps.item, result); },\"error\":function (error) { return _vm.uploadError(slotProps.item, error); }},scopedSlots:_vm._u([{key:\"content\",fn:function(){return [_c('div',{staticClass:\"menu-item\"},[_c('div',{staticClass:\"iconWrapper\"},[(slotProps.item.icon)?_c('i',{class:slotProps.item.icon}):_vm._e()]),_c('div',{staticClass:\"title\"},[_vm._v(\" \"+_vm._s(slotProps.item.title)+\" \")])])]},proxy:true},{key:\"dropzone\",fn:function(){return undefined},proxy:true}],null,true)})]}}],null,false,3187246467)})],1):_vm._e(),(_vm.voiceEnable)?[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:((_vm.isRecording || !_vm.record)),expression:\"(isRecording || !record)\"}],staticClass:\"iconbutton\"},[_c('recordVoice',{attrs:{\"prepareRecording\":_vm.prepareRecording ? true : false,\"isRecording\":_vm.isRecording,\"disabled\":_vm.microphoneDisabled},on:{\"onRecordingStart\":_vm.initRecording,\"onRecordingStop\":_vm.stopRecording,\"onClear\":_vm.clear,\"canceling\":_vm.setOpacity}})],1)]:_vm._e(),(!_vm.isRecording && _vm.record)?_c('div',{staticClass:\"iconbutton\",on:{\"click\":function (e) {_vm.sendVoiceMessage()}}},[_vm._m(0)]):_vm._e()],2):_vm._e()],1)]):_vm._e()]):_c('div',{staticClass:\"notready\"},[_c('linepreloader')],1)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('i',{staticClass:\"icon fas fa-paper-plane\"})])}]\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"recordButton_wrapper\"},[_c('div',{ref:\"holder\",staticClass:\"recordButton_holder\",class:{hold: _vm.isHold}},[_c('i',{staticClass:\"icon fas\",class:_vm.isHold ? 'fa-lock': 'fa-lock-open'})]),(!_vm.isHold)?_c('div',{ref:\"toggle\",staticClass:\"recordButton_micro recordButton_main\",class:{active: _vm.isRecording, disabled: _vm.disabled},on:{\"mousedown\":_vm.mousedown,\"mouseup\":_vm.mouseup,\"touchstart\":_vm.handleTouchStart,\"touchend\":_vm.handleTouchEnd,\"touchcancel\":_vm.handleTouchEnd}},[_c('i',{staticClass:\"icon fas fa-microphone\"})]):_vm._e(),(_vm.isHold)?_c('div',{ref:\"stop\",staticClass:\"recordButton_stop recordButton_main\",on:{\"click\":_vm.recordEnd}},[_c('i',{staticClass:\"icon fas fa-stop\"})]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { mapState } from 'vuex';\r\n\r\nexport default {\r\n\tname: \"recordVoice\",\r\n\tprops: {\r\n\t\tisRecording: {\r\n\t\t\ttype: Boolean,\r\n\t\t\trequired: true\r\n\t\t},\r\n\t\tprepareRecording: {\r\n\t\t\ttype: Boolean\r\n\t\t},\r\n\t\tdisabled: Boolean,\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tstart: 0,\r\n\t\t\tisHold: false,\r\n\t\t\tdirection: null\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState({\r\n\t\t\tmobile: state => state.mobile,\r\n\t\t})\r\n\t},\r\n\tmounted() {\r\n\t\r\n\t},\r\n\tbeforeDestroy() {\r\n\r\n\t\tdocument.removeEventListener('mousemove', this.handleMove)\r\n\t\tdocument.removeEventListener('touchmove', this.handleMove)\r\n\r\n\t\tif (this.isRecording) {\r\n\t\t\tthis.$emit('onRecordingStop', {cancel : true})\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\r\n\t\tmouseup : function(e){\r\n\t\t\tif(!this.mobile)\r\n\t\t\t\tthis.handleTouchEnd(e)\r\n\t\t},\r\n\r\n\t\tmousedown : function(e){\r\n\t\t\tif(!this.mobile)\r\n\t\t\t\tthis.handleTouchStart(e)\r\n\t\t},\r\n\t\t\r\n\t\thandleTouchStart(e) {\r\n\r\n\r\n\t\t\tif(!this.isRecording) {\r\n\t\t\t\tthis.$emit('onRecordingStart')\r\n\t\t\t}\r\n\r\n\t\t\telse{\r\n\t\t\t\tif(this.isHold) return\r\n\t\t\t}\r\n\r\n\t\t\tthis.start = {\r\n\t\t\t\tY: e.changedTouches ? e.changedTouches[0].pageY : e.pageY,\r\n\t\t\t\tX: e.changedTouches ? e.changedTouches[0].pageX : e.pageX\r\n\t\t\t}\r\n\r\n\t\t\tif(!this.mobile)\r\n\t\t\t\tdocument.addEventListener('mousemove', this.handleMove)\r\n\t\t\telse\r\n\t\t\t\tdocument.addEventListener('touchmove', this.handleMove)\r\n\r\n\t\t},\r\n\t\thandleTouchEnd(e) {\r\n\r\n\t\t\tif (this.isHold) return\r\n\r\n\t\t\tif (this.isRecording || this.prepareRecording) {\r\n\t\t\t\tthis.$emit('onRecordingStop', {\r\n\t\t\t\t\tsendnow : true\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tdocument.removeEventListener('mousemove', this.handleMove)\r\n\t\t\tdocument.removeEventListener('touchmove', this.handleMove)\r\n\r\n\t\t\tthis.clearStyle()\r\n\r\n\t\t},\r\n\r\n\t\tclearStyle(){\r\n\r\n\t\t\tif (this.$refs.toggle){\r\n\t\t\t\tthis.$refs.toggle.style.transform = `translate(0,0)`\r\n\t\t\t\tthis.$refs.toggle.classList.remove('outside')\r\n\t\t\t}\r\n\r\n\t\t\tif (this.$refs.holder){\r\n\t\t\t\tthis.$refs.holder.classList.remove('active')\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\thandleMove(e) {\r\n\r\n\t\t\tif(!this.isRecording) return\r\n\r\n\t\t\tlet deltaY = this.start.Y - e.pageY\r\n\t\t\tlet deltaX = this.start.X - e.pageX\r\n\r\n\t\t\tif (e?.changedTouches?.length) {\r\n\t\t\t\tdeltaY = this.start.Y - e.changedTouches[0].pageY\r\n\t\t\t\tdeltaX = this.start.X - e.changedTouches[0].pageX\r\n\t\t\t}\r\n\r\n\t\t\tif (deltaY > 5 && deltaX < 5) {\r\n\t\t\t\tthis.direction = 'Y'\r\n\t\t\t} else {\r\n\t\t\t\tthis.direction = 'X'\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif (deltaY > 5 && this.direction === 'Y') {\r\n\r\n\t\t\t\tif(!this.$refs.holder.classList.contains('active'))\r\n\t\t\t\t\tthis.$refs.holder.classList.add('active')\r\n\r\n\t\t\t\tthis.$refs.toggle.style.transform = `translate(0,-${deltaY}px)`\r\n\r\n\t\t\t\tif (deltaY > 70) {\r\n\t\t\t\t\tthis.$refs.toggle.style.transform = `translate(0,0)`\r\n\r\n\t\t\t\t\tdocument.removeEventListener('mousemove', this.handleMove)\r\n\t\t\t\t\tdocument.removeEventListener('touchmove', this.handleMove)\r\n\t\t\t\t\t//document.removeEventListener('mouseup', this.handleTouchEnd)\r\n\r\n\t\t\t\t\tthis.isHold = true\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t} else if (deltaX > 5 && this.direction === 'X') {\r\n\r\n\t\t\t\tthis.$refs.toggle.style.transform = `translate(-${deltaX}px, 0)`\r\n\r\n\t\t\t\tif(!this.$refs.holder.classList.contains('outside'))\r\n\t\t\t\t\tthis.$refs.toggle.classList.add('outside')\r\n\r\n\t\t\t\tthis.$emit('canceling', (deltaX - 5) / 130)\r\n\t\t\t\t\r\n\t\t\t\tif (deltaX > 130) {\r\n\t\t\t\t\tthis.$refs.toggle.style.transform = `translate(0,0)`\r\n\t\t\t\t\tdocument.removeEventListener('mousemove', this.handleMove)\r\n\t\t\t\t\tdocument.removeEventListener('touchmove', this.handleMove)\r\n\t\t\t\t\t//document.removeEventListener('mouseup', this.handleTouchEnd)\r\n\t\t\t\t\tthis.$emit('onRecordingStop', { cancel: true })\r\n\t\t\t\t\tthis.$emit('onClear')\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.clearStyle()\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\trecordEnd(e) {\r\n\r\n\t\t\tthis.clearStyle()\r\n\r\n\t\t\tif (this.isRecording && this.isHold) {\r\n\r\n\t\t\t\tthis.$emit('onRecordingStop', {})\r\n\t\t\t\tthis.isHold = false\r\n\r\n\t\t\t\treturn\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t\r\n\t}\r\n}","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!./index.js?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!./index.js?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=34d15f18&scoped=true&\"\nimport script from \"./index.js?vue&type=script&lang=js&\"\nexport * from \"./index.js?vue&type=script&lang=js&\"\nimport style0 from \"./index.scss?vue&type=style&index=0&id=34d15f18&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"34d15f18\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"recordProgress\"},[(_vm.isRecording)?_c('div',{staticClass:\"indicatorWrapper\"},[_c('div',{staticClass:\"indicator\",class:{'recording': _vm.isRecording}})]):_c('div',{staticClass:\"del\",on:{\"click\":_vm.clear}},[_c('i',{staticClass:\"fas fa-trash\"})]),_c('div',{staticClass:\"timer\"},[_vm._v(_vm._s(_vm.timer))]),_c('div',{ref:\"graph\",staticClass:\"graph\"},[_c('canvas',{ref:\"canvas\",attrs:{\"id\":\"canvas\",\"width\":_vm.width,\"height\":\"20\"}})]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isRecording && _vm.opacity),expression:\"isRecording && opacity\"}],ref:\"cancel\",staticClass:\"cancel\"},[_c('span',[_vm._v(\"Slide left to cancel\")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default {\r\n  name: \"recordProgress\",\r\n  props: {\r\n    recordTime: {\r\n      type: Number,\r\n      required: true\r\n    },\r\n    rmsData: {\r\n      type: Array,\r\n      required: true\r\n    },\r\n    isRecording: {\r\n      type: Boolean\r\n    },\r\n    opacity: {}\r\n  },\r\n  data() {\r\n    return {\r\n      width: 0,\r\n    }\r\n  },\r\n  computed: {\r\n    timer() {\r\n      let minute = Math.floor(this.recordTime / 60000)\r\n      let sec = Math.floor(this.recordTime / 1000) % 60\r\n      return `${minute ? minute + ':' : '0:'}${(sec < 10) ? '0' + sec : sec}`\r\n    },\r\n\r\n    rmsDataLast(){\r\n      return _.last(this.rmsData, 25)\r\n    }\r\n  },\r\n\r\n  watch : {\r\n    rmsData : _.throttle(function(){\r\n      this.draw()\r\n    }, 30),\r\n\r\n    opacity : function(){\r\n      this.$refs.cancel.style.opacity = this.opacity\r\n    }\r\n  },\r\n\r\n  mounted() {\r\n    this.$refs.cancel.style.opacity = 0\r\n    let width = this.$refs.graph.offsetWidth\r\n    this.width = width - width % 100\r\n\r\n    window.addEventListener(\"resize\", this.resize);\r\n  },\r\n  beforeDestroy() {\r\n    window.removeEventListener('resize', this.resize)\r\n  },\r\n\r\n  methods: {\r\n    resize() {\r\n      let timer = null\r\n\r\n      var re = () => {\r\n        if (!timer) {\r\n          timer = setTimeout(() => {\r\n            timer = null\r\n            let width = this.$refs.graph.offsetWidth\r\n            this.width = width - width % 100\r\n          }, 50)\r\n        }\r\n      }\r\n\r\n      re()\r\n    },\r\n    draw() {\r\n\r\n      if(!this.$refs.canvas) return\r\n\r\n      const ctx = this.$refs.canvas.getContext(`2d`);\r\n      let x = 0\r\n      let count = 50\r\n      let width = 2 //this.width / 200\r\n      var l = this.rmsDataLast.length\r\n      var c = Math.max(Math.floor(l / count), 1)\r\n\r\n      ctx.clearRect(0, 0, this.width, 20);\r\n\r\n      for (let i = 0; i < l; i = i + c) {\r\n        ctx.fillStyle = '#00a4ff'\r\n        ctx.fillRect(i * 2 * width, 10 - this.rmsDataLast[i] / 8, width, this.rmsDataLast[i] / 4 + 1)\r\n      }\r\n\r\n    },\r\n    clear() {\r\n      this.$emit('onClear')\r\n    }\r\n  }\r\n}","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!./index.js?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!./index.js?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=3f87c0fa&scoped=true&\"\nimport script from \"./index.js?vue&type=script&lang=js&\"\nexport * from \"./index.js?vue&type=script&lang=js&\"\nimport style0 from \"./index.scss?vue&type=style&index=0&id=3f87c0fa&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3f87c0fa\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"upload\"},[_c('div',{staticClass:\"uploadWrapper\"},[_c('div',{staticClass:\"contentWrapper\"},[_vm._t(\"content\",function(){return [_c('i',{staticClass:\"fas fa-plus\"})]})],2),_c('div',{staticClass:\"inputWrapper\"},[_c('input',{attrs:{\"type\":\"file\",\"multiple\":_vm.multiple},on:{\"change\":_vm.upload}})])]),(_vm.dropzone)?_c('div',{ref:\"dropzone\",staticClass:\"dropzone\",class:{dropzone : _vm.dropzone}},[_vm._t(\"dropzone\",function(){return [_c('i',{staticClass:\"fas fa-plus\"}),_vm._v(\" \"+_vm._s(_vm.$t(\"caption.dragAndDropAFile\"))+\" \")]})],2):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"upload\">\r\n    <div class=\"uploadWrapper\">\r\n\r\n      <div class=\"contentWrapper\">\r\n        <slot name=\"content\">\r\n          <i class=\"fas fa-plus\"></i>\r\n        </slot>\r\n      </div>\r\n      <div class=\"inputWrapper\">\r\n        <input type=\"file\" :multiple=\"multiple\" @change=\"upload\"> \r\n      </div>\r\n\r\n    </div>\r\n\r\n    <div class=\"dropzone\" :class=\"{dropzone : dropzone}\" v-if=\"dropzone\" ref=\"dropzone\">\r\n      <slot name=\"dropzone\">\r\n        <i class=\"fas fa-plus\"></i> {{ $t(\"caption.dragAndDropAFile\") }}\r\n      </slot>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n\r\n<style scoped lang=\"sass\">\r\n\r\n  .upload\r\n    width: 100%\r\n\r\n  .uploadWrapper\r\n    position: relative\r\n\r\n    .inputWrapper\r\n      position: absolute\r\n      left: 0\r\n      right: 0\r\n      top: 0\r\n      bottom: 0\r\n      opacity: 0\r\n\r\n      input\r\n        position: absolute\r\n        left: 0\r\n        right: 0\r\n        top: 0\r\n        bottom: 0\r\n        opacity: 0\r\n\r\n</style>\r\n\r\n<script>\r\n\r\nimport Images from '@/application/utils/images.js'\r\n\r\n\r\nvar each = require('async-each');\r\n\r\nvar images = new Images()\r\n\r\nexport default {\r\n  name: 'upload',\r\n  directives: {},\r\n  props: {\r\n\r\n    dropzone: String,\r\n    multiple: Boolean,\r\n\r\n    onlyimage : Boolean,\r\n\r\n    maxsize: {\r\n      default: 25,\r\n      type: Number\r\n    },\r\n\r\n    extensions: {\r\n      type: Array,\r\n      default: () => []\r\n    },\r\n    images: {\r\n      type: Object,\r\n      default: () => {\r\n      }\r\n    }\r\n\r\n  },\r\n\r\n  data: function () {\r\n    return {\r\n      loading: false\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    maxSize() {\r\n      return this.maxsize * 1024 * 1024\r\n    }\r\n  },\r\n\r\n  created: () => {\r\n\r\n  },\r\n  methods: {\r\n    \r\n    read: function (file) {\r\n      var reader = new FileReader();\r\n\r\n      return new Promise((resolve, reject) => {\r\n        reader.onloadend = function (e) {\r\n\r\n          resolve({\r\n            base64: e.target.result,\r\n            file: file\r\n          })\r\n\r\n        }\r\n        reader.readAsDataURL(file);\r\n      })\r\n\r\n\r\n    },\r\n    upload: function (event) {\r\n      event.stopPropagation();\r\n      event.preventDefault();\r\n\r\n      var files = event.dataTransfer?.files || event.target?.files || event.files || [];\r\n      var result = {}\r\n\r\n      this.loading = true\r\n\r\n      this.$emit('start', files)\r\n\r\n      var ha = this\r\n\r\n      each(_.toArray(files), (file, next) => {\r\n\r\n        var error = this.check(file)\r\n\r\n        if (error) {\r\n          \r\n          ha.$emit('error', {\r\n            error: error,\r\n            file: file,\r\n            text: this.errorText(error, file)\r\n          })\r\n\r\n          next(new Error(error))\r\n\r\n          return\r\n        }\r\n\r\n        this.read(file).then(data => {\r\n\r\n          result[data.file.name] = data\r\n\r\n          return this.handle(data)\r\n\r\n        }).then(data => {\r\n\r\n          ha.$emit('uploaded', data)\r\n          next()\r\n\r\n        }).catch(e => {\r\n\r\n          ha.$emit('error', {\r\n            error: e,\r\n            file: file,\r\n            text: this.errorText(e, file)\r\n          })\r\n\r\n          next(new Error(error))\r\n\r\n        })\r\n\r\n      }, (err) => {\r\n\r\n        this.loading = false\r\n        ha.$emit('uploadedAll', result)\r\n\r\n      })\r\n\r\n    },\r\n\r\n    errorText: function (error, file) {\r\n      if (error === 'filesize') {\r\n        return \"File Size Error: (\" + file.name + \"). The File can't be more than \"+this.maxsize+\" mbytes\"\r\n      }\r\n\r\n      if (error === 'fileext') {\r\n        return \"File Extension Error:\" + file.name\r\n      }\r\n    },\r\n\r\n    check: function (file) {\r\n      if (!this.checkSize(file)) {\r\n        return 'filesize'\r\n      }\r\n\r\n      if (!this.checkExtension(file)) {\r\n        return 'fileext'\r\n      }\r\n\r\n    },\r\n    checkSize: function (file) {\r\n      return file.size <= this.maxSize\r\n    },\r\n    getExtension: function (file) {\r\n      var name = file.name.split('.');\r\n      var ext = name[name.length - 1].toLowerCase();\r\n\r\n      return ext;\r\n    },\r\n    checkExtension: function (file) {\r\n\r\n      if (this.extensions.length) {\r\n        if (_.indexOf(this.extensions, this.getExtension(file)) == -1) return false\r\n      }\r\n\r\n      return true;\r\n    },\r\n    handle: function (data) {\r\n\r\n      if (data.file.type === 'image/jpeg' || data.file.type === 'image/png' || data.file.type === 'image/webp') {\r\n        return this.handleImages(data)\r\n      }\r\n      \r\n      return Promise.resolve(data)\r\n    },\r\n    sendAnyFile: function (data) {\r\n      this.$emit('anyFile', data)\r\n    },\r\n    resizeIfNeed : function(base64, ftype){\r\n      if (this.images.resize) {\r\n\r\n          var type = this.images.resize.type || 'def'\r\n          \r\n          return images.resize[type](base64, this.images.resize.width || 1024, this.images.resize.height || 1024, ftype, this.images.resize.quality || 0.85).then(base64 => {\r\n\r\n\r\n            return Promise.resolve(base64)\r\n          }).catch(e => {\r\n            return Promise.reject(e)\r\n          })\r\n\r\n        }\r\n        return Promise.resolve(base64)\r\n    },\r\n    handleImages: function (data) {\r\n\r\n      return images.autorotation(data.file, data.base64).then(base64 => {\r\n        data.base64 = base64\r\n\r\n        return Promise.resolve(data)\r\n      }).then(data => {\r\n\r\n        return this.resizeIfNeed(data.base64, data.file.type).then(base64 => {\r\n          data.base64 = base64\r\n\r\n          return Promise.resolve(data)\r\n        })\r\n\r\n        if (this.images.resize) {\r\n\r\n          var type = this.images.resize.type || 'def'\r\n          \r\n          return images.resize[type](data.base64, this.images.resize.width || 1024, this.images.resize.height || 1024, data.file.type, this.images.resize.quality || 0.85).then(base64 => {\r\n\r\n            data.base64 = base64\r\n\r\n            return Promise.resolve(data)\r\n          }).catch(e => {\r\n            return Promise.reject(e)\r\n          })\r\n\r\n        }\r\n        return Promise.resolve(data)\r\n      })\r\n\r\n\r\n    }\r\n\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=a28e80a8&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=a28e80a8&scoped=true&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a28e80a8\",\n  null\n  \n)\n\nexport default component.exports","import f from \"@/application/functions\";\r\nimport InputField from './InputField/InputField.vue'\r\nimport recordVoice from '@/components/assets/recordVoice/index.vue';\r\nimport { mapState } from \"vuex\";\r\nimport Images from '@/application/utils/images.js'\r\n\r\nimport contacts from '@/components/contacts/list/index.vue'\r\nimport preview from '@/components/contacts/preview/index.vue'\r\nimport recordProgress from '@/components/assets/recordProgress/index.vue';\r\n\r\nimport upload from '@/components/assets/upload/index.vue';\r\n\r\nimport { cancelable } from 'cancelable-promise';\r\nexport default {\r\n\tname: 'chatInput',\r\n\tprops: {\r\n\t\tchat: Object,\r\n\t\tu: String,\r\n\t\trelationEvent: Object\r\n\t},\r\n\r\n\tcomponents: { InputField, contacts, preview, recordProgress, recordVoice, upload },\r\n\r\n\tdata: function () {\r\n\r\n\t\treturn {\r\n\t\t\tupload: true,\r\n\t\t\ttest: [],\r\n\t\t\tloading: false,\r\n\t\t\ttext: '',\r\n\t\t\tfile: {},\r\n\t\t\tfileInfo: {},\r\n\t\t\tready: false,\r\n\t\t\tcreating: false,\r\n\t\t\tuserId: '',\r\n\t\t\tshowuserselect: null,\r\n\t\t\tanyUrlMeta: String,\r\n\t\t\tjoinedMembers: [],\r\n\t\t\ttipvalue: null,\r\n\t\t\ttipuserindex: 0,\r\n\t\t\trecord: null,\r\n\t\t\trecordRmsData: [],\r\n\t\t\tisRecording: false,\r\n\r\n\t\t\tmediaRecorder: null,\r\n\t\t\taudioContext: null,\r\n\t\t\taudioAnalyser: null,\r\n\r\n\t\t\trecordTime: 0,\r\n\t\t\tinterval: null,\r\n\t\t\tcancelOpacity: 0,\r\n\t\t\tmicrophoneDisabled: false,\r\n\t\t\tprepareRecording: false,\r\n\r\n\t\t\tcancelledCordovaMediaRecorder: false\r\n\t\t}\r\n\r\n\t},\r\n\r\n\r\n\twatch: {\r\n\t\tusersForKeysHash: {\r\n\t\t\t//immediate: true,\r\n\t\t\thandler: function () {\r\n\t\t\t}\r\n\t\t},\r\n\t\ttipusers: function () {\r\n\r\n\t\t\tif (!this.tipusers.length) {\r\n\t\t\t\tthis.tipuserindex = 0\r\n\t\t\t} else {\r\n\t\t\t\tif (this.tipuserindex > this.tipusers.length - 1) {\r\n\t\t\t\t\tthis.tipuserindex = this.tipusers.length - 1\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t}\r\n\t},\r\n\r\n\tbeforeDestroy() {\r\n\t\tif (this.audioContext)\r\n\t\t\tthis.audioContext.close()\r\n\t},\r\n\r\n\tcomputed: {\r\n\t\tvoiceEnable() {\r\n\t\t\treturn this.$store.state.voiceMessagesEnabled\r\n\t\t},\r\n\r\n\t\tconnect: function () {\r\n\t\t\treturn this.$store.state.contact\r\n\t\t},\r\n\t\tpkoindisabled : function(){\r\n\t\t\treturn this.$store.state.pkoindisabled\r\n\t\t},\r\n\t\tmenuItems: function () {\r\n\t\t\tvar menuItems = []\r\n\r\n\t\t\t\r\n\t\t\tif (window.POCKETNETINSTANCE) {\r\n\t\t\t\tif(window.POCKETNETINSTANCE.mobile.supportimagegallery()) {\r\n\t\t\t\t\tmenuItems.push({\r\n\t\t\t\t\t\tclick: \"cameraHandlerCustom\",\r\n\t\t\t\t\t\ttitle: this.$i18n.t(\"button.takePhotoOrVideo\"),\r\n\t\t\t\t\t\ticon: \"fas fa-camera\",\r\n\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tmenuItems.push({\r\n\t\t\t\t\tclick: \"cameraHandler\",\r\n\t\t\t\t\ttitle: this.$i18n.t(\"button.takePhotoOrVideo\"),\r\n\t\t\t\t\ticon: \"fas fa-camera\",\r\n\r\n\t\t\t\t\tupload: {\r\n\t\t\t\t\t\tmultiple: true,\r\n\t\t\t\t\t\textensions: ['jpg', 'jpeg', 'png', 'webp'],\r\n\t\t\t\t\t\tmaxsize: 100,\r\n\t\t\t\t\t\timages: {\r\n\t\t\t\t\t\t\tresize: {\r\n\t\t\t\t\t\t\t\ttype: 'fit'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\r\n\r\n\t\t\tmenuItems.push({\r\n\t\t\t\tclick: \"fileHandler\",\r\n\t\t\t\ttitle: this.$i18n.t(\"button.sendFile\"),\r\n\t\t\t\ticon: \"fas fa-sticky-note\",\r\n\r\n\t\t\t\tupload: {\r\n\t\t\t\t\tmultiple: true,\r\n\t\t\t\t\textensions: [],\r\n\t\t\t\t\tmaxsize: 25,\r\n\t\t\t\t\timages: {\r\n\t\t\t\t\t\tresize: {\r\n\t\t\t\t\t\t\ttype: 'fit'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t})\r\n\t\t\t\r\n\r\n\r\n\t\t\tif (this.transaction && !this.pkoindisabled) {\r\n\t\t\t\tmenuItems.unshift({\r\n\t\t\t\t\tclick: \"sendtransactionWrapper\",\r\n\t\t\t\t\ttitle: this.$i18n.t(\"button.sendCoins\"),\r\n\t\t\t\t\ticon: \"fas fa-wallet\"\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t}\r\n\r\n\t\t\treturn menuItems\r\n\t\t},\r\n\t\t...mapState([\r\n\t\t\t'chats'\r\n\t\t]),\r\n\r\n\t\tuserlist: function () {\r\n\r\n\r\n\t\t\tif (!this.chat) return []\r\n\r\n\t\t\treturn this.core.mtrx.chatUsersInfo(this.chat.roomId, 'anotherChatUsers')\r\n\r\n\t\t},\r\n\r\n\t\ttransaction: function () {\r\n\t\t\treturn f.deep(window, 'POCKETNETINSTANCE.platform.ui.wallet.send')\r\n\t\t},\r\n\r\n\t\tuusers: function () {\r\n\t\t\tif (this.u) {\r\n\t\t\t\treturn _.map(this.u.split(','), (u) => {\r\n\t\t\t\t\treturn u\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\treturn []\r\n\t\t},\r\n\t\tausers: function () {\r\n\t\t\tif (this.u) {\r\n\t\t\t\treturn _.map(this.u.split(','), (u) => {\r\n\t\t\t\t\treturn this.core.user.matrixId(u)\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\treturn []\r\n\t\t},\r\n\t\tstateChat: function () {\r\n\t\t\tvar id = this.$route.query.id\r\n\t\t\treturn this.$store.state.chatsMap[id]\r\n\t\t},\r\n\t\tinvited: function () {\r\n\r\n\t\t\tif (!this.chat) {\r\n\t\t\t\tif (this.u) return this.ausers\r\n\t\t\t\treturn []\r\n\t\t\t}\r\n\r\n\t\t\treturn _.map(_.filter(this.chat.currentState.getMembers(), function (m, v) {\r\n\t\t\t\treturn m.membership === 'invite'\r\n\t\t\t}), function (u) {\r\n\t\t\t\treturn u.userId\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\tjoined: function () {\r\n\r\n\t\t\tif (!this.chat) return []\r\n\r\n\t\t\tlet roomId = this.chat.roomId\r\n\t\t\tlet self = this\r\n\t\t\tlet arr = []\r\n\t\t\tlet members = 0\r\n\r\n\t\t\tthis.chat.currentState.getMembers().forEach(function (user) {\r\n\t\t\t\tif (user.membership === 'join') {\r\n\t\t\t\t\tarr.push(user.userId)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\treturn arr\r\n\t\t},\r\n\r\n\t\ttipusers: function () {\r\n\r\n\t\t\tif (this.tipvalue === null) return []\r\n\t\t\tif (this.tipvalue === '') return this.userlist\r\n\r\n\t\t\tvar value = this.tipvalue.toLowerCase()\r\n\r\n\t\t\tvar u = _.filter(this.userlist, function (u) {\r\n\t\t\t\treturn u.name.toLowerCase().indexOf(value) == 0 && u.name.toLowerCase() != value\r\n\t\t\t})\r\n\r\n\t\t\treturn u\r\n\r\n\t\t},\r\n\r\n\t\tmaintipuser: function () {\r\n\t\t\tif (this.tipusers.length) {\r\n\t\t\t\treturn this.tipusers[this.tipuserindex || 0]\r\n\t\t\t}\r\n\r\n\t\t\treturn null\r\n\t\t},\r\n\t},\r\n\r\n\tcreated() {\r\n\r\n\t},\r\n\r\n\t///\r\n\r\n\tmounted() {\r\n\t\tthis.ready = true\r\n\r\n\t\tif (!this.chat && this.core.mtrx.client) {\r\n\t\t\tthis.newchat().catch(e => {\r\n\t\t\t\treturn Promise.resolve()\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tmethods: {\r\n\t\twait: function () {\r\n\t\t\treturn this.$f.pretry(() => {\r\n\t\t\t\treturn this.core.mtrx.client && this.core.mtrx.access\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\tbrowsetip: function (increase) {\r\n\r\n\t\t\tincrease ? this.tipuserindex++ : this.tipuserindex--\r\n\r\n\t\t\tif (this.tipuserindex > this.tipusers.length - 1) {\r\n\t\t\t\tthis.tipuserindex = 0\r\n\t\t\t}\r\n\r\n\t\t\tif (this.tipuserindex < 0) {\r\n\t\t\t\tthis.tipuserindex = this.tipusers.length - 1\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tselectcurrenttip: function () {\r\n\t\t\tthis.insertuser(this.tipusers[this.tipuserindex || 0])\r\n\t\t},\r\n\r\n\t\tinsertuser: function (user = {}) {\r\n\t\t\tvar name = user.name || ''\r\n\r\n\t\t\tthis.$refs['newinput'].inserttip(name)\r\n\t\t},\r\n\r\n\t\ttipBySearch: function (value) {\r\n\t\t\tthis.tipvalue = value\r\n\t\t},\r\n\r\n\t\tshowuserselected: function (contact, action) {\r\n\t\t\tthis[action](contact)\r\n\t\t},\r\n\r\n\r\n\t\tresizeImage: function (base64) {\r\n\r\n\t\t\tvar ftype = base64.split(';')[0].split('/')[1];\r\n\t\t\tvar images = new Images()\r\n\r\n\t\t\treturn images.resize['fit'](base64, 1024, 1024, ftype, 0.95).then(base64 => {\r\n\r\n\t\t\t\treturn Promise.resolve(base64)\r\n\t\t\t}).catch(e => {\r\n\t\t\t\treturn Promise.reject(e)\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\tcameraHandlerCustom: function () {\r\n\t\t\tvar result = []\r\n\r\n\t\t\tthis.$refs.dropdownMenu.hidePopup();\r\n\r\n\t\t\twindow.POCKETNETINSTANCE.platform.ui.uploadImage({\r\n\t\t\t\tmultiple: true,\r\n\r\n\t\t\t\taction: ({ base64 }, resolve) => {\r\n\r\n\r\n\t\t\t\t\treturn this.resizeImage(base64).then(base64 => {\r\n\r\n\t\t\t\t\t\treturn f.Base64.toFile(base64).then(file => {\r\n\t\t\t\t\t\t\tvar data = {\r\n\t\t\t\t\t\t\t\tbase64,\r\n\t\t\t\t\t\t\t\tfile\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tresult.push(data)\r\n\r\n\t\t\t\t\t\t\tthis.uploadUploaded(null, data)\r\n\r\n\t\t\t\t\t\t\tresolve()\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t}).catch(e => {\r\n\t\t\t\t\t\tconsole.error(e)\r\n\t\t\t\t\t\tresolve()\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tonSuccess: (imgs) => {\r\n\t\t\t\t\tthis.uploadUploadedAll()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\tsendtransactionWrapper: function () {\r\n\r\n\t\t\tthis.menuIsVisible = false\r\n\r\n\t\t\tvar users = _.filter(_.map(this.joined, (j) => {\r\n\t\t\t\treturn this.$f.deep(this, '$store.state.users.' + this.$f.getmatrixid(j)) || null\r\n\t\t\t}), (r) => {\r\n\t\t\t\treturn r && r.source && r.id != this.core.user.userinfo?.id\r\n\t\t\t})\r\n\r\n\t\t\tif (!users.length) {\r\n\r\n\t\t\t\treturn 'users.length'\r\n\t\t\t}\r\n\r\n\t\t\tif (users.length > 1) {\r\n\r\n\t\t\t\tthis.core.store.commit('setmodal', {\r\n\t\t\t\t\tcaption: this.$i18n.t(\"caption.sendTransactionTo\"),\r\n\t\t\t\t\ttype: 'showuserselect',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tusers: users,\r\n\t\t\t\t\t\taction: 'sendtransaction',\r\n\t\t\t\t\t\tuserselected: (c) => {\r\n\t\t\t\t\t\t\tthis.showuserselected(c, 'sendtransaction')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\t/*this.showuserselect = {\r\n\t\t\t\t  users : users,\r\n\t\t\t\t  action : 'sendtransaction'\r\n\t\t\t\t}*/\r\n\t\t\t} else {\r\n\t\t\t\tthis.sendtransaction(users[0])\r\n\t\t\t}\r\n\r\n\r\n\t\t\tthis.$refs.dropdownMenu.hidePopup();\r\n\r\n\t\t},\r\n\r\n\t\tsendtransaction: function (user) {\r\n\t\t\tvar api = this.transaction\r\n\r\n\t\t\t//TODO get address and send transaction\r\n\r\n\t\t\tapi({\r\n\t\t\t\troomid: this.chat.roomId,\r\n\t\t\t\taddress: user.source.address\r\n\t\t\t})\r\n\r\n\t\t\t/*.then(({txid, from}) => {\r\n\r\n\t\t\t  return this.core.mtrx.transaction(this.chat.roomId, txid)\r\n\r\n\t\t\t})*/\r\n\r\n\t\t},\r\n\r\n\t\temitInputData: function () {\r\n\t\t\tthis.$emit('emptyInput')\r\n\t\t\tthis.upload = true\r\n\t\t},\r\n\r\n\t\tHideUploadPic() {\r\n\t\t\tthis.upload = false\r\n\t\t},\r\n\r\n\t\temitUrl: function (url) {\r\n\t\t\tthis.$emit('setMetaUrl', url)\r\n\t\t},\r\n\r\n\t\tnewchat() {\r\n\r\n\t\t\tif (this.u) {\r\n\t\t\t\tthis.$store.state.globalpreloader = true\r\n\t\t\t\tvar matrixId = null\r\n\t\t\t\tvar myMatrixId = null\r\n\t\t\t\tvar chat = null\r\n\t\t\t\tvar id = ''\r\n\r\n\t\t\t\tthis.creating = true\r\n\t\t\t\treturn this.core.user.usersInfo(this.uusers).then(info => {\r\n\r\n\t\t\t\t\tif (this.uusers.length == 1) {\r\n\r\n\t\t\t\t\t\tvar _info = info[0]\r\n\r\n\t\t\t\t\t\tif (!_info || !_info.keys || _info.keys.length < 12) {\r\n\r\n\t\t\t\t\t\t\tthis.$emit('cantchatcrypto')\r\n\t\t\t\t\t\t\treturn Promise.reject('ny2')\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.core.user.userinfo.keys.length < 12) {\r\n\t\t\t\t\t\tthis.$emit('cantchatcrypto')\r\n\t\t\t\t\t\treturn Promise.reject('ny2')\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t//return Promise.reject('ny3')\r\n\r\n\t\t\t\t\tid = this.core.mtrx.kit.tetatetid(info[0], this.core.user.userinfo)\r\n\r\n\t\t\t\t\tmatrixId = this.core.user.matrixId(info[0].id)\r\n\t\t\t\t\tmyMatrixId = this.core.user.matrixId(this.core.user.userinfo.id)\r\n\r\n\t\t\t\t\tvar initialstate = [{\r\n\t\t\t\t\t\t\"type\": \"m.set.encrypted\",\r\n\t\t\t\t\t\t\"state_key\": \"\",\r\n\t\t\t\t\t\t\"content\": {\r\n\t\t\t\t\t\t\tencrypted: true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\r\n\t\t\t\t\treturn this.core.mtrx.client.createRoom(\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\troom_alias_name: id,\r\n\t\t\t\t\t\t\tvisibility: 'private',\r\n\t\t\t\t\t\t\tinvite: [matrixId],\r\n\t\t\t\t\t\t\tname: '#' + id,\r\n\t\t\t\t\t\t\tinitial_state: initialstate\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t)\r\n\r\n\t\t\t\t}).then(_chat => {\r\n\r\n\t\t\t\t\tchat = _chat\r\n\t\t\t\t\tthis.$store.state.globalpreloader = false\r\n\r\n\t\t\t\t\tlet m_chat = this.core.mtrx.client.getRoom(_chat.room_id)\r\n\t\t\t\t\tlet event = m_chat.currentState.getStateEvents(\"m.room.power_levels\")\r\n\r\n\t\t\t\t\treturn this.core.mtrx.client.setPowerLevel(chat.room_id, matrixId, 100, event[0]).catch(e => {\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t}).then(r => {\r\n\t\t\t\t\tthis.creating = false\r\n\r\n\r\n\t\t\t\t\tif (this.connect && this.connect == id) {\r\n\t\t\t\t\t\tthis.greetings()\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.$store.commit('CONTACT', false)\r\n\r\n\t\t\t\t\treturn Promise.resolve()\r\n\r\n\t\t\t\t}).catch(e => {\r\n\r\n\t\t\t\t\tthis.creating = false\r\n\r\n\t\t\t\t\tthis.$store.state.globalpreloader = false\r\n\r\n\t\t\t\t\tif (e && e.errcode == 'M_ROOM_IN_USE') {\r\n\r\n\t\t\t\t\t\treturn this.core.mtrx.client.joinRoom('#' + id + ':' + this.core.mtrx.baseUrl.replace(\"https://\", \"\")).then(() => {\r\n\t\t\t\t\t\t}).catch(e => {\r\n\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn Promise.reject(e)\r\n\r\n\t\t\t\t})\r\n\r\n\t\t\t} else {\r\n\t\t\t\treturn Promise.reject('u')\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tmaySendMessage() {\r\n\t\t\treturn this.chat && this.chat.maySendMessage()\r\n\t\t},\r\n\r\n\t\tgreetings() {\r\n\t\t\tthis.send('👋').then(r => {\r\n\t\t\t\treturn Promise.resolve(r)\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\tsendinput(text) {\r\n\r\n\t\t\tthis.send(text).then(r => {\r\n\r\n\t\t\t\treturn Promise.resolve(r)\r\n\r\n\t\t\t})\r\n\r\n\t\t},\r\n\r\n\t\ttextCutLimit: function (text, limit) {\r\n\t\t\ttext = text.trim();\r\n\t\t\tif (text.length <= limit) return text;\r\n\r\n\t\t\ttext = text.slice(0, limit);\r\n\r\n\t\t\treturn text.trim() + \"...\";\r\n\t\t},\r\n\r\n\t\treplaceMentions(text) {\r\n\r\n\t\t\t_.each(this.userlist, function (user) {\r\n\t\t\t\ttext = text.replace(new RegExp('@' + user.name, 'g'), '@' + user.id + ':' + user.name)\r\n\t\t\t})\r\n\r\n\t\t\treturn text\r\n\t\t},\r\n\r\n\t\tsend(text) {\r\n\r\n\t\t\tif (!this.chat) {\r\n\t\t\t\tthis.newchat().catch(e => {\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\t//return this.chat.pcrypto.getOrCreateCommonKey()\r\n\r\n\t\t\t//return this.chat.pcrypto.sendCommonKey()\r\n\r\n\t\t\t//return\r\n\r\n\t\t\tthis.$emit(\"sending\")\r\n\r\n\r\n\t\t\tif (!this.relationEvent) {\r\n\t\t\t\tthis.focus()\r\n\t\t\t}\r\n\r\n\t\t\treturn this.$f.pretry(() => {\r\n\r\n\t\t\t\treturn this.chat && !this.creating\r\n\r\n\t\t\t}).then((r) => {\r\n\r\n\t\t\t\tthis.$emit('sent')\r\n\r\n\t\t\t\ttext = this.replaceMentions(text)\r\n\r\n\t\t\t\tif (this.relationEvent) {\r\n\r\n\t\t\t\t\tif (this.relationEvent.type == 'm.replace' && this.relationEvent.event) {\r\n\r\n\t\t\t\t\t\treturn this.core.mtrx.textEvent(this.chat, text).then(r => {\r\n\r\n\t\t\t\t\t\t\tr['m.relates_to'] = {\r\n\t\t\t\t\t\t\t\t\"rel_type\": \"m.replace\",\r\n\t\t\t\t\t\t\t\t\"event_id\": this.core.mtrx.clearEventId(this.relationEvent.event) || f.makeid(),\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tvar editEvent = r\r\n\r\n\t\t\t\t\t\t\tthis.relationEvent.event.event.content.body = r.body\r\n\t\t\t\t\t\t\tthis.relationEvent.event.event.content.block = r.block\r\n\t\t\t\t\t\t\tthis.relationEvent.event.event.content.msgtype = r.msgtype\r\n\r\n\t\t\t\t\t\t\tdelete this.relationEvent.event.event.decryptKey\r\n\t\t\t\t\t\t\tdelete this.relationEvent.event.event.decrypted\r\n\r\n\t\t\t\t\t\t\treturn this.core.mtrx.client.sendEvent(this.chat.roomId, 'm.room.message', editEvent)\r\n\r\n\t\t\t\t\t\t}).then(r => {\r\n\r\n\t\t\t\t\t\t\tthis.core.store.dispatch('FETCH_EVENTS')\r\n\r\n\t\t\t\t\t\t\tthis.$emit('clearRelationEvent')\r\n\r\n\t\t\t\t\t\t\tthis.$emit('force')\r\n\r\n\t\t\t\t\t\t\treturn Promise.resolve()\r\n\t\t\t\t\t\t}).catch(e => {\r\n\r\n\t\t\t\t\t\t\tconsole.error(e)\r\n\t\t\t\t\t\t\treturn Promise.reject(e)\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this.core.mtrx.sendtext(this.chat, text, { relation: this.relationEvent })\r\n\r\n\t\t\t}).catch(e => {\r\n\r\n\r\n\t\t\t\tthis.$emit('sentMessageError', {\r\n\t\t\t\t\terror: e\r\n\t\t\t\t})\r\n\r\n\t\t\t})\r\n\r\n\t\t},\r\n\r\n\t\tpasteImage(data) {\r\n\t\t\tthis.sendImage({ base64: data })\r\n\t\t},\r\n\r\n\t\tsendImage: function ({ base64, file }) {\r\n\r\n\t\t\tvar id = f.makeid()\r\n\r\n\t\t\tvar meta = {\r\n\t\t\t\ttype: \"image\",\r\n\t\t\t\tid: id,\r\n\t\t\t\tbase64: base64,\r\n\t\t\t}\r\n\r\n\t\t\tthis.$emit(\"sendingData\", meta)\r\n\t\t\t//setTimeout(() => {\r\n\t\t\tthis.$f.pretry(() => {\r\n\r\n\t\t\t\treturn this.chat\r\n\r\n\t\t\t}).then(() => {\r\n\t\t\t\tif (meta.aborted)\r\n\t\t\t\t\treturn Promise.reject('aborted')\r\n\t\t\t\tif(this.relationEvent) {\r\n\t\t\t\t\tmeta.event = this.relationEvent ? this.relationEvent : {}\r\n\t\t\t\t\tthis.$emit('sent')\r\n\t\t\t\t}\r\n\t\t\t\treturn this.core.mtrx.sendImage(this.chat, base64, null, meta, { relation: this.relationEvent })\r\n\r\n\t\t\t}).then(r => {\r\n\r\n\t\t\t\tthis.$emit(\"sentData\", {\r\n\t\t\t\t\tid: id\r\n\t\t\t\t})\r\n\r\n\t\t\t\treturn Promise.resolve()\r\n\r\n\t\t\t}).catch(e => {\r\n\r\n\t\t\t\tthis.$emit('sentError', {\r\n\t\t\t\t\tid: id,\r\n\t\t\t\t\terror: e\r\n\t\t\t\t})\r\n\r\n\t\t\t\treturn Promise.resolve()\r\n\r\n\t\t\t})\r\n\t\t\t//}, 5000)\r\n\r\n\r\n\t\t},\r\n\r\n\t\tcanencryptfilesize: function (file) {\r\n\r\n\t\t\tvar s = 10 * 1024 * 1024\r\n\r\n\t\t\tif (!this.chat.pcrypto.canBeEncrypt()) {\r\n\t\t\t\treturn Promise.resolve(false)\r\n\t\t\t}\r\n\r\n\t\t\tif (file.size > s) {\r\n\r\n\r\n\t\t\t\treturn this.$dialog.confirm(\r\n\t\t\t\t\t'Files larger than 10 megabytes are not encrypted. Do you want to send the file unencrypted?', {\r\n\t\t\t\t\tokText: 'Yes',\r\n\t\t\t\t\tcancelText: 'No, cancel'\r\n\t\t\t\t})\r\n\r\n\t\t\t\t\t.then((dialog) => {\r\n\r\n\t\t\t\t\t\treturn Promise.resolve(true)\r\n\r\n\t\t\t\t\t}).catch(e => {\r\n\t\t\t\t\t\treturn Promise.reject('cancel')\r\n\t\t\t\t\t})\r\n\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn Promise.resolve(false)\r\n\t\t},\r\n\r\n\t\tsendFile: function ({ file }) {\r\n\r\n\t\t\tvar id = f.makeid()\r\n\r\n\t\t\tvar meta = {\r\n\t\t\t\ttype: \"file\",\r\n\t\t\t\tid: id,\r\n\t\t\t\tinfo: {\r\n\t\t\t\t\tname: file.name,\r\n\t\t\t\t\tsize: file.size\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.$emit(\"sendingData\", meta)\r\n\r\n\t\t\tthis.$f.pretry(() => {\r\n\r\n\t\t\t\treturn this.chat\r\n\r\n\t\t\t}).then(() => {\r\n\r\n\t\t\t\treturn this.canencryptfilesize(file)\r\n\r\n\r\n\t\t\t}).then((notenc) => {\r\n\t\t\t\tif(this.relationEvent) {\r\n\t\t\t\t\tthis.$emit('sent')\r\n\t\t\t\t}\r\n\t\t\t\treturn this.core.mtrx.sendFile(this.chat, file, meta, { relation: this.relationEvent }, notenc)\r\n\r\n\t\t\t}).then(() => {\r\n\r\n\t\t\t\tthis.$emit(\"sentData\", {\r\n\t\t\t\t\tid: id\r\n\t\t\t\t})\r\n\r\n\t\t\t\treturn Promise.resolve()\r\n\r\n\t\t\t}).catch(e => {\r\n\r\n\t\t\t\tconsole.error(e)\r\n\r\n\t\t\t\tthis.$emit('sentError', {\r\n\t\t\t\t\tid: id,\r\n\t\t\t\t\terror: e\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\r\n\t\t},\r\n\r\n\t\tfocus: function () {\r\n\t\t\tif (this.$refs['newinput'])\r\n\t\t\t\tthis.$refs['newinput'].focus()\r\n\t\t},\r\n\r\n\t\tfocused: function () {\r\n\t\t\tthis.$emit('focused')\r\n\t\t},\r\n\r\n\t\tblur: function () {\r\n\t\t\tif (this.$refs['newinput'])\r\n\t\t\t\tthis.$refs['newinput'].blur()\r\n\t\t},\r\n\r\n\t\tblurifempty: function () {\r\n\t\t\tif (this.$refs['newinput'])\r\n\t\t\t\tthis.$refs['newinput'].blurifempty()\r\n\t\t},\r\n\r\n\t\tchange: function () {\r\n\t\t},\r\n\r\n\t\tsetText: function (text) {\r\n\t\t\tthis.text = text\r\n\r\n\t\t\tif (this.$refs['newinput'])\r\n\t\t\t\tthis.$refs['newinput'].setText(text)\r\n\t\t},\r\n\r\n\t\tkeyup: function (evt) {\r\n\t\t\tvar value = evt.target.value\r\n\r\n\t\t\tif (value === '') {\r\n\t\t\t\tthis.$emit('inputClean', false)\r\n\t\t\t\treturn\r\n\t\t\t} else {\r\n\t\t\t\tthis.$emit('inputClean', true)\r\n\t\t\t}\r\n\r\n\t\t\tthis.text = value\r\n\t\t\tthis.anyUrlMeta = f.getUrl(this.text)\r\n\r\n\r\n\t\t\tif (this.anyUrlMeta !== undefined) {\r\n\t\t\t\tthis.$emit('setMetaUrl', this.anyUrlMeta)\r\n\t\t\t} else {\r\n\t\t\t\tthis.$emit('inputClean', false)\r\n\t\t\t}\r\n\r\n\t\t\tif (this.chat)\r\n\t\t\t\tthis.core.mtrx.client.sendTyping(this.chat.roomId, true, 100)\r\n\t\t},\r\n\r\n\t\tmenuItemClick(item, rowObject) {\r\n\t\t\tthis[item.click](rowObject);\r\n\t\t},\r\n\r\n\t\tmenuItemLoadedHandler: function (value) {\r\n\r\n\t\t\tthis.menuIsVisible = value\r\n\r\n\t\t\treturn this.menuIsVisible\r\n\t\t},\r\n\r\n\t\tuploadStart(item, files) {\r\n\r\n\t\t},\r\n\r\n\t\tuploadError(item, error) {\r\n\t\t\tthis.$store.commit('icon', {\r\n\t\t\t\ticon: 'error',\r\n\t\t\t\tmessage: error.text\r\n\t\t\t})\r\n\t\t},\r\n\t\tgetImg() {\r\n\t\t\treturn this.imgs = true\r\n\t\t},\r\n\t\tuploadSizeError(value) {\r\n\t\t\tif (!value) {\r\n\t\t\t\tthis.$refs.dropdownMenu.hidePopup();\r\n\t\t\t}\r\n\t\t},\r\n\t\tuploadUploaded(item, data) {\r\n\t\t\tconst validImageTypes = ['image/gif', 'image/jpeg', 'image/png', 'image/webp'];\r\n\r\n\r\n\t\t\tif (!validImageTypes.includes(data.file.type)) {\r\n\t\t\t\tthis.sendFile(data)\r\n\t\t\t} else {\r\n\t\t\t\treturn this.sendImage(data)\r\n\t\t\t}\r\n\t\t},\r\n\t\timageWH(file) {\r\n\t\t\tconst img = new Image();\r\n\t\t\tvar imgInfo = {};\r\n\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\r\n\t\t\t\timg.onload = function () {\r\n\t\t\t\t\timgInfo.w = this.width\r\n\t\t\t\t\timgInfo.h = this.height\r\n\t\t\t\t\tresolve(imgInfo)\r\n\t\t\t\t}\r\n\r\n\t\t\t\timg.onerror = function (e) {\r\n\t\t\t\t\treject(e)\r\n\t\t\t\t}\r\n\r\n\t\t\t\timg.src = file.base64\r\n\t\t\t})\r\n\r\n\t\t},\r\n\t\tuploadUploadedAll(item, result) {\r\n\t\t\tthis.$store.state.loading = false\r\n\t\t\tthis.$refs.dropdownMenu.hidePopup();\r\n\t\t},\r\n\r\n\t\tcatchPermissonsError(err) {\r\n\r\n\t\t\tif (err == 'permissions' || (err.toString && err.toString().indexOf('Permission') > -1)) {\r\n\t\t\t\tthis.microphoneDisabled = true\r\n\r\n\t\t\t\tif (window.cordova) {\r\n\t\t\t\t\tthis.$dialog.confirm(\r\n\t\t\t\t\t\tthis.$i18n.t('micaccesscordova'), {\r\n\t\t\t\t\t\tokText: this.$i18n.t(\"button.ok\"),\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.$dialog.confirm(\r\n\t\t\t\t\t\tthis.$i18n.t('micaccessbrowser'), {\r\n\t\t\t\t\t\tokText: this.$i18n.t(\"button.ok\"),\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\tif ((err.toString && err.toString().indexOf('device not found') > -1)) {\r\n\t\t\t\tthis.$dialog.confirm(\r\n\t\t\t\t\tthis.$i18n.t('micdevicenotfound'), {\r\n\t\t\t\t\tokText: this.$i18n.t(\"button.ok\"),\r\n\t\t\t\t})\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\r\n\t\t\tthis.$dialog.confirm(\r\n\t\t\t\tthis.$i18n.t('micaccesscommonproblem'), {\r\n\t\t\t\tokText: this.$i18n.t(\"button.ok\"),\r\n\t\t\t})\r\n\r\n\t\t\tconsole.error(err)\r\n\t\t},\r\n\r\n\t\tgetFileIosCordova (path) {\r\n\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\twindow.resolveLocalFileSystemURL(path, (entry) => {\r\n\r\n\r\n\t\t\t\t\tif(!entry){\r\n\t\t\t\t\t\treturn reject('noentry')\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tentry.file((file) => {\r\n\t\t\t\t\t\tvar reader = new FileReader()\r\n\t\r\n\t\t\t\t\t\treader.onloadend = function() {\r\n\t\t\t\t\t\t\tvar blob = new Blob([new Uint8Array(this.result)], {type : file.type})\r\n\r\n\t\t\t\t\t\t\tentry.remove()\r\n\r\n\t\t\t\t\t\t\tresolve(blob)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treader.onerror = (e) => {\r\n\r\n\t\t\t\t\t\t\tentry.remove()\r\n\r\n\t\t\t\t\t\t\treject(e)\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treader.readAsArrayBuffer(file)\r\n\t\t\t\t\t})\r\n\t\t\t\t}, (e) => {\r\n\t\t\t\t\treject(e)\r\n\t\t\t\t})\r\n\t\t\t})\r\n\r\n\t\t},\r\n\r\n\t\tinitRecordingCordova() {\r\n\r\n\t\t\tthis.prepareRecording = cancelable(this.core.media.permissions({ audio: true }).then(() => {\r\n\t\t\t\tthis.microphoneDisabled = false\r\n\r\n\t\t\t\treturn Promise.resolve()\r\n\t\t\t}).catch(err => {\r\n\r\n\t\t\t\tconsole.error(err)\r\n\r\n\t\t\t\tthis.catchPermissonsError(err)\r\n\r\n\t\t\t\treturn Promise.reject(err)\r\n\r\n\t\t\t}))\r\n\r\n\t\t\tthis.prepareRecording.then(() => {\r\n\r\n\t\t\t\tthis.microphoneDisabled = false\r\n\r\n\t\t\t\tvar path = 'recording.mp3'\r\n\r\n\t\t\t\tif(f.isios()) path = 'cdvfile://localhost/temporary/recording.m4a'\r\n\r\n\t\t\t\tvar sec = 0\r\n\r\n\t\t\t\tthis.audioContext = this.core.getAudioContext()\r\n\r\n\t\t\t\t//var startedTime = (new Date()).getTime() / 1000\r\n\r\n\t\t\t\tvar media = this.cordovaMediaRecorder = new Media(path, () => {\r\n\r\n\t\t\t\t\tthis.recordTime = 0\r\n\r\n\t\t\t\t\tmedia.release()\r\n\r\n\t\t\t\t\tif (this.cancelledCordovaMediaRecorder) {\r\n\r\n\t\t\t\t\t\tthis.cancelledCordovaMediaRecorder = false\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar fu = null\r\n\r\n\t\t\t\t\t/*if(f.isios()){ */\r\n\r\n\t\t\t\t\t\tfu = this.getFileIosCordova(f.isios() ? path : window.cordova.file.externalDataDirectory + path).then(blob => {\r\n\t\t\t\t\t\t\treturn Promise.resolve({\r\n\t\t\t\t\t\t\t\tdata : blob\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t/*}\r\n\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tfu = f.fetchLocal(path)\r\n\t\t\t\t\t}*/\r\n\r\n\t\t\t\t\tfu.then(r => {\r\n\t\t\t\t\t\t///temp\r\n\t\t\t\t\t\t/*if (f.isios())\r\n\t\t\t\t\t\t\tr.duration = (new Date()).getTime() / 1000 - startedTime\r\n\r\n\t\t\t\t\t\tconsole.log(\"R\", r)\r\n\r\n\t\t\t\t\t\t/*var e = {\r\n\t\t\t\t\t\t\tdata : r.data\r\n\t\t\t\t\t\t}*/\r\n\r\n\r\n\t\t\t\t\t\tif (media.duration && media.duration > 0){\r\n\t\t\t\t\t\t\tr.duration = media.duration\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.createVoiceMessage(r, true)\r\n\r\n\t\t\t\t\t\treturn Promise.resolve()\r\n\r\n\t\t\t\t\t}).catch(e => {\r\n\r\n\t\t\t\t\t\tthis.clear()\r\n\r\n\t\t\t\t\t\tconsole.error(e)\r\n\t\t\t\t\t}).finally(() => {\r\n\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t}, (e) => {\r\n\r\n\t\t\t\t\tconsole.error(e)\r\n\r\n\t\t\t\t\tthis.isRecording = false\r\n\t\t\t\t\tthis.clear()\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\tvar rmsdata = []\r\n\r\n\t\t\t\tlet currentPlaying = this.$store.state.currentPlayingVoiceMessage\r\n\r\n\t\t\t\tif (currentPlaying) {\r\n\t\t\t\t\tcurrentPlaying.pause()\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tthis.interval = setInterval(() => {\r\n\t\t\t\t\t// get media amplitude\r\n\r\n\t\t\t\t\tif(f.isios()){\r\n\t\t\t\t\t\trmsdata.push(1)\r\n\r\n\t\t\t\t\t\tif (rmsdata.length > 50) rmsdata = _.last(rmsdata, 50)\r\n\r\n\t\t\t\t\t\tthis.recordRmsData = _.clone(rmsdata)\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tthis.cordovaMediaRecorder.getCurrentAmplitude(\r\n\t\t\t\t\t\t\t// success callback\r\n\t\t\t\t\t\t\t(amp) => {\r\n\r\n\t\t\t\t\t\t\t\trmsdata.push(amp * 1000)\r\n\r\n\t\t\t\t\t\t\t\tif (rmsdata.length > 50) rmsdata = _.last(rmsdata, 50)\r\n\r\n\t\t\t\t\t\t\t\tthis.recordRmsData = _.clone(rmsdata)\r\n\r\n\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfunction (e) {\r\n\t\t\t\t\t\t\t\tconsole.log(\"E\", e)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\r\n\r\n\r\n\r\n\t\t\t\t\tsec = sec + 50\r\n\r\n\t\t\t\t\tif (sec % 1000 === 0) this.recordTime = sec\r\n\r\n\t\t\t\t}, 50);\r\n\r\n\t\t\t\tthis.isRecording = true\r\n\t\t\t\tthis.cancelOpacity = 0\r\n\t\t\t\tthis.recordRmsData = []\r\n\t\t\t\tthis.recordTime = 0\r\n\t\t\t\tthis.record = null\r\n\r\n\t\t\t\tthis.cordovaMediaRecorder.startRecord();\r\n\r\n\t\t\t}).catch((e) => {\r\n\t\t\t\tconsole.error(e)\r\n\r\n\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tthis.prepareRecording = null\r\n\t\t\t})\r\n\r\n\t\t},\r\n\r\n\t\tinitRecording() {\r\n\r\n\t\t\tif (this.prepareRecording || this.isRecording || this.cordovaMediaRecorder) return\r\n\r\n\t\t\tif (window.cordova) {\r\n\t\t\t\treturn this.initRecordingCordova()\r\n\t\t\t}\r\n\r\n\t\t\tthis.prepareRecording = cancelable(this.core.initMediaRecorder().then((recorder) => {\r\n\r\n\t\t\t\tthis.microphoneDisabled = false\r\n\r\n\t\t\t\tif (this.prepareRecording) {\r\n\t\t\t\t\treturn Promise.resolve(recorder)\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\trecorder.stream.getTracks().forEach((track) => {\r\n\t\t\t\t\t\ttrack.stop();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t}).catch(err => {\r\n\r\n\t\t\t\tthis.catchPermissonsError(err)\r\n\t\t\t\treturn Promise.reject(err)\r\n\r\n\t\t\t}))\r\n\r\n\r\n\t\t\tthis.prepareRecording.then((recorder) => {\r\n\r\n\r\n\t\t\t\tthis.mediaRecorder = recorder\r\n\r\n\t\t\t\tthis.audioContext = this.core.getAudioContext()\r\n\t\t\t\tthis.audioAnalyser = this.audioContext.createAnalyser()\r\n\r\n\t\t\t\t//var audioDataArray = new Uint8Array(this.audioAnalyser.frequencyBinCount)\r\n\r\n\t\t\t\tvar src = this.audioContext.createMediaStreamSource(this.mediaRecorder.stream)\r\n\t\t\t\tsrc.connect(this.audioAnalyser)\r\n\r\n\t\t\t\tthis.startRecording()\r\n\r\n\t\t\t}).catch(() => { }).finally(() => {\r\n\t\t\t\tthis.prepareRecording = null\r\n\t\t\t})\r\n\r\n\r\n\t\t},\r\n\r\n\t\tstartRecording() {\r\n\r\n\t\t\tlet currentPlaying = this.$store.state.currentPlayingVoiceMessage\r\n\r\n\t\t\tif (currentPlaying) {\r\n\t\t\t\tcurrentPlaying.pause()\r\n\t\t\t}\r\n\r\n\t\t\tthis.$store.commit('SET_VOICERECORDING', true)\r\n\r\n\t\t\tthis.isRecording = true\r\n\t\t\tthis.cancelOpacity = 0\r\n\t\t\tthis.recordRmsData = []\r\n\t\t\tthis.recordTime = 0\r\n\t\t\tthis.record = null\r\n\t\t\tthis.mediaRecorder.start()\r\n\r\n\t\t\tvar sec = 0\r\n\t\t\tvar rmsdata = []\r\n\r\n\r\n\t\t\tthis.interval = setInterval(() => {\r\n\t\t\t\tvar dataArray = new Uint8Array(this.audioAnalyser.frequencyBinCount)\r\n\r\n\t\t\t\tthis.audioAnalyser.getByteFrequencyData(dataArray)\r\n\r\n\r\n\t\t\t\trmsdata.push(this.generateRms(dataArray))\r\n\r\n\t\t\t\tif (rmsdata.length > 50) rmsdata = _.last(rmsdata, 50)\r\n\r\n\t\t\t\tsec = sec + 50\r\n\r\n\t\t\t\tthis.recordRmsData = _.clone(rmsdata)\r\n\r\n\t\t\t\tif (sec % 1000 === 0) {\r\n\t\t\t\t\tthis.recordTime = sec\r\n\t\t\t\t}\r\n\r\n\t\t\t}, 50)\r\n\r\n\t\t},\r\n\r\n\r\n\t\tcheckaudioForSend: function (record, sendnow) {\r\n\r\n\t\t\tif (record.duration < 1) {\r\n\t\t\t\tthis.clear()\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (sendnow) {\r\n\t\t\t\t\tthis.sendVoiceMessage(record)\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tthis.record = record\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgetduration(file){\r\n\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tf.readFile(file).then(arraybuffer => {\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\tthis.audioContext.decodeAudioData(arraybuffer, (buffer) => {\r\n\t\t\t\t\t\t\tresolve(buffer.duration)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}catch(e){\r\n\t\t\t\t\t\treject(e)\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}).catch(reject)\r\n\t\t\t})\r\n\r\n\r\n\r\n\t\t},\r\n\r\n\t\tcreateVoiceMessage(event, sendnow) {\r\n\t\t\tvar c = () => {\r\n\r\n\t\t\t\t//this.record =\r\n\r\n\t\t\t\tthis.checkaudioForSend({\r\n\t\t\t\t\tfile: event.data,\r\n\t\t\t\t\tid: f.makeid(),\r\n\t\t\t\t\tduration : event.duration\r\n\t\t\t\t}, sendnow)\r\n\t\t\t}\r\n\r\n\t\t\tif(event.duration){\r\n\r\n\t\t\t\tc()\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tthis.getduration(event.data).then(duration => {\r\n\t\t\t\t\tevent.duration = duration\r\n\r\n\t\t\t\t\tc()\r\n\t\t\t\t}).catch((e) => {\r\n\t\t\t\t\tconsole.error(e)\r\n\r\n\t\t\t\t\tthis.clear()\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\r\n\t\t\t/*f.readFile(event.data).then(arraybuffer => {\r\n\r\n\t\t\t\tconsole.log('arraybuffer', arraybuffer)\r\n\r\n\t\t\t\tthis.audioContext.decodeAudioData(arraybuffer, (buffer) => {\r\n\r\n\t\t\t\t\tconsole.log('this.record', this.record)\r\n\t\t\t\t\tconsole.log('this.buffer', buffer)\r\n\r\n\r\n\t\t\t\t\tthis.record = {\r\n\t\t\t\t\t\tfile: event.data,\r\n\t\t\t\t\t\tid: f.makeid()\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.record.duration = buffer.duration\r\n\r\n\t\t\t\t\tthis.checkaudioForSend(sendnow)\r\n\r\n\t\t\t\t})\r\n\r\n\t\t\t}).catch(e => {\r\n\t\t\t\tconsole.error('e', e)\r\n\t\t\t\tthis.clear()\r\n\t\t\t\t//\r\n\t\t\t})*/\r\n\r\n\t\t},\r\n\r\n\t\tgenerateRms(frequencies) {\r\n\t\t\treturn +Math.sqrt(frequencies.reduce((a, b) => a + b ** 2) / frequencies.length).toPrecision(4)\r\n\t\t},\r\n\r\n\t\tstopRecording({ cancel, sendnow }) {\r\n\r\n\t\t\tconsole.log(\"STOP RECORDING\", this.isRecording)\r\n\r\n\r\n\t\t\tthis.$store.commit('SET_VOICERECORDING', false)\r\n\r\n\t\t\tif (this.prepareRecording) {\r\n\r\n\t\t\t\tthis.prepareRecording.cancel()\r\n\t\t\t\tthis.prepareRecording = null\r\n\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\tthis.isRecording = false\r\n\r\n\t\t\tif (this.interval) {\r\n\t\t\t\tclearInterval(this.interval)\r\n\t\t\t\tthis.interval = null\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif (this.mediaRecorder) {\r\n\r\n\t\t\t\tif (cancel) {\r\n\t\t\t\t\t//this.mediaRecorder.ondataavailable = () => { }\r\n\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.mediaRecorder.addEventListener('dataavailable', (event) => {\r\n\t\t\t\t\t\tthis.createVoiceMessage(event, sendnow)\r\n\t\t\t\t\t})//ondataavailable = (event) => this.createVoiceMessage(event, sendnow)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.mediaRecorder.stop()\r\n\r\n\t\t\t\tthis.mediaRecorder.stream.getTracks().forEach((track) => {\r\n\t\t\t\t\ttrack.stop();\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.mediaRecorder = null\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif (this.cordovaMediaRecorder) {\r\n\r\n\t\t\t\tif (cancel) {\r\n\t\t\t\t\tthis.cancelledCordovaMediaRecorder = true\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.cancelledCordovaMediaRecorder = false\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.cordovaMediaRecorder.stopRecord()\r\n\t\t\t\tthis.cordovaMediaRecorder = null\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tasync sendVoiceMessage(record) {\r\n\r\n\t\t\tif(!record) record = this.record\r\n\r\n\t\t\tif(!record) {\r\n\t\t\t\tthis.clear()\r\n\t\t\t}\r\n\r\n\t\t\tthis.recordRmsData = []\r\n\r\n\t\t\tconst base64 = await this.core.convertAudioToBase64(record.file)\r\n\r\n\t\t\tconst id = f.makeid()\r\n\r\n\t\t\tconst meta = {\r\n\t\t\t\ttype: \"audio\",\r\n\t\t\t\tid: id,\r\n\t\t\t\tbase64: base64,\r\n\t\t\t}\r\n\r\n\t\t\tthis.clear()\r\n\r\n\t\t\tthis.$f.pretry(() => {\r\n\t\t\t\treturn this.chat\r\n\t\t\t}).then(() => {\r\n\t\t\t\tif(this.relationEvent) {\r\n\t\t\t\t\tmeta.event = this.relationEvent ? this.relationEvent : {}\r\n\t\t\t\t\tthis.$emit('sent')\r\n\t\t\t\t}\r\n\t\t\t\treturn this.core.mtrx.sendAudio(this.chat, base64, null, meta, { relation: this.relationEvent })\r\n\t\t\t}).catch(e => {\r\n\t\t\t\tthis.$emit('sentError', {\r\n\t\t\t\t\tid: id,\r\n\t\t\t\t\terror: e\r\n\t\t\t\t})\r\n\t\t\t\treturn Promise.resolve()\r\n\t\t\t})\r\n\r\n\r\n\t\t},\r\n\r\n\t\tclear() {\r\n\t\t\tthis.record = null\r\n\t\t\tthis.recordRmsData = []\r\n\t\t\tthis.recordTime = 0\r\n\r\n\t\t\tif (this.interval) {\r\n\t\t\t\tclearInterval(this.interval)\r\n\t\t\t\tthis.interval = null\r\n\t\t\t}\r\n\r\n\t\t\tif (this.cordovaMediaRecorder) {\r\n\t\t\t\tthis.cordovaMediaRecorder = null\r\n\t\t\t}\r\n\r\n\t\t\tif (this.mediaRecorder) {\r\n\r\n\t\t\t\tthis.mediaRecorder.stop()\r\n\t\t\t\tthis.mediaRecorder.stream.getTracks().forEach((track) => {\r\n\t\t\t\t\ttrack.stop();\r\n\t\t\t\t});\r\n\t\t\t\tthis.mediaRecorder = null\r\n\t\t\t}\r\n\r\n\t\t\t/*if (this.audioContext){\r\n\t\t\t\tthis.audioContext.close()\r\n\t\t\t}*/\r\n\t\t},\r\n\r\n\t\t/*async convertAudioToBase64(blob) {\r\n\t\t\tconst reader = new FileReader()\r\n\t\t\treader.readAsDataURL(blob)\r\n\t\t\treturn new Promise(resolve => {\r\n\t\t\t\treader.onloadend = () => {\r\n\t\t\t\t\tresolve(reader.result)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},*/\r\n\r\n\t\tsetOpacity(opacity) {\r\n\t\t\tthis.cancelOpacity = opacity\r\n\t\t}\r\n\r\n\t},\r\n}\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!./index.js?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!./index.js?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=e8b463ac&scoped=true&\"\nimport script from \"./index.js?vue&type=script&lang=js&\"\nexport * from \"./index.js?vue&type=script&lang=js&\"\nimport style0 from \"./index.sass?vue&type=style&index=0&id=e8b463ac&scoped=true&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e8b463ac\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}