(globalThis.webpackChunkpeertube_client=globalThis.webpackChunkpeertube_client||[]).push([[543],{4170:(e,t,n)=>{"use strict";n.d(t,{AO:()=>u,M_:()=>c,OV:()=>r,Pz:()=>h,W7:()=>i,ZC:()=>s,ao:()=>a,pW:()=>d,v_:()=>f,y_:()=>l,zZ:()=>p});var o=n(8859);function r(){let e=b("volume");if(null!=e){let t=parseFloat(e);if(isNaN(t))return;return t}}function i(){let e=b("mute");if(null!=e)return"true"===e}function l(){let e=b("theater-enabled");return null!=e&&"true"===e}function a(e){return v("volume",e.toString())}function s(e){return v("mute",e.toString())}function u(e){return v("theater-enabled",e.toString())}function c(e){return v("average-bandwidth",e.toString())}function p(){let e=b("average-bandwidth");if(null!=e){let t=parseInt(e,10);if(isNaN(t))return;return t}}function f(e){return v("last-subtitle",e)}function d(){return b("last-subtitle")}function h(e,t){return v("video-watch-history",JSON.stringify(Object.assign(Object.assign({},function(e){let t;try{let e=b("video-watch-history");if(!e)return{};t=JSON.parse(e)}catch(n){o.k.error("Cannot parse video watch history from local storage/",n)}return t=t||{},t}()),{[e]:{duration:t,date:`${(new Date).toISOString()}`}})))}let y="peertube-videojs-";function b(e){try{return localStorage.getItem(y+e)}catch(t){return}}function v(e,t){try{localStorage.setItem(y+e,t)}catch(n){}}},1543:(e,t,n)=>{"use strict";n.r(t),n.d(t,{PeertubePlayerManager:()=>Nn,videojs:()=>r()}),n(3059);var o=n(3654),r=n.n(o);function i(){return i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=l(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},i.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}function s(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}let c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(p,e);var t,n,o,l,c=(o=p,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=u(o);if(l){var n=u(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return s(this,e)});function p(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(n=c.call(this,e,t)).dashOffsetTotal=586,n.dashOffsetStart=293,n.interval=50,n.upNextEvents=new(r().EventTarget),n.ticks=0,n.totalTicks=n.options_.timeout/n.interval,e.on("ended",(t=>{n.options_.condition()&&(e.addClass("vjs-upnext--showing"),n.showCard((t=>{e.removeClass("vjs-upnext--showing"),n.container.style.display="none",t||n.options_.next()})))})),e.on("playing",(()=>{n.upNextEvents.trigger("playing")})),n}return t=p,(n=[{key:"createEl",value:function(){let e=i(u(p.prototype),"createEl",this).call(this,"div",{className:"vjs-upnext-content",innerHTML:(t=this.options_,`\n    <div class="vjs-upnext-top">\n      <span class="vjs-upnext-headtext">${t.headText}</span>\n      <div class="vjs-upnext-title"></div>\n    </div>\n    <div class="vjs-upnext-autoplay-icon">\n      <svg height="100%" version="1.1" viewbox="0 0 98 98" width="100%">\n        <circle class="vjs-upnext-svg-autoplay-circle" cx="49" cy="49" fill="#000" fill-opacity="0.8" r="48"></circle>\n        <circle class="vjs-upnext-svg-autoplay-ring" cx="-49" cy="49" fill-opacity="0" r="46.5"\n                stroke="#FFFFFF" stroke-width="4" transform="rotate(-90)"\n        ></circle>\n        <polygon class="vjs-upnext-svg-autoplay-triangle" fill="#fff" points="32,27 72,49 32,71"></polygon></svg>\n    </div>\n    <span class="vjs-upnext-bottom">\n      <span class="vjs-upnext-cancel">\n        <button class="vjs-upnext-cancel-button" tabindex="0" aria-label="Cancel autoplay">${t.cancelText}</button>\n      </span>\n      <span class="vjs-upnext-suspended">${t.suspendedText}</span>\n    </span>\n  `)});var t;return this.container=e,e.style.display="none",this.autoplayRing=e.getElementsByClassName("vjs-upnext-svg-autoplay-ring")[0],this.title=e.getElementsByClassName("vjs-upnext-title")[0],this.cancelButton=e.getElementsByClassName("vjs-upnext-cancel-button")[0],this.suspendedMessage=e.getElementsByClassName("vjs-upnext-suspended")[0],this.nextButton=e.getElementsByClassName("vjs-upnext-autoplay-icon")[0],this.cancelButton.onclick=()=>{this.upNextEvents.trigger("cancel")},this.nextButton.onclick=()=>{this.upNextEvents.trigger("next")},e}},{key:"showCard",value:function(e){let t;this.autoplayRing.setAttribute("stroke-dasharray",`${this.dashOffsetStart}`),this.autoplayRing.setAttribute("stroke-dashoffset",""+-this.dashOffsetStart),this.title.innerHTML=this.options_.getTitle(),this.upNextEvents.one("cancel",(()=>{clearTimeout(t),e(!0)})),this.upNextEvents.one("playing",(()=>{clearTimeout(t),e(!0)})),this.upNextEvents.one("next",(()=>{clearTimeout(t),e(!1)}));let n=e=>{let t=Math.max(-this.dashOffsetTotal,-this.dashOffsetStart-e*this.dashOffsetTotal/2/100);this.autoplayRing.setAttribute("stroke-dashoffset",""+t)},o=()=>{n(100*this.ticks++/this.totalTicks)},r=()=>{this.options_.suspended()?(this.suspendedMessage.innerText=this.options_.suspendedText,n(0),this.ticks=0,t=setTimeout(r.bind(this),300)):this.ticks>=this.totalTicks?(clearTimeout(t),e(!1)):(this.suspendedMessage.innerText="",o(),t=setTimeout(r.bind(this),this.interval))};this.container.style.display="block",t=setTimeout(r.bind(this),this.interval)}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),p}(r().getComponent("Component"));function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}r().registerComponent("EndCard",c);let y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(i,e);var t,n,o,r=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(n);if(o){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return d(this,e)});function i(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};p(this,i);let o={next:n.next,getTitle:n.getTitle,timeout:n.timeout||5e3,cancelText:n.cancelText||"Cancel",headText:n.headText||"Up Next",suspendedText:n.suspendedText||"Autoplay is suspended",condition:n.condition,suspended:n.suspended};return(t=r.call(this,e)).player.ready((()=>{e.addClass("vjs-upnext")})),e.addChild("EndCard",o),t}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(r().getPlugin("plugin"));r().registerPlugin("upnext",y);var b=n(8859),v=n(7862),m=n(6546);function g(e,t,n,o,r,i,l){try{var a=e[i](l),s=a.value}catch(u){return void n(u)}a.done?t(s):Promise.resolve(s).then(o,r)}function w(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function l(e){g(i,o,r,l,a,"next",e)}function a(e){g(i,o,r,l,a,"throw",e)}l(void 0)}))}}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},j(e,t)}function P(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}let C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}(s,e);var t,n,o,i,l,a=(i=s,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E(i);if(l){var n=E(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return P(this,e)});function s(){var e;return O(this,s),(e=a.apply(this,arguments)).metadataStore={},e.intervalMs=300,e.playerNetworkInfo={},e}return t=s,n=[{key:"createEl",value:function(){this.containerEl=r().dom.createEl("div",{className:"vjs-stats-content"}),this.containerEl.style.display="none",this.infoListEl=r().dom.createEl("div",{className:"vjs-stats-list"});let e=r().dom.createEl("button",{className:"vjs-stats-close",tabindex:"0",title:"Close stats",innerText:"[x]"},{"aria-label":"Close stats"});return e.onclick=()=>this.hide(),this.containerEl.appendChild(e),this.containerEl.appendChild(this.infoListEl),this.populateInfoBlocks(),this.player_.on("p2pInfo",((e,t)=>{if(!t)return;this.mode=t.source;let n=t.p2p,o=t.http;this.playerNetworkInfo.downloadSpeed=(0,m.aI)(n.downloadSpeed+o.downloadSpeed).join(" "),this.playerNetworkInfo.uploadSpeed=(0,m.aI)(n.uploadSpeed+o.uploadSpeed).join(" "),this.playerNetworkInfo.totalDownloaded=(0,m.aI)(n.downloaded+o.downloaded).join(" "),this.playerNetworkInfo.totalUploaded=(0,m.aI)(n.uploaded+o.uploaded).join(" "),this.playerNetworkInfo.numPeers=n.numPeers,this.playerNetworkInfo.averageBandwidth=(0,m.aI)(t.bandwidthEstimate).join(" ")+"/s","p2p-media-loader"===t.source&&(this.playerNetworkInfo.downloadedFromServer=(0,m.aI)(o.downloaded).join(" "),this.playerNetworkInfo.downloadedFromPeers=(0,m.aI)(n.downloaded).join(" "))})),this.containerEl}},{key:"toggle",value:function(){this.updateInterval?this.hide():this.show()}},{key:"show",value:function(){var e=this;this.containerEl.style.display="block",this.updateInterval=setInterval(w((function*(){try{let t="p2p-media-loader"===e.mode?e.buildHLSOptions():yield e.buildWebTorrentOptions();e.populateInfoValues(t)}catch(t){b.k.error("Cannot update stats.",t),clearInterval(e.updateInterval)}})),this.intervalMs)}},{key:"hide",value:function(){clearInterval(this.updateInterval),this.containerEl.style.display="none"}},{key:"buildHLSOptions",value:function(){let e,t,n=this.player_.p2pMediaLoader(),o=n.getCurrentLevel(),r=(null==o?void 0:o.videoCodec)||(null==o?void 0:o.audioCodec)?`${(null==o?void 0:o.videoCodec)||""} / ${(null==o?void 0:o.audioCodec)||""}`:void 0,i=`${null==o?void 0:o.height}p${(null==o?void 0:o.attrs["FRAME-RATE"])||""}`,l=this.timeRangesToString(this.player().buffered());return this.options_.videoIsLive?t=(0,v.nH)(n.getLiveLatency()):e=this.player().bufferedPercent(),{playerNetworkInfo:this.playerNetworkInfo,resolution:i,codecs:r,buffer:l,latency:t,progress:e}}},{key:"buildWebTorrentOptions",value:(o=w((function*(){var e;let t=this.player_.webtorrent().getCurrentVideoFile();this.metadataStore[t.fileUrl]||(this.metadataStore[t.fileUrl]=yield fetch(t.metadataUrl).then((e=>e.json())));let n=this.metadataStore[t.fileUrl],o="unknown",r="unknown";if(null==n?void 0:n.streams[0]){let e=n.streams[0];o="unknown"!==e.color_space?e.color_space:"bt709",r=e.codec_name||"avc1"}let i=(null==t?void 0:t.resolution.label)+(null==t?void 0:t.fps),l=this.timeRangesToString(this.player().buffered()),a=null===(e=this.player_.webtorrent().getTorrent())||void 0===e?void 0:e.progress;return{playerNetworkInfo:this.playerNetworkInfo,progress:a,colorSpace:o,codecs:r,resolution:i,buffer:l}})),function(){return o.apply(this,arguments)})},{key:"populateInfoBlocks",value:function(){this.playerMode=this.buildInfoRow(this.player().localize("Player mode")),this.p2p=this.buildInfoRow(this.player().localize("P2P")),this.uuid=this.buildInfoRow(this.player().localize("Video UUID")),this.viewport=this.buildInfoRow(this.player().localize("Viewport / Frames")),this.resolution=this.buildInfoRow(this.player().localize("Resolution")),this.volume=this.buildInfoRow(this.player().localize("Volume")),this.codecs=this.buildInfoRow(this.player().localize("Codecs")),this.color=this.buildInfoRow(this.player().localize("Color")),this.connection=this.buildInfoRow(this.player().localize("Connection Speed")),this.network=this.buildInfoRow(this.player().localize("Network Activity")),this.transferred=this.buildInfoRow(this.player().localize("Total Transfered")),this.download=this.buildInfoRow(this.player().localize("Download Breakdown")),this.bufferProgress=this.buildInfoRow(this.player().localize("Buffer Progress")),this.bufferState=this.buildInfoRow(this.player().localize("Buffer State")),this.liveLatency=this.buildInfoRow(this.player().localize("Live Latency")),this.infoListEl.appendChild(this.playerMode.root),this.infoListEl.appendChild(this.p2p.root),this.infoListEl.appendChild(this.uuid.root),this.infoListEl.appendChild(this.viewport.root),this.infoListEl.appendChild(this.resolution.root),this.infoListEl.appendChild(this.volume.root),this.infoListEl.appendChild(this.codecs.root),this.infoListEl.appendChild(this.color.root),this.infoListEl.appendChild(this.connection.root),this.infoListEl.appendChild(this.network.root),this.infoListEl.appendChild(this.transferred.root),this.infoListEl.appendChild(this.download.root),this.infoListEl.appendChild(this.bufferProgress.root),this.infoListEl.appendChild(this.bufferState.root),this.infoListEl.appendChild(this.liveLatency.root)}},{key:"populateInfoValues",value:function(e){let{playerNetworkInfo:t,progress:n,colorSpace:o,codecs:r,resolution:i,buffer:l,latency:a}=e,s=this.player(),u=s.getVideoPlaybackQuality(),c=`${Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)}x${Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)}*${(window.devicePixelRatio||1).toFixed(2)} / ${u.droppedVideoFrames} dropped of ${u.totalVideoFrames}`,p=s.duration(),f=`${Math.round(100*s.volume())}`;s.muted()&&(f+=" (muted)");let d=t.downloadSpeed?`${t.downloadSpeed} &dArr; / ${t.uploadSpeed} &uArr;`:void 0,h=t.totalDownloaded?`${t.totalDownloaded} &dArr; / ${t.totalUploaded} &uArr;`:void 0,y=t.downloadedFromServer?`${t.downloadedFromServer} from servers \xb7 ${t.downloadedFromPeers} from peers`:void 0,b=void 0!==n?`${(100*n).toFixed(1)}% (${(n*p).toFixed(1)}s)`:void 0;this.setInfoValue(this.playerMode,this.mode||"HTTP"),this.setInfoValue(this.p2p,s.localize(this.options_.p2pEnabled?"enabled":"disabled")),this.setInfoValue(this.uuid,this.options_.videoUUID),this.setInfoValue(this.viewport,c),this.setInfoValue(this.resolution,i),this.setInfoValue(this.volume,f),this.setInfoValue(this.codecs,r),this.setInfoValue(this.color,o),this.setInfoValue(this.connection,t.averageBandwidth),this.setInfoValue(this.network,d),this.setInfoValue(this.transferred,h),this.setInfoValue(this.download,y),this.setInfoValue(this.bufferProgress,b),this.setInfoValue(this.bufferState,l),this.setInfoValue(this.liveLatency,a)}},{key:"setInfoValue",value:function(e,t){t?(e.root.style.display="block",e.value.innerHTML!==t&&(e.value.innerHTML=t)):e.root.style.display="none"}},{key:"buildInfoRow",value:function(e,t){let n=r().dom.createEl("div");n.style.display="none";let o=r().dom.createEl("div",{innerText:e}),i=r().dom.createEl("span",{innerHTML:t});return n.appendChild(o),n.appendChild(i),{root:n,value:i}}},{key:"timeRangesToString",value:function(e){let t="";for(let n=0;n<e.length;n++){let o=Math.floor(e.start(n)),r=Math.floor(e.end(n));t+=`[${(0,v.nH)(o)}, ${(0,v.nH)(r)}] `}return t}}],n&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(r().getComponent("Component"));function k(e,t){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},k(e,t)}function T(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}r().registerComponent("StatsCard",C);let R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_(o);if(r){var n=_(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return T(this,e)});function l(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);let o=Object.assign({},t);return(n=i.call(this,e)).player.ready((()=>{e.addClass("vjs-stats-for-nerds")})),n.statsCard=new C(e,t),e.addChild(n.statsCard,o),n}return t=l,(n=[{key:"show",value:function(){this.statsCard.show()}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r().getPlugin("plugin"));r().registerPlugin("stats",R);var S=n(7012);function M(){return M="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=x(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},M.apply(this,arguments)}function x(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=B(e)););return e}function I(e,t){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},I(e,t)}function L(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function B(e){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},B(e)}let D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=B(o);if(r){var n=B(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return L(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),n=i.call(this,e,t),(0,S.tq)()?L(n):(e.on("pause",(t=>{e.seeking()||e.ended()||(n.container.innerHTML='\n  <div class="vjs-bezels-pause">\n    <div class="vjs-bezel" role="status" aria-label="Pause">\n      <div class="vjs-bezel-icon">\n        <svg height="100%" version="1.1" viewBox="0 0 36 36" width="100%">\n          <use class="vjs-svg-shadow" xlink:href="#vjs-id-1"></use>\n          <path class="vjs-svg-fill" d="M 12,26 16,26 16,10 12,10 z M 21,26 25,26 25,10 21,10 z" id="vjs-id-1"></path>\n        </svg>\n      </div>\n    </div>\n  </div>\n  ',n.showBezel())})),e.on("play",(t=>{e.seeking()||(n.container.innerHTML='\n  <div class="vjs-bezels-play">\n    <div class="vjs-bezel" role="status" aria-label="Play">\n      <div class="vjs-bezel-icon">\n        <svg height="100%" version="1.1" viewBox="0 0 36 36" width="100%">\n          <use class="vjs-svg-shadow" xlink:href="#vjs-id-2"></use>\n          <path class="vjs-svg-fill" d="M 12,26 18.5,22 18.5,14 12,10 z M 18.5,22 25,18 25,18 18.5,14 z" id="ytp-id-2"></path>\n        </svg>\n      </div>\n    </div>\n  </div>\n  ',n.showBezel())})),n)}return t=l,(n=[{key:"createEl",value:function(){return this.container=M(B(l.prototype),"createEl",this).call(this,"div",{className:"vjs-bezels-content"}),this.container.style.display="none",this.container}},{key:"showBezel",value:function(){this.container.style.display="inherit",setTimeout((()=>{this.container.style.display="none"}),500)}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r().getComponent("Component"));function N(e,t){return N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},N(e,t)}function H(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}r().registerComponent("PauseBezel",D);let U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N(e,t)}(i,e);var t,n,o,r=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=A(n);if(o){var r=A(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return H(this,e)});function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=r.call(this,e)).player.ready((()=>{e.addClass("vjs-bezels")})),e.addChild("PauseBezel",t),n}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(r().getPlugin("plugin"));r().registerPlugin("bezels",U);var V=n(7642),z=n.n(V),F=n(4170);function $(e,t){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$(e,t)}function K(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return W(e)}function W(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q(e){return q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},q(e)}let J=z()("peertube:player:peertube"),G=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}(a,e);var t,n,o,i,l=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=q(o);if(i){var n=q(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return K(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=l.call(this,e)).CONSTANTS={USER_VIEW_VIDEO_INTERVAL:5e3},n.menuOpened=!1,n.mouseInControlBar=!1,n.mouseInSettings=!1,n.videoViewUrl=t.videoViewUrl,n.authorizationHeader=t.authorizationHeader,n.videoUUID=t.videoUUID,n.startTime=(0,v.h8)(t.startTime),n.initialInactivityTimeout=n.player.options_.inactivityTimeout,t.autoplay&&n.player.addClass("vjs-has-autoplay"),n.player.on("autoplay-failure",(()=>{n.player.removeClass("vjs-has-autoplay")})),n.player.ready((()=>{let e=n.player.options_,o=(0,F.OV)();void 0!==o&&n.player.volume(o);let r=void 0!==e.muted?e.muted:(0,F.W7)();if(void 0!==r&&n.player.muted(r),n.defaultSubtitle=t.subtitle||(0,F.pW)(),n.player.on("volumechange",(()=>{(0,F.ao)(n.player.volume()),(0,F.ZC)(n.player.muted())})),t.stopTime){let e=(0,v.h8)(t.stopTime),o=W(n);n.player.on("timeupdate",(function t(){o.player.currentTime()>e&&(o.player.pause(),o.player.trigger("stopped"),o.player.off("timeupdate",t))}))}n.player.textTracks().addEventListener("change",(()=>{let e=n.player.textTracks().tracks_.find((e=>"captions"===e.kind&&"showing"===e.mode));(0,F.v_)(e?e.language:"off")})),console.log("SETDURATION",t.videoDuration),n.player.duration(t.videoDuration),n.initializePlayer(),n.runUserViewing()})),n}return t=a,n=[{key:"dispose",value:function(){this.videoViewInterval&&clearInterval(this.videoViewInterval)}},{key:"onMenuOpened",value:function(){this.menuOpened=!0,this.alterInactivity()}},{key:"onMenuClosed",value:function(){this.menuOpened=!1,this.alterInactivity()}},{key:"displayFatalError",value:function(){this.player.addClass("vjs-error-display-enabled")}},{key:"hideFatalError",value:function(){this.player.removeClass("vjs-error-display-enabled")}},{key:"initializePlayer",value:function(){(0,S.tq)()&&this.player.addClass("vjs-is-mobile"),this.initSmoothProgressBar(),this.listenControlBarMouse(),this.listenFullScreenChange()}},{key:"runUserViewing",value:function(){let e,t=this.startTime;this.player.one("play",(()=>{this.notifyUserIsWatching(this.startTime,e)})),this.player.on("seeked",(()=>{Math.abs(this.player.currentTime()-t)<3||(e="seek")})),this.player.one("ended",(()=>{let n=Math.round(this.player.duration());t=n,this.notifyUserIsWatching(n,e),e=void 0})),this.videoViewInterval=setInterval((()=>{let n=Math.round(this.player.currentTime());n!==t&&(t=n,this.notifyUserIsWatching(n,e).catch((e=>b.k.error("Cannot notify user is watching.",e))),e=void 0,this.authorizationHeader||(0,F.Pz)(this.videoUUID,n))}),this.CONSTANTS.USER_VIEW_VIDEO_INTERVAL)}},{key:"notifyUserIsWatching",value:function(e,t){if(!this.videoViewUrl)return Promise.resolve(void 0);let n={currentTime:e,viewEvent:t},o=new Headers({"Content-type":"application/json; charset=UTF-8"});return this.authorizationHeader&&o.set("Authorization",this.authorizationHeader),fetch(this.videoViewUrl,{method:"POST",body:JSON.stringify(n),headers:o}).catch((e=>Promise.resolve()))}},{key:"listenFullScreenChange",value:function(){this.player.on("fullscreenchange",(()=>{this.player.isFullscreen()&&this.player.focus()}))}},{key:"listenControlBarMouse",value:function(){let e=this.player.controlBar,t=e.settingsButton;e.on("mouseenter",(()=>{this.mouseInControlBar=!0,this.alterInactivity()})),e.on("mouseleave",(()=>{this.mouseInControlBar=!1,this.alterInactivity()})),t.dialog.on("mouseenter",(()=>{this.mouseInSettings=!0,this.alterInactivity()})),t.dialog.on("mouseleave",(()=>{this.mouseInSettings=!1,this.alterInactivity()}))}},{key:"alterInactivity",value:function(){this.menuOpened||this.mouseInSettings||this.mouseInControlBar?this.setInactivityTimeout(0):(this.setInactivityTimeout(this.initialInactivityTimeout),this.player.reportUserActivity(!0))}},{key:"setInactivityTimeout",value:function(e){this.player.cache_.inactivityTimeout=e,this.player.options_.inactivityTimeout=e,J("Set player inactivity to "+e)}},{key:"initSmoothProgressBar",value:function(){let e=r().getComponent("SeekBar");e.prototype.getPercent=function(){let e=this.player_.currentTime()/this.player_.duration();return e>=1?1:e},e.prototype.handleMouseMove=function(e){let t=this.calculateDistance(e)*this.player_.duration();t===this.player_.duration()&&(t-=.1),this.player_.currentTime(t),this.update()}}}],n&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(r().getPlugin("plugin"));function Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z(e,t){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Z(e,t)}function Q(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function X(e){return X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},X(e)}r().registerPlugin("peertube",G);let ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=X(o);if(r){var n=X(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Q(this,e)});function l(){var e;return Y(this,l),(e=i.apply(this,arguments)).resolutions=[],e.autoResolutionEnabled=!0,e}return t=l,(n=[{key:"add",value:function(e){for(let t of e)this.resolutions.push(t);this.currentSelection=this.getSelected(),this.sort(),this.trigger("resolutionsAdded")}},{key:"getResolutions",value:function(){return this.resolutions}},{key:"getSelected",value:function(){return this.resolutions.find((e=>e.selected))}},{key:"getAutoResolutionChosen",value:function(){return this.resolutions.find((e=>e.id===this.autoResolutionChosenId))}},{key:"select",value:function(e){var t;let{id:n,autoResolutionChosenId:o,byEngine:r}=e;if((null===(t=this.currentSelection)||void 0===t?void 0:t.id)!==n||this.autoResolutionChosenId!==o){this.autoResolutionChosenId=o;for(let e of this.resolutions)e.selected=e.id===n,e.selected&&(this.currentSelection=e,r||e.selectCallback());this.trigger("resolutionChanged")}}},{key:"disableAutoResolution",value:function(){this.autoResolutionEnabled=!1,this.trigger("autoResolutionEnabledChanged")}},{key:"enabledAutoResolution",value:function(){this.autoResolutionEnabled=!0,this.trigger("autoResolutionEnabledChanged")}},{key:"isAutoResolutionEnabeld",value:function(){return this.autoResolutionEnabled}},{key:"sort",value:function(){this.resolutions.sort(((e,t)=>-1===e.id?1:-1===t.id||e.height>t.height?-1:e.height===t.height?0:1))}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r().getPlugin("plugin"));function te(e,t){return te=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},te(e,t)}function ne(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function oe(e){return oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},oe(e)}r().registerPlugin("peertubeResolutions",ee);let re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&te(e,t)}(a,e);var t,n,o,i,l=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=oe(o);if(i){var n=oe(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ne(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=l.call(this,e,t)).nextPreviousVideoButtonOptions=t,n.update(),n}return t=a,(n=[{key:"createEl",value:function(){let e=this.options_.type,t=r().dom.createEl("button",{className:"vjs-"+e+"-video"}),n=r().dom.createEl("span",{className:"icon icon-"+e});return t.appendChild(n),t.title=this.player_.localize("next"===e?"Next video":"Previous video"),t}},{key:"handleClick",value:function(){this.nextPreviousVideoButtonOptions.handler()}},{key:"update",value:function(){this.nextPreviousVideoButtonOptions.isDisabled()?this.addClass("vjs-disabled"):this.removeClass("vjs-disabled")}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(r().getComponent("Button"));function ie(e,t){return ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ie(e,t)}function le(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ae(e){return ae=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ae(e)}r().registerComponent("NextVideoButton",re),r().registerComponent("PreviousVideoButton",re);let se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ie(e,t)}(a,e);var t,n,o,i,l=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ae(o);if(i){var n=ae(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return le(this,e)});function a(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),l.call(this,e,t)}return t=a,(n=[{key:"createEl",value:function(){let e=r().dom.createEl("div",{className:"vjs-peertube"}),t=r().dom.createEl("div",{className:"vjs-peertube-hidden"});if(e.appendChild(t),!this.options_.p2pEnabled)return e;let n=r().dom.createEl("span",{className:"icon icon-download"});t.appendChild(n);let o=r().dom.createEl("span",{className:"download-speed-text"}),i=r().dom.createEl("span",{className:"download-speed-number"}),l=r().dom.createEl("span");o.appendChild(i),o.appendChild(l),t.appendChild(o);let a=r().dom.createEl("span",{className:"icon icon-upload"});t.appendChild(a);let s=r().dom.createEl("span",{className:"upload-speed-text"}),u=r().dom.createEl("span",{className:"upload-speed-number"}),c=r().dom.createEl("span");s.appendChild(u),s.appendChild(c),t.appendChild(s);let p=r().dom.createEl("span",{className:"peers-text"}),f=r().dom.createEl("span",{className:"peers-number"});t.appendChild(f),t.appendChild(p);let d=r().dom.createEl("div",{className:"vjs-peertube-hidden"}),h=r().dom.createEl("span",{className:"http-fallback",textContent:"HTTP"});return d.appendChild(h),e.appendChild(d),this.player_.on("p2pInfo",((e,n)=>{if(!n)return d.className="vjs-peertube-displayed",void(t.className="vjs-peertube-hidden");let o=n.p2p,r=n.http,a=(0,m.aI)(o.downloadSpeed+r.downloadSpeed),s=(0,m.aI)(o.uploadSpeed+r.uploadSpeed),h=(0,m.aI)(o.downloaded+r.downloaded),y=(0,m.aI)(o.uploaded+r.uploaded),b=o.numPeers;if(t.title=this.player().localize("Total downloaded: ")+h.join(" ")+"\n","p2p-media-loader"===n.source){let e=(0,m.aI)(r.downloaded).join(" "),n=(0,m.aI)(o.downloaded).join(" ");t.title+=" * "+this.player().localize("From servers: ")+e+"\n * "+this.player().localize("From peers: ")+n+"\n"}t.title+=this.player().localize("Total uploaded: ")+y.join(" "),i.textContent=a[0],l.textContent=" "+a[1],u.textContent=s[0],c.textContent=" "+s[1],f.textContent=b.toString(),p.textContent=" "+(b>1?this.player().localize("peers"):this.player_.localize("peer")),d.className="vjs-peertube-hidden",t.className="vjs-peertube-displayed"})),e}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(r().getComponent("Button"));function ue(){return ue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=ce(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},ue.apply(this,arguments)}function ce(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=de(e)););return e}function pe(e,t){return pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},pe(e,t)}function fe(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function de(e){return de=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},de(e)}r().registerComponent("P2PInfoButton",se),r().getComponent("Button");let he=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pe(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=de(o);if(r){var n=de(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return fe(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=i.call(this,e,t)).controlText("Mini Player"),n}return t=l,(n=[{key:"createEl",value:function(){return this.buildElement()}},{key:"handleClick",value:function(e){this.player_.trigger("pictureInPictureRequest",e)}},{key:"buildElement",value:function(){let e=ue(de(l.prototype),"createEl",this).call(this);return e.classList.add("vjs-picture-in-picture-control"),e}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r().getComponent("MenuButton"));function ye(){return ye="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=be(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},ye.apply(this,arguments)}function be(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ge(e)););return e}function ve(e,t){return ve=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ve(e,t)}function me(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ge(e){return ge=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ge(e)}r().registerComponent("PictureInPictureBastyon",he);let we=r().getComponent("Component");function Oe(){return Oe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=je(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},Oe.apply(this,arguments)}function je(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ce(e)););return e}function Pe(e,t){return Pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Pe(e,t)}function Ee(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ce(e){return Ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ce(e)}we.registerComponent("PeerTubeLoadProgressBar",function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ve(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ge(o);if(r){var n=ge(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return me(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=i.call(this,e,t)).on(e,"progress",n.update),n}return t=l,(n=[{key:"createEl",value:function(){return ye(ge(l.prototype),"createEl",this).call(this,"div",{className:"vjs-load-progress",innerHTML:`<span class="vjs-control-text"><span>${this.localize("Loaded")}</span>: 0%</span>`})}},{key:"dispose",value:function(){ye(ge(l.prototype),"dispose",this).call(this)}},{key:"update",value:function(){let e=this.player().webtorrent().getTorrent();e&&(this.el().style["transform-origin"]="left"(this.el()).style.transform="scaleX("+e.progress.toFixed(2)+")")}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(we));let ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Pe(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ce(o);if(r){var n=Ce(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ee(this,e)});function l(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),n=i.call(this,e,t);let o=(0,F.y_)();return!0===o&&(n.player().addClass(l.THEATER_MODE_CLASS),n.handleTheaterChange()),n.controlText("Theater mode"),n.player().theaterEnabled=o,n}return t=l,(n=[{key:"buildCSSClass",value:function(){return`vjs-theater-control ${Oe(Ce(l.prototype),"buildCSSClass",this).call(this)}`}},{key:"handleTheaterChange",value:function(){let e=this.isTheaterEnabled();this.controlText(e?"Normal mode":"Theater mode"),(0,F.AO)(e),this.player_.trigger("theaterChange",e)}},{key:"handleClick",value:function(){this.player_.toggleClass(l.THEATER_MODE_CLASS),this.handleTheaterChange()}},{key:"isTheaterEnabled",value:function(){return this.player_.hasClass(l.THEATER_MODE_CLASS)}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r().getComponent("Button"));function Te(){return Te="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=_e(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},Te.apply(this,arguments)}function _e(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Me(e)););return e}function Re(e,t){return Re=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Re(e,t)}function Se(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Me(e){return Me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Me(e)}ke.THEATER_MODE_CLASS="vjs-theater-enabled",r().registerComponent("TheaterButton",ke);let xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Re(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Me(o);if(r){var n=Me(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Se(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),t.selectable=!0,(n=i.call(this,e,t)).autoResolutionEnabled=!0,n.autoResolutionChosen="",n.resolutionId=t.resolutionId,n.label=t.label,e.peertubeResolutions().on("resolutionChanged",(()=>n.updateSelection())),-1===n.resolutionId&&e.peertubeResolutions().on("autoResolutionEnabledChanged",(()=>n.updateAutoResolution())),n}return t=l,(n=[{key:"handleClick",value:function(e){!1===this.autoResolutionEnabled&&-1===this.resolutionId||(Te(Me(l.prototype),"handleClick",this).call(this,e),this.player().peertubeResolutions().select({id:this.resolutionId,byEngine:!1}))}},{key:"updateSelection",value:function(){var e;let t=this.player().peertubeResolutions().getSelected();-1===this.resolutionId&&(this.autoResolutionChosen=null===(e=this.player().peertubeResolutions().getAutoResolutionChosen())||void 0===e?void 0:e.label),this.selected(this.resolutionId===t.id)}},{key:"updateAutoResolution",value:function(){let e=this.player().peertubeResolutions().isAutoResolutionEnabeld();!1===e?this.addClass("disabled"):this.removeClass("disabled"),this.autoResolutionEnabled=e}},{key:"getLabel",value:function(){return-1===this.resolutionId?this.label+" <small>"+this.autoResolutionChosen+"</small>":this.label}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r().getComponent("MenuItem"));function Ie(){return Ie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=Le(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},Ie.apply(this,arguments)}function Le(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ne(e)););return e}function Be(e,t){return Be=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Be(e,t)}function De(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ne(e){return Ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ne(e)}r().registerComponent("ResolutionMenuItem",xe);let He=r().getComponent("Menu"),Ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Be(e,t)}(a,e);var t,n,o,i,l=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ne(o);if(i){var n=Ne(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return De(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=l.call(this,e,t)).controlText("Quality"),e.peertubeResolutions().on("resolutionsAdded",(()=>n.buildQualities())),e.peertubeResolutions().on("resolutionChanged",(()=>{setTimeout((()=>n.trigger("labelUpdated")))})),n}return t=a,n=[{key:"createEl",value:function(){let e=Ie(Ne(a.prototype),"createEl",this).call(this);return this.labelEl_=r().dom.createEl("div",{className:"vjs-resolution-value"}),e.appendChild(this.labelEl_),e}},{key:"updateARIAAttributes",value:function(){this.el().setAttribute("aria-label","Quality")}},{key:"createMenu",value:function(){return new He(this.player_)}},{key:"buildCSSClass",value:function(){return Ie(Ne(a.prototype),"buildCSSClass",this).call(this)+" vjs-resolution-button"}},{key:"buildWrapperCSSClass",value:function(){return"vjs-resolution-control "+Ie(Ne(a.prototype),"buildWrapperCSSClass",this).call(this)}},{key:"addClickListener",value:function(e){e.on("click",(()=>{let t=this.menu.children();for(let n of t)e!==n&&n.selected(!1)}))}},{key:"buildQualities",value:function(){for(let e of this.player().peertubeResolutions().getResolutions()){let t="0p"===e.label?this.player().localize("Audio-only"):e.label;this.menu.addChild(new xe(this.player_,{id:e.id+"",resolutionId:e.id,label:t,selected:e.selected}))}for(let e of this.menu.children())this.addClickListener(e);this.trigger("menuChanged")}}],n&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(r().getComponent("MenuButton"));function Ue(){return Ue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=Ve(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},Ue.apply(this,arguments)}function Ve(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$e(e)););return e}function ze(e,t){return ze=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ze(e,t)}function Fe(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function $e(e){return $e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$e(e)}r().registerComponent("ResolutionMenuButton",Ae);let Ke=r().getComponent("Component");function We(){return We="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=qe(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},We.apply(this,arguments)}function qe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ze(e)););return e}function Je(e,t){return Je=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Je(e,t)}function Ge(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ye(e)}function Ye(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ze(e){return Ze=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ze(e)}Ke.registerComponent("SettingsDialog",function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ze(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=$e(o);if(r){var n=$e(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Fe(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=i.call(this,e)).hide(),t}return t=l,(n=[{key:"createEl",value:function(){let e=this.id(),t="TTsettingsDialogLabel-"+e,n="TTsettingsDialogDescription-"+e;return Ue($e(l.prototype),"createEl",this).call(this,"div",{className:"vjs-settings-dialog vjs-modal-overlay",innerHTML:"",tabIndex:-1},{role:"dialog","aria-labelledby":t,"aria-describedby":n})}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(Ke));let Qe=r().getComponent("MenuItem"),Xe=r().getComponent("Component"),et=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Je(e,t)}(a,e);var t,n,o,i,l=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ze(o);if(i){var n=Ze(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ge(this,e)});function a(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=l.call(this,e,t)).settingsButton=t.menuButton,n.dialog=n.settingsButton.dialog,n.mainMenu=n.settingsButton.menu,n.panel=n.dialog.getChild("settingsPanel"),n.panelChild=n.panel.getChild("settingsPanelChild"),n.panelChildEl=n.panelChild.el(),n.size=null,n.menuToLoad="mainmenu";let o=(0,m.LF)(t.entry),i=r().getComponent(o);if(!i)throw new Error(`Component ${o} does not exist`);let s=Object.assign({},t,{entry:t.menuButton,menuButton:Ye(n)});n.subMenu=new i(n.player(),s);let u=n.subMenu.buildCSSClass().split(" ")[0];return n.settingsSubMenuEl_.className+=" "+u,n.eventHandlers(),e.ready((()=>{setTimeout((()=>{n.player_&&(n.build(),e.on("ratechange",n.submenuClickHandler),"CaptionsButton"===o&&e.on("captionsChanged",(()=>{setTimeout((()=>{n.settingsSubMenuEl_.innerHTML="",n.settingsSubMenuEl_.appendChild(n.subMenu.menu.el()),n.update(),n.bindClickEvents()}),0)})),n.reset())}),0)})),n}return t=a,n=[{key:"eventHandlers",value:function(){this.submenuClickHandler=this.onSubmenuClick.bind(this),this.transitionEndHandler=this.onTransitionEnd.bind(this)}},{key:"onSubmenuClick",value:function(e){let t=null;t="tap"===e.type?e.target:e.currentTarget||e.target,(null==t?void 0:t.classList.contains("vjs-back-button"))?this.loadMainMenu():(setTimeout((()=>this.update(e)),0),this.subMenu.menu.removeClass("vjs-hidden"))}},{key:"createEl",value:function(){let e=r().dom.createEl("li",{className:"vjs-menu-item",tabIndex:-1});return this.settingsSubMenuTitleEl_=r().dom.createEl("div",{className:"vjs-settings-sub-menu-title"}),e.appendChild(this.settingsSubMenuTitleEl_),this.settingsSubMenuValueEl_=r().dom.createEl("div",{className:"vjs-settings-sub-menu-value"}),e.appendChild(this.settingsSubMenuValueEl_),this.settingsSubMenuEl_=r().dom.createEl("div",{className:"vjs-settings-sub-menu"}),e}},{key:"handleClick",value:function(e){if(this.menuToLoad="submenu",r().dom.removeClass(this.el(),"open"),We(Ze(a.prototype),"handleClick",this).call(this,e),this.mainMenu.el().style.opacity="0",r().dom.hasClass(this.settingsSubMenuEl_,"vjs-hidden")){r().dom.removeClass(this.settingsSubMenuEl_,"vjs-hidden"),setTimeout((()=>{this.settingsSubMenuEl_.style.opacity="1",this.settingsSubMenuEl_.style.marginRight="0px"}),0),this.settingsButton.setDialogSize(this.size);let e=this.subMenu.menu.children()[0];e&&e.focus()}else r().dom.addClass(this.settingsSubMenuEl_,"vjs-hidden")}},{key:"createBackButton",value:function(){let e=this.subMenu.menu.addChild("MenuItem",{},0);e.addClass("vjs-back-button"),e.el().innerHTML=this.player().localize(this.subMenu.controlText())}},{key:"PrefixedEvent",value:function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"addEvent",r=["webkit","moz","MS","o",""];for(let i=0;i<r.length;i++)r[i]||(t=t.toLowerCase()),"addEvent"===o?e.addEventListener(r[i]+t,n,!1):"removeEvent"===o&&e.removeEventListener(r[i]+t,n,!1)}},{key:"onTransitionEnd",value:function(e){"margin-right"===e.propertyName&&"mainmenu"===this.menuToLoad&&(r().dom.addClass(this.settingsSubMenuEl_,"vjs-hidden"),this.settingsSubMenuEl_.style.opacity="0")}},{key:"reset",value:function(){r().dom.addClass(this.settingsSubMenuEl_,"vjs-hidden"),this.settingsSubMenuEl_.style.opacity="0",this.setMargin()}},{key:"loadMainMenu",value:function(){let e=this.mainMenu.el();this.menuToLoad="mainmenu",this.mainMenu.show(),e.style.opacity="0";let t=this.mainMenu;this.settingsButton.setDialogSize([t.width,t.height]),setTimeout((()=>{this.setMargin(),e.style.opacity="1";let t=this.mainMenu.children()[0];t&&t.focus()}),0)}},{key:"build",value:function(){this.subMenu.on("labelUpdated",(()=>{this.update()})),this.subMenu.on("menuChanged",(()=>{this.bindClickEvents(),this.setSize(),this.update()})),this.settingsSubMenuTitleEl_.innerHTML=this.player().localize(this.subMenu.controlText()),this.settingsSubMenuEl_.appendChild(this.subMenu.menu.el()),this.panelChildEl.appendChild(this.settingsSubMenuEl_),this.update(),this.createBackButton(),this.setSize(),this.bindClickEvents(),this.PrefixedEvent(this.settingsSubMenuEl_,"TransitionEnd",this.transitionEndHandler,"addEvent")}},{key:"update",value:function(e){let t=null,n=this.subMenu.name();if(e&&"tap"===e.type?t=e.target:e&&(t=e.currentTarget),"PlaybackRateMenuButton"===n){let e=this.subMenu.labelEl_.innerHTML;setTimeout((()=>{this.settingsSubMenuValueEl_.innerHTML=e}),250)}else for(let o of this.subMenu.menu.children_)if(o instanceof Xe&&o.hasClass("vjs-selected")){let e=o;if("function"==typeof e.getLabel){this.settingsSubMenuValueEl_.innerHTML=e.getLabel();break}this.settingsSubMenuValueEl_.innerHTML=this.player().localize(e.options_.label)}t&&!t.classList.contains("vjs-back-button")&&this.settingsButton.hideDialog()}},{key:"bindClickEvents",value:function(){for(let e of this.subMenu.menu.children())e instanceof Xe&&e.on(["tap","click"],this.submenuClickHandler)}},{key:"setSize",value:function(){this.dialog.removeClass("vjs-hidden"),r().dom.removeClass(this.settingsSubMenuEl_,"vjs-hidden"),this.size=this.settingsButton.getComponentSize(this.settingsSubMenuEl_),this.setMargin(),this.dialog.addClass("vjs-hidden"),r().dom.addClass(this.settingsSubMenuEl_,"vjs-hidden")}},{key:"setMargin",value:function(){if(!this.size)return;let[e]=this.size;this.settingsSubMenuEl_.style.marginRight=`-${e}px`}},{key:"hideSubMenu",value:function(){this.el()&&r().dom.hasClass(this.el(),"open")&&(r().dom.addClass(this.settingsSubMenuEl_,"vjs-hidden"),r().dom.removeClass(this.el(),"open"))}}],n&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Qe);function tt(){return tt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=nt(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},tt.apply(this,arguments)}function nt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=lt(e)););return e}function ot(e,t){return ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ot(e,t)}function rt(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return it(e)}function it(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lt(e){return lt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},lt(e)}et.prototype.contentElType="button",r().registerComponent("SettingsMenuItem",et);let at=r().getComponent("Button"),st=r().getComponent("Menu"),ut=r().getComponent("Component");function ct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pt(){return pt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=ft(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},pt.apply(this,arguments)}function ft(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=yt(e)););return e}function dt(e,t){return dt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},dt(e,t)}function ht(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function yt(e){return yt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},yt(e)}ut.registerComponent("SettingsButton",function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ot(e,t)}(a,e);var t,n,o,i,l=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=lt(o);if(i){var n=lt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return rt(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=l.call(this,e,t)).settingsButtonOptions=t,n.controlText("Settings"),n.dialog=n.player().addChild("settingsDialog"),n.dialogEl=n.dialog.el(),n.menu=null,n.panel=n.dialog.addChild("settingsPanel"),n.panelChild=n.panel.addChild("settingsPanelChild"),n.addClass("vjs-settings"),n.el().setAttribute("aria-label","Settings Button"),n.addSettingsItemHandler=n.onAddSettingsItem.bind(it(n)),n.disposeSettingsItemHandler=n.onDisposeSettingsItem.bind(it(n)),n.documentClickHandler=n.onDocumentClick.bind(it(n)),n.userInactiveHandler=n.onUserInactive.bind(it(n)),n.buildMenu(),n.bindEvents(),n.player().one("play",(()=>n.hideDialog())),n}return t=a,(n=[{key:"onDocumentClick",value:function(e){var t,n,o;let r=e.target;(null===(t=null==r?void 0:r.classList)||void 0===t?void 0:t.contains("vjs-settings"))||(null===(o=null===(n=null==r?void 0:r.parentElement)||void 0===n?void 0:n.classList)||void 0===o?void 0:o.contains("vjs-settings"))||this.dialog.hasClass("vjs-hidden")||this.hideDialog()}},{key:"onDisposeSettingsItem",value:function(e,t){if(void 0===t){let e=this.menu.children();for(;e.length>0;)e[0].dispose(),this.menu.removeChild(e[0]);this.addClass("vjs-hidden")}else{let e=this.menu.getChild(t);e&&(e.dispose(),this.menu.removeChild(e))}this.hideDialog(),0===this.settingsButtonOptions.entries.length&&this.addClass("vjs-hidden")}},{key:"dispose",value:function(){document.removeEventListener("click",this.documentClickHandler),this.isInIframe()&&window.removeEventListener("blur",this.documentClickHandler)}},{key:"onAddSettingsItem",value:function(e,t){let[n,o]=t;this.addMenuItem(n,o),this.removeClass("vjs-hidden")}},{key:"onUserInactive",value:function(){this.dialog.hasClass("vjs-hidden")||this.hideDialog()}},{key:"bindEvents",value:function(){document.addEventListener("click",this.documentClickHandler),this.isInIframe()&&window.addEventListener("blur",this.documentClickHandler),this.player().on("addsettingsitem",this.addSettingsItemHandler),this.player().on("disposesettingsitem",this.disposeSettingsItemHandler),this.player().on("userinactive",this.userInactiveHandler)}},{key:"buildCSSClass",value:function(){return`vjs-icon-settings ${tt(lt(a.prototype),"buildCSSClass",this).call(this)}`}},{key:"handleClick",value:function(){this.dialog.hasClass("vjs-hidden")?this.showDialog():this.hideDialog()}},{key:"showDialog",value:function(){this.player().peertube().onMenuOpened(),this.menu.el().style.opacity="1",this.dialog.show(),this.el().setAttribute("aria-expanded","true"),this.setDialogSize(this.getComponentSize(this.menu));let e=this.menu.children()[0];e&&e.focus()}},{key:"hideDialog",value:function(){this.player_.peertube().onMenuClosed(),this.dialog.hide(),this.el().setAttribute("aria-expanded","false"),this.setDialogSize(this.getComponentSize(this.menu)),this.menu.el().style.opacity="1",this.resetChildren()}},{key:"getComponentSize",value:function(e){let t=null,n=null;if(e instanceof ut){let o=e.el();t=o.offsetWidth,n=o.offsetHeight,e.width=t,e.height=n}else t=e.offsetWidth,n=e.offsetHeight;return[t,n]}},{key:"setDialogSize",value:function(e){let[t,n]=e;if("number"!=typeof n)return;let o=this.settingsButtonOptions.setup.maxHeightOffset,r=this.player().el().offsetHeight-o,i=this.panel.el();n>r?(n=r,t+=17,i.style.maxHeight=`${n}px`):""!==i.style.maxHeight&&(i.style.maxHeight=""),this.dialogEl.style.width=`${t}px`,this.dialogEl.style.height=`${n}px`}},{key:"buildMenu",value:function(){this.menu=new st(this.player()),this.menu.addClass("vjs-main-menu");let e=this.settingsButtonOptions.entries;if(0===e.length)return this.addClass("vjs-hidden"),void this.panelChild.addChild(this.menu);for(let t of e)this.addMenuItem(t,this.settingsButtonOptions);this.panelChild.addChild(this.menu)}},{key:"addMenuItem",value:function(e,t){t.name=(0,m.LF)(e);let n=Object.assign({},t,{entry:e,menuButton:this}),o=new et(this.player(),n);this.menu.addChild(o),o.on("click",r().bind(this,this.hideChildren)),o.on("click",(function(){r().dom.hasClass(this.el_,"open")?r().dom.removeClass(this.el_,"open"):r().dom.addClass(this.el_,"open")}))}},{key:"resetChildren",value:function(){for(let e of this.menu.children())e.reset()}},{key:"hideChildren",value:function(){for(let e of this.menu.children())e.hideSubMenu()}},{key:"isInIframe",value:function(){return window.self!==window.top}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(at));let bt=r().getComponent("Component");function vt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mt(){return mt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=gt(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},mt.apply(this,arguments)}function gt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jt(e)););return e}function wt(e,t){return wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},wt(e,t)}function Ot(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function jt(e){return jt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},jt(e)}bt.registerComponent("SettingsPanel",function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dt(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=yt(o);if(r){var n=yt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ht(this,e)});function l(){return ct(this,l),i.apply(this,arguments)}return t=l,(n=[{key:"createEl",value:function(){return pt(yt(l.prototype),"createEl",this).call(this,"div",{className:"vjs-settings-panel",innerHTML:"",tabIndex:-1})}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(bt));let Pt=r().getComponent("Component");function Et(){return Et="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=Ct(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},Et.apply(this,arguments)}function Ct(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_t(e)););return e}function kt(e,t){return kt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},kt(e,t)}function Tt(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _t(e){return _t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_t(e)}Pt.registerComponent("SettingsPanelChild",function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wt(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=jt(o);if(r){var n=jt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ot(this,e)});function l(){return vt(this,l),i.apply(this,arguments)}return t=l,(n=[{key:"createEl",value:function(){return mt(jt(l.prototype),"createEl",this).call(this,"div",{className:"vjs-settings-panel-child",innerHTML:"",tabIndex:-1})}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(Pt));let Rt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kt(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_t(o);if(r){var n=_t(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Tt(this,e)});function l(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),i.call(this,e,t)}return t=l,(n=[{key:"createEl",value:function(){this.wrapper=Et(_t(l.prototype),"createEl",this).call(this,"div",{className:"vjs-playlist-button",innerHTML:"",tabIndex:-1});let e=Et(_t(l.prototype),"createEl",this).call(this,"div",{className:"vjs-playlist-icon",innerHTML:"",tabIndex:-1});return this.playlistInfoElement=Et(_t(l.prototype),"createEl",this).call(this,"div",{className:"vjs-playlist-info",innerHTML:"",tabIndex:-1}),this.wrapper.appendChild(e),this.wrapper.appendChild(this.playlistInfoElement),this.update(),this.wrapper}},{key:"update",value:function(){let e=this.options_;this.playlistInfoElement.innerHTML=e.getCurrentPosition()+"/"+e.playlist.videosLength,this.wrapper.title=this.player().localize("Playlist: {1}",[e.playlist.displayName])}},{key:"handleClick",value:function(){this.getPlaylistMenu().open()}},{key:"getPlaylistMenu",value:function(){return this.options_.playlistMenu}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r().getComponent("ClickableComponent"));function St(){return St="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=Mt(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},St.apply(this,arguments)}function Mt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Lt(e)););return e}function xt(e,t){return xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xt(e,t)}function It(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Lt(e){return Lt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Lt(e)}r().registerComponent("PlaylistButton",Rt);let Bt=r().getComponent("Component"),Dt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xt(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Lt(o);if(r){var n=Lt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return It(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=i.call(this,e,t)).emitTapEvents(),n.element=t.element,n.on(["click","tap"],(()=>n.switchPlaylistItem())),n.on("keydown",(e=>n.handleKeyDown(e))),n}return t=l,(n=[{key:"createEl",value:function(){let e=this.options_,t=St(Lt(l.prototype),"createEl",this).call(this,"li",{className:"vjs-playlist-menu-item",innerHTML:""});e.element.video||t.classList.add("vjs-disabled");let n=St(Lt(l.prototype),"createEl",this).call(this,"div",{className:"item-position-block"}),o=St(Lt(l.prototype),"createEl",this).call(this,"div",{className:"item-position",innerHTML:e.element.position});return n.appendChild(o),t.appendChild(n),e.element.video?this.buildAvailableVideo(t,n,e):this.buildUnavailableVideo(t),t}},{key:"setSelected",value:function(e){e?this.addClass("vjs-selected"):this.removeClass("vjs-selected")}},{key:"getElement",value:function(){return this.element}},{key:"buildAvailableVideo",value:function(e,t,n){let o=n.element,r=St(Lt(l.prototype),"createEl",this).call(this,"div",{className:"item-player"});t.appendChild(r);let i=St(Lt(l.prototype),"createEl",this).call(this,"img",{src:window.location.origin+o.video.thumbnailPath}),a=St(Lt(l.prototype),"createEl",this).call(this,"div",{className:"info-block"}),s=St(Lt(l.prototype),"createEl",this).call(this,"div",{innerHTML:o.video.name,className:"title"}),u=St(Lt(l.prototype),"createEl",this).call(this,"div",{innerHTML:o.video.channel.displayName,className:"channel"});if(a.appendChild(s),a.appendChild(u),o.startTimestamp||o.stopTimestamp){let e="";o.startTimestamp&&(e+=(0,v.nH)(o.startTimestamp)),o.stopTimestamp&&(e+=" - "+(0,v.nH)(o.stopTimestamp));let t=St(Lt(l.prototype),"createEl",this).call(this,"div",{innerHTML:e,className:"timestamps"});a.append(t)}e.append(i),e.append(a)}},{key:"buildUnavailableVideo",value:function(e){let t=St(Lt(l.prototype),"createEl",this).call(this,"div",{className:"item-unavailable",innerHTML:this.player().localize("Unavailable video")});e.appendChild(t)}},{key:"handleKeyDown",value:function(e){"Space"!==e.code&&"Enter"!==e.code||this.switchPlaylistItem()}},{key:"switchPlaylistItem",value:function(){this.options_.onClicked()}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(Bt);function Nt(){return Nt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=Ht(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},Nt.apply(this,arguments)}function Ht(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zt(e)););return e}function At(e,t){return At=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},At(e,t)}function Ut(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Vt(e)}function Vt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zt(e){return zt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zt(e)}Bt.registerComponent("PlaylistMenuItem",Dt);let Ft=r().getComponent("Component"),$t=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&At(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=zt(o);if(r){var n=zt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ut(this,e)});function l(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);let o=Vt(n=i.call(this,e,t));function r(){o.close()}return n.el().addEventListener("mouseenter",(()=>{n.player().off("userinactive",r)})),n.el().addEventListener("mouseleave",(()=>{n.player().one("userinactive",r)})),n.player().on("click",(e=>{let t=e.target;do{if(t.classList.contains("vjs-playlist-menu")||t.classList.contains("vjs-playlist-button"))return;t=t.parentElement}while(t);n.close()})),n}return t=l,(n=[{key:"createEl",value:function(){this.menuItems=[];let e=this.getOptions(),t=Nt(zt(l.prototype),"createEl",this).call(this,"div",{className:"vjs-playlist-menu",innerHTML:"",tabIndex:-1}),n=Nt(zt(l.prototype),"createEl",this).call(this,"div",{className:"header"}),o=Nt(zt(l.prototype),"createEl",this).call(this,"div"),r=Nt(zt(l.prototype),"createEl",this).call(this,"div",{innerHTML:e.playlist.displayName,className:"title"}),i=e.playlist.videoChannel,a=Nt(zt(l.prototype),"createEl",this).call(this,"div",{innerHTML:i?this.player().localize("By {1}",[i.displayName]):"",className:"channel"});o.appendChild(r),o.appendChild(a);let s=Nt(zt(l.prototype),"createEl",this).call(this,"div",{className:"cross"});s.addEventListener("click",(()=>this.close())),n.appendChild(o),n.appendChild(s);let u=Nt(zt(l.prototype),"createEl",this).call(this,"ol");for(let l of e.elements){let e=new Dt(this.player(),{element:l,onClicked:()=>this.onItemClicked(l)});u.appendChild(e.el()),this.menuItems.push(e)}return t.appendChild(n),t.appendChild(u),t}},{key:"update",value:function(){let e=this.getOptions();this.updateSelected(e.getCurrentPosition())}},{key:"open",value:function(){this.player().addClass("playlist-menu-displayed")}},{key:"close",value:function(){this.player().removeClass("playlist-menu-displayed")}},{key:"updateSelected",value:function(e){for(let t of this.menuItems)t.setSelected(t.getElement().position===e)}},{key:"getOptions",value:function(){return this.options_}},{key:"onItemClicked",value:function(e){this.getOptions().onItemClicked(e)}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(Ft);function Kt(e,t){return Kt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Kt(e,t)}function Wt(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function qt(e){return qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qt(e)}Ft.registerComponent("PlaylistMenu",$t);let Jt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kt(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=qt(o);if(r){var n=qt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Wt(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=i.call(this,e,t)).options=t,n.player.ready((()=>{e.addClass("vjs-playlist")})),n.playlistMenu=new $t(e,t),n.playlistButton=new Rt(e,Object.assign(Object.assign({},t),{playlistMenu:n.playlistMenu})),e.addChild(n.playlistMenu,t),e.addChild(n.playlistButton,t),n}return t=l,(n=[{key:"updateSelected",value:function(){this.playlistMenu.updateSelected(this.options.getCurrentPosition())}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r().getPlugin("plugin"));function Gt(e,t){return Gt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Gt(e,t)}function Yt(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Zt(e){return Zt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Zt(e)}r().registerPlugin("playlist",Jt);let Qt=z()("peertube:player:mobile"),Xt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gt(e,t)}(a,e);var t,n,o,i,l=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Zt(o);if(i){var n=Zt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Yt(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=l.call(this,e,t)).seekAmount=0,n.peerTubeMobileButtons=e.addChild("PeerTubeMobileButtons",{reportTouchActivity:!1}),r().browser.IS_ANDROID&&screen.orientation&&n.handleFullscreenRotation(),n.player.options_.userActions||(n.player.options_.userActions={}),n.player.options_.userActions.click=!1,n.player.options_.userActions.doubleClick=!1,n.player.one("play",(()=>{n.initTouchStartEvents()})),n}return t=a,(n=[{key:"handleFullscreenRotation",value:function(){this.player.on("fullscreenchange",(()=>{this.player.isFullscreen()&&!this.isPortraitVideo()&&screen.orientation.lock("landscape").catch((e=>b.k.error("Cannot lock screen to landscape.",e)))}))}},{key:"isPortraitVideo",value:function(){return this.player.videoWidth()<this.player.videoHeight()}},{key:"initTouchStartEvents",value:function(){let e=e=>{if(this.tapTimeout&&(clearTimeout(this.tapTimeout),this.tapTimeout=void 0),this.lastTapEvent&&e.timeStamp-this.lastTapEvent.timeStamp<a.DOUBLE_TAP_DELAY_MS)return Qt("Detected double tap"),this.lastTapEvent=void 0,void this.onDoubleTap(e);this.newActiveState=!this.player.userActive(),this.tapTimeout=setTimeout((()=>{Qt("No double tap detected, set user active state to %s.",this.newActiveState),this.player.userActive(this.newActiveState)}),a.DOUBLE_TAP_DELAY_MS),this.lastTapEvent=e};this.player.on("touchstart",(t=>{this.player.userActive()||e(t)})),this.peerTubeMobileButtons.el().addEventListener("touchstart",(t=>{t.preventDefault(),e(t)}),{passive:!1})}},{key:"onDoubleTap",value:function(e){let t=this.player.currentWidth(),n=this.findPlayerTarget(e.target).getBoundingClientRect(),o=e.targetTouches[0].pageX-n.left;Qt("Calculating double tap zone (player width: %d, offset X: %d)",t,o),o>.66*t?(this.seekAmount<0&&(this.seekAmount=0),this.seekAmount+=10,Qt("Will forward %d seconds",this.seekAmount)):o<.33*t&&(this.seekAmount>0&&(this.seekAmount=0),this.seekAmount-=10,Qt("Will rewind %d seconds",this.seekAmount)),this.peerTubeMobileButtons.displayFastSeek(this.seekAmount),this.scheduleSetCurrentTime()}},{key:"findPlayerTarget",value:function(e){return e.classList.contains("video-js")?e:this.findPlayerTarget(e.parentElement)}},{key:"scheduleSetCurrentTime",value:function(){this.player.pause(),this.player.addClass("vjs-fast-seeking"),this.setCurrentTimeTimeout&&clearTimeout(this.setCurrentTimeTimeout),this.setCurrentTimeTimeout=setTimeout((()=>{let e=this.player.currentTime()+this.seekAmount;this.seekAmount=0,e=Math.max(0,e),e=Math.min(this.player.duration(),e),this.player.currentTime(e),this.seekAmount=0,this.peerTubeMobileButtons.displayFastSeek(0),this.player.removeClass("vjs-fast-seeking"),this.player.userActive(!1),this.player.play()}),a.SET_CURRENT_TIME_DELAY)}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(r().getPlugin("plugin"));function en(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tn(){return tn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=nn(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},tn.apply(this,arguments)}function nn(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ln(e)););return e}function on(e,t){return on=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},on(e,t)}function rn(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ln(e){return ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ln(e)}Xt.DOUBLE_TAP_DELAY_MS=250,Xt.SET_CURRENT_TIME_DELAY=1e3,r().registerPlugin("peertubeMobile",Xt);let an=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&on(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ln(o);if(r){var n=ln(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return rn(this,e)});function l(){return en(this,l),i.apply(this,arguments)}return t=l,(n=[{key:"createEl",value:function(){let e=tn(ln(l.prototype),"createEl",this).call(this,"div",{className:"vjs-mobile-buttons-overlay"}),t=tn(ln(l.prototype),"createEl",this).call(this,"div",{className:"main-button"});t.addEventListener("touchstart",(e=>{e.stopPropagation(),this.player_.paused()||this.player_.ended()?this.player_.play():this.player_.pause()})),this.rewind=tn(ln(l.prototype),"createEl",this).call(this,"div",{className:"rewind-button vjs-hidden"}),this.forward=tn(ln(l.prototype),"createEl",this).call(this,"div",{className:"forward-button vjs-hidden"});for(let n=0;n<3;n++)this.rewind.appendChild(tn(ln(l.prototype),"createEl",this).call(this,"span",{className:"icon"})),this.forward.appendChild(tn(ln(l.prototype),"createEl",this).call(this,"span",{className:"icon"}));return this.rewindText=this.rewind.appendChild(tn(ln(l.prototype),"createEl",this).call(this,"div",{className:"text"})),this.forwardText=this.forward.appendChild(tn(ln(l.prototype),"createEl",this).call(this,"div",{className:"text"})),e.appendChild(this.rewind),e.appendChild(t),e.appendChild(this.forward),e}},{key:"displayFastSeek",value:function(e){return 0===e?(this.hideRewind(),void this.hideForward()):e>0?(this.hideRewind(),void this.displayForward(e)):e<0?(this.hideForward(),void this.displayRewind(e)):void 0}},{key:"hideRewind",value:function(){this.rewind.classList.add("vjs-hidden"),this.rewindText.textContent=""}},{key:"displayRewind",value:function(e){this.rewind.classList.remove("vjs-hidden"),this.rewindText.textContent=this.player().localize("{1} seconds",[e+""])}},{key:"hideForward",value:function(){this.forward.classList.add("vjs-hidden"),this.forwardText.textContent=""}},{key:"displayForward",value:function(e){this.forward.classList.remove("vjs-hidden"),this.forwardText.textContent=this.player().localize("{1} seconds",[e+""])}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r().getComponent("Component"));function sn(e,t){return sn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sn(e,t)}function un(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function cn(e){return cn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cn(e)}r().registerComponent("PeerTubeMobileButtons",an);let pn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sn(e,t)}(l,e);var t,n,o,r,i=(o=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=cn(o);if(r){var n=cn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return un(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=i.call(this,e,t)).handlers=n.buildHandlers(),n.handleKeyFunction=e=>n.onKeyDown(e),document.addEventListener("keydown",n.handleKeyFunction),n}return t=l,(n=[{key:"dispose",value:function(){document.removeEventListener("keydown",this.handleKeyFunction)}},{key:"onKeyDown",value:function(e){if(this.isValidKeyTarget(e.target))for(let t of this.handlers)if(t.accept(e))return void t.cb(e)}},{key:"buildHandlers",value:function(){let e=[{accept:e=>" "===e.key||"MediaPlayPause"===e.key,cb:e=>{e.preventDefault(),e.stopPropagation(),this.player.paused()?this.player.play():this.player.pause()}},{accept:e=>this.isNaked(e,"ArrowUp"),cb:e=>{e.preventDefault(),this.player.volume(this.player.volume()+l.VOLUME_STEP)}},{accept:e=>this.isNaked(e,"ArrowDown"),cb:e=>{e.preventDefault(),this.player.volume(this.player.volume()-l.VOLUME_STEP)}},{accept:e=>this.isNaked(e,"ArrowLeft")||this.isNaked(e,"MediaRewind"),cb:e=>{e.preventDefault();let t=Math.max(0,this.player.currentTime()-l.SEEK_STEP);this.player.currentTime(t)}},{accept:e=>this.isNaked(e,"ArrowRight")||this.isNaked(e,"MediaForward"),cb:e=>{e.preventDefault();let t=Math.min(this.player.duration(),this.player.currentTime()+l.SEEK_STEP);this.player.currentTime(t)}},{accept:e=>this.isNaked(e,"f")||!e.altKey&&e.ctrlKey&&"Enter"===e.key,cb:e=>{e.preventDefault(),this.player.isFullscreen()?this.player.exitFullscreen():this.player.requestFullscreen()}},{accept:e=>this.isNaked(e,"m"),cb:e=>{e.preventDefault(),this.player.muted(!this.player.muted())}},{accept:e=>">"===e.key,cb:()=>{let e=Math.min(this.player.playbackRate()+.1,5);this.player.playbackRate(parseFloat(e.toFixed(2)))}},{accept:e=>"<"===e.key,cb:()=>{let e=Math.max(this.player.playbackRate()-.1,.1);this.player.playbackRate(parseFloat(e.toFixed(2)))}},{accept:e=>","===e.key,cb:()=>{this.player.pause(),this.player.currentTime(this.player.currentTime()-1/30)}},{accept:e=>"."===e.key,cb:()=>{this.player.pause(),this.player.currentTime(this.player.currentTime()+1/30)}}];for(let t=0;t<10;t++)e.push({accept:e=>e.key===t+""&&!e.ctrlKey,cb:e=>{e.preventDefault(),this.player.currentTime(this.player.duration()*t*.1)}});return e}},{key:"isValidKeyTarget",value:function(e){let t=this.player.el(),n=document.activeElement,o=e.tagName.toLowerCase();return n===t||n===t.querySelector(".vjs-tech")||n===t.querySelector(".vjs-control-bar")||"content"===e.id||"body"===o||"video"===o}},{key:"isNaked",value:function(e,t){return!(e.ctrlKey||e.altKey||e.metaKey||e.shiftKey||e.key!==t)}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r().getPlugin("plugin"));function fn(e){let t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}function dn(e){return new Promise((t=>{setTimeout((()=>t()),e)}))}pn.VOLUME_STEP=.1,pn.SEEK_STEP=5,r().registerPlugin("peerTubeHotkeysPlugin",pn),n(2492);var hn=n(9589);let yn=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mode=n,this.options=t.common}var t,n;return t=e,(n=[{key:"getChildrenOptions",value:function(){let e={};return this.options.previousVideo&&Object.assign(e,this.getPreviousVideo()),Object.assign(e,{playToggle:{}}),this.options.nextVideo&&Object.assign(e,this.getNextVideo()),Object.assign(e,Object.assign(Object.assign(Object.assign({currentTimeDisplay:{},timeDivider:{},durationDisplay:{},liveDisplay:{},flexibleWidthSpacer:{}},this.getProgressControl()),{p2PInfoButton:{p2pEnabled:this.options.p2pEnabled},muteToggle:{},volumeControl:{}}),this.getSettingsButton())),Object.assign(e,{PictureInPictureBastyon:{}}),!0===this.options.theaterButton&&Object.assign(e,{theaterButton:{}}),Object.assign(e,{fullscreenToggle:{}}),e}},{key:"getSettingsButton",value:function(){let e=[];return e.push("playbackRateMenuButton"),e.push("resolutionMenuButton"),{settingsButton:{setup:{maxHeightOffset:40},entries:e}}}},{key:"getProgressControl",value:function(){return{progressControl:{children:{seekBar:{children:{["webtorrent"===this.mode?"peerTubeLoadProgressBar":"loadProgressBar"]:{},mouseTimeDisplay:{},playProgressBar:{}}}}}}}},{key:"getPreviousVideo",value:function(){return{previousVideoButton:{type:"previous",handler:this.options.previousVideo,isDisabled:()=>!!this.options.hasPreviousVideo&&!this.options.hasPreviousVideo()}}}},{key:"getNextVideo",value:function(){return{nextVideoButton:{type:"next",handler:this.options.nextVideo,isDisabled:()=>!!this.options.hasNextVideo&&!this.options.hasNextVideo()}}}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();var bn=n(1301);function vn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}let mn=function(){function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];vn(this,e),this.baseUrls=t}var t,n;return t=e,(n=[{key:"removeBySegmentUrl",value:function(e){b.k.info(`Removing redundancy of segment URL ${e}.`);let t=(0,bn.dirname)(e);this.baseUrls=this.baseUrls.filter((e=>e!==t&&e!==t+"/"))}},{key:"buildUrl",value:function(e){let t=this.baseUrls.length+1,n=this.getRandomInt(t);if(n===t-1)return e;let o=this.baseUrls[n],r=o.endsWith("/")?"":"/";return o+r+(0,bn.basename)(e)}},{key:"countBaseUrls",value:function(){return this.baseUrls.length}},{key:"getRandomInt",value:function(e){return Math.floor(Math.random()*Math.floor(e))}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function gn(e){return function(t){return e.buildUrl(t.url)}}var wn=n(2236).Buffer;function On(e,t,n,o,r,i,l){try{var a=e[i](l),s=a.value}catch(u){return void n(u)}a.done?t(s):Promise.resolve(s).then(o,r)}function jn(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function l(e){On(i,o,r,l,a,"next",e)}function a(e){On(i,o,r,l,a,"throw",e)}l(void 0)}))}}function Pn(e,t){let n=En(e),o=/bytes=(\d+)-(\d+)/;return function(){var r=jn((function*(r,l,a){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;t&&(yield dn(1e3));let u,c=(0,bn.basename)(r.url),p=(yield n)[c];if(!p&&s>3)throw new Error(`Unknown segment name ${c} in segment validator`);if(!p)return b.k.info(`Refetching sha segments for ${c}`),yield dn(1e3),n=En(e),void(yield i(r,l,a,s+1));let f="";if("string"==typeof p)u=p;else{let e=o.exec(r.range);f=e[1]+"-"+e[2],u=p[f]}if(void 0===u)throw new Error(`Unknown segment name ${c}/${f} in segment validator`);let d=yield Cn(r.data);if(d!==u)throw new Error(`Hashes does not correspond for segment ${c}/${f}(expected: ${u} instead of ${d})`)}));function i(e,t,n){return r.apply(this,arguments)}return i}()}function En(e){return fetch(e).then((e=>e.json())).catch((e=>(b.k.error("Cannot get sha256 segments",e),{})))}function Cn(e){return kn.apply(this,arguments)}function kn(){return(kn=jn((function*(e){if(e)return window.crypto.subtle?window.crypto.subtle.digest("SHA-256",e).then((e=>Tn(e))):(new((yield n.e(875).then(n.t.bind(n,875,23))).default.sha256)).update(wn.from(e)).digest("hex")}))).apply(this,arguments)}function Tn(e){if(!e)return"";let t="",n="0123456789abcdef";return new Uint8Array(e).forEach((e=>{t+=n[e>>4]+n[15&e]})),t}let _n=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.p2pMediaLoaderModule=n}var t,n;return t=e,(n=[{key:"getPluginOptions",value:function(){let e=this.options.common,t=new mn(this.options.p2pMediaLoader.redundancyBaseUrls),n=this.getP2PMediaLoaderOptions(t),o=new this.p2pMediaLoaderModule.Engine(n).createLoaderClass();return{p2pMediaLoader:{redundancyUrlManager:t,type:"application/x-mpegURL",startTime:e.startTime,src:this.options.p2pMediaLoader.playlistUrl,loader:o},hlsjs:{levelLabelHandler:e=>{let t=Math.min(e.height||0,e.width||0),n=this.options.p2pMediaLoader.videoFiles.find((e=>e.resolution.id===t));if(!n)return e.height;let o=n.resolution.label;return n.fps>=50&&(o+=n.fps),o}},html5:{hlsjsConfig:this.getHLSJSOptions(o)}}}},{key:"getP2PMediaLoaderOptions",value:function(e){var t,n;let o=!1;"cellular"===(null===(t=null===navigator||void 0===navigator?void 0:navigator.connection)||void 0===t?void 0:t.type)&&(b.k.info("We are on a cellular connection: disabling seeding."),o=!0);let r=this.options.p2pMediaLoader.trackerAnnounce.filter((e=>e.startsWith("ws"))),i=this.options.common.isLive?this.getP2PMediaLoaderLiveOptions():this.getP2PMediaLoaderVODOptions();return{loader:Object.assign({trackerAnnounce:r,rtcConfig:(0,m.gI)(),simultaneousHttpDownloads:1,httpFailedSegmentTimeout:1e3,segmentValidator:this.options.common.localTransport?void 0:Pn(this.options.p2pMediaLoader.segmentsSha256Url,this.options.common.isLive),segmentUrlBuilder:gn(e),useP2P:this.options.common.p2pEnabled,consumeOnly:o,segmentsStorage:this.options.segmentsStorage,localTransport:this.options.common.localTransport},i),segments:{assetsStorage:this.options.assetsStorage,swarmId:this.options.p2pMediaLoader.playlistUrl,forwardSegmentCount:null!==(n=i.p2pDownloadMaxPriority)&&void 0!==n?n:20}}}},{key:"getP2PMediaLoaderLiveOptions",value:function(){let e={requiredSegmentsPriority:1};return 3===this.options.common.liveOptions.latencyMode?Object.assign(Object.assign({},e),{useP2P:!1,httpDownloadProbability:1}):e}},{key:"getP2PMediaLoaderVODOptions",value:function(){return{requiredSegmentsPriority:3,skipSegmentBuilderPriority:1,cachedSegmentExpiration:864e5,cachedSegmentsCount:100,httpDownloadMaxPriority:9,httpDownloadProbability:.06,httpDownloadProbabilitySkipIfNoPeers:!0,p2pDownloadMaxPriority:50}}},{key:"getHLSJSOptions",value:function(e){let t=this.options.common.isLive?this.getHLSLiveOptions():this.getHLSVODOptions(),n=Object.assign({capLevelToPlayerSize:!0,autoStartLoad:!1,loader:e},t),o=(0,F.zZ)();return o?Object.assign(Object.assign({},n),{abrEwmaDefaultEstimate:8*o,backBufferLength:90,startLevel:-1,testBandwidth:!1,debug:!1}):n}},{key:"getHLSLiveOptions",value:function(){switch(this.options.common.liveOptions.latencyMode){case 3:return{liveSyncDurationCount:2};case 2:return{liveSyncDurationCount:10};default:return{liveSyncDurationCount:5}}}},{key:"getHLSVODOptions",value:function(){return{liveSyncDurationCount:5}}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();let Rn=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.autoPlayValue=n}var t,n;return t=e,(n=[{key:"getPluginOptions",value:function(){let e=this.options.common,t=this.options.webtorrent,n=this.options.p2pMediaLoader;return{webtorrent:{autoplay:"play"===this.autoPlayValue,playerRefusedP2P:!1===e.p2pEnabled,videoDuration:e.videoDuration,playerElement:e.playerElement,videoFiles:0!==t.videoFiles.length?t.videoFiles:(null==n?void 0:n.videoFiles)||[],startTime:e.startTime}}}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();let Sn=function(){function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mode=t,this.options=n,this.p2pMediaLoaderModule=o}var t,n;return t=e,(n=[{key:"getVideojsOptions",value:function(e){let t=this.options.common,n=this.getAutoPlayValue(t.autoplay,e),o={preloadTextTracks:!1},r={peertube:Object.assign({mode:this.mode,autoplay:n},(0,v.ei)(t,["videoViewUrl","authorizationHeader","startTime","videoDuration","subtitle","stopTime","isLive","videoUUID"]))};if("p2p-media-loader"===this.mode){let e=new _n(this.options,this.p2pMediaLoaderModule).getPluginOptions();Object.assign(r,(0,v.ei)(e,["hlsjs","p2pMediaLoader"])),Object.assign(o,e.html5)}else if("webtorrent"===this.mode){let t=new Rn(this.options,this.getAutoPlayValue(n,e));Object.assign(r,t.getPluginOptions()),n=!1}Object.assign(r,{hotkeys:{}});let i=new yn(this.options,this.mode),l={html5:o,textTrackSettings:!1,controls:void 0===t.controls||t.controls,loop:void 0!==t.loop&&t.loop,muted:void 0!==t.muted?t.muted:void 0,autoplay:this.getAutoPlayValue(n,e),poster:t.poster,inactivityTimeout:t.inactivityTimeout,playbackRates:[.5,.75,1,1.25,1.5,1.75,2],plugins:r,sources:t.sources,controlBar:{children:i.getChildrenOptions()}};return t.language&&!(0,hn.TF)(t.language)&&Object.assign(l,{language:t.language}),l}},{key:"getAutoPlayValue",value:function(e,t){return!0!==e?e:(0,S.gn)()||(0,S.G6)()?!!t&&"play":"play"}},{key:"getContextMenuOptions",value:function(e,t){return{content:()=>{let n=e.options_.loop,o=[{icon:"repeat",label:e.localize("Play in loop")+(n?'<span class="vjs-icon-tick-white"></span>':""),listener:function(){e.options_.loop=!n}},{label:e.localize("Copy the video URL"),listener:function(){fn((0,v.d6)({shortUUID:t.videoShortUUID}))}},{label:e.localize("Copy the video URL at the current time"),listener:function(){let e=(0,v.d6)({shortUUID:t.videoShortUUID});fn((0,v.fj)({url:e,startTime:this.currentTime()}))}}];return"webtorrent"===this.mode&&o.push({label:e.localize("Copy magnet URI"),listener:function(){fn(this.webtorrent().getCurrentVideoFile().magnetUri)}}),o.push({icon:"info",label:e.localize("Stats for nerds"),listener:()=>{e.stats().show()}}),o.map((e=>Object.assign(Object.assign({},e),{label:`<span class="vjs-icon-${e.icon||"link-2"}"></span>`+e.label})))}}}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Mn(e,t,n,o,r,i,l){try{var a=e[i](l),s=a.value}catch(u){return void n(u)}a.done?t(s):Promise.resolve(s).then(o,r)}function xn(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function l(e){Mn(i,o,r,l,a,"next",e)}function a(e){Mn(i,o,r,l,a,"throw",e)}l(void 0)}))}}let In=n(483),Ln=r().getComponent("Slider"),Bn=r().getComponent("SeekBar");Ln.prototype.update=function(){if(!this.el_||!this.bar)return;let e=this.getProgress();if(e===this.progress_)return e;this.progress_=e;var t=this.bar.el();return this.vertical()?(t.style["transform-origin"]="bottom",t.style.transform="scaleY("+e.toFixed(2)+")"):t.style.transform="scaleX("+e.toFixed(2)+")",e},Bn.prototype.getPercent=function(){let e=this.player_.currentTime()/this.player_.duration();return e>=1?1:e},Bn.prototype.setEventHandlers_=function(){this.update_=In.bind(this,this.update),this.update=In.throttle(this.update_,In.UPDATE_REFRESH_INTERVAL),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=e=>this.enableInterval_(e),this.disableIntervalHandler_=e=>this.disableInterval_(e),this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in document&&"visibilityState"in document&&this.on(document,"visibilitychange",this.toggleVisibility_)},Bn.prototype.enableInterval_=function(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,In.UPDATE_REFRESH_INTERVAL))},Bn.prototype.update=function(e){if("hidden"===document.visibilityState)return;let t=this.getPercent();var n=this.bar.el();return n.style["transform-origin"]="left",n.style.transform="scaleX("+t.toFixed(2)+")",t},Bn.prototype.handleMouseMove=function(e){let t=this.calculateDistance(e)*this.player_.duration();t===this.player_.duration()&&(t-=.1),this.player_.currentTime(t),this.update()};let Dn=r().getComponent("CaptionsButton");Dn.prototype.controlText_="Subtitles/CC",Dn.prototype.label_=" ";let Nn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,o,i,l,a,s;return t=e,o=[{key:"initState",value:function(){this.alreadyPlayed=!1}},{key:"initialize",value:(s=xn((function*(e,t,o){if(this.onPlayerChange=o,this.playerElementClassName=t.common.playerElement.className,"webtorrent"===e&&(yield Promise.all([n.e(647),n.e(555)]).then(n.bind(n,5308))),"p2p-media-loader"===e){let[e]=yield Promise.all([n.e(819).then(n.t.bind(n,1819,23)),Promise.all([n.e(819),n.e(958),n.e(639)]).then(n.bind(n,1639))]);this.p2pMediaLoaderModule=e}return this.buildPlayer(e,t)})),function(e,t,n){return s.apply(this,arguments)})},{key:"buildPlayer",value:(a=xn((function*(e,t){let n=new Sn(e,t,this.p2pMediaLoaderModule),o=n.getVideojsOptions(this.alreadyPlayed);console.log("videojsOptions",o,t);let i=this;return new Promise((l=>{r()(t.common.playerElement,o,(function(){let o=this;return o.one("error",(()=>{})),o.one("play",(()=>{i.alreadyPlayed=!0})),i.addContextMenu(n,o,t.common),((0,S.tq)()||t.mobile)&&o.peertubeMobile(),!1===t.common.controlBar&&o.controlBar.addClass("control-bar-hidden"),o.bezels(),"localvideo"!=e?(o.stats({videoUUID:t.common.videoUUID,videoIsLive:t.common.isLive,mode:e,p2pEnabled:t.common.p2pEnabled}),o.on("p2pInfo",((e,t)=>{"p2p-media-loader"!==t.source||isNaN(t.bandwidthEstimate)||(0,F.M_)(t.bandwidthEstimate)}))):o.on("durationchange",(()=>{o.duration()!=t.common.videoDuration&&o.duration(t.common.videoDuration)})),l(o)}))}))})),function(e,t){return a.apply(this,arguments)})},{key:"tryToRecoverHLSError",value:(l=xn((function*(e,t,n){if(3===e.code){if(0===this.videojsDecodeErrors&&n.common.errorNotifier(t.localize("The video failed to play, will try to fast forward.")),20===this.videojsDecodeErrors)return void this.maybeFallbackToWebTorrent("p2p-media-loader",t,n);b.k.info("Fast forwarding HLS to recover from an error."),this.videojsDecodeErrors++,n.common.startTime=t.currentTime()+2,n.common.autoplay=!0,this.rebuildAndUpdateVideoElement(t,n.common);let e=yield this.buildPlayer("p2p-media-loader",n);this.onPlayerChange(e)}else this.maybeFallbackToWebTorrent("p2p-media-loader",t,n)})),function(e,t,n){return l.apply(this,arguments)})},{key:"maybeFallbackToWebTorrent",value:(i=xn((function*(e,t,o){if(console.log("maybeFallbackToWebTorrent"),0===o.webtorrent.videoFiles.length||"webtorrent"===e)return void t.peertube().displayFatalError();b.k.info("Fallback to webtorrent."),this.rebuildAndUpdateVideoElement(t,o.common),yield Promise.all([n.e(647),n.e(555)]).then(n.bind(n,5308));let r=yield this.buildPlayer("webtorrent",o);this.onPlayerChange(r)})),function(e,t,n){return i.apply(this,arguments)})},{key:"rebuildAndUpdateVideoElement",value:function(e,t){let n=document.createElement("video");n.className=this.playerElementClassName;let o=t.playerElement.parentNode;return o||(o=document.getElementById(t.playerElement.id).parentNode),o.parentNode.insertBefore(n,o),t.playerElement=n,t.onPlayerElementChange(n),e.dispose(),n}},{key:"addContextMenu",value:function(e,t,n){let o=e.getContextMenuOptions(t,n);t.contextmenuUI(o)}}],o&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();Nn.alreadyPlayed=!1,Nn.videojsDecodeErrors=0},6546:(e,t,n)=>{"use strict";function o(e){return e.charAt(0).toUpperCase()+e.slice(1)}n.d(t,{aI:()=>i,gI:()=>s,LF:()=>o,qx:()=>l,FE:()=>a});let r=[{max:1024,type:"B",decimals:0},{max:1048576,type:"KB",decimals:0},{max:1073741824,type:"MB",decimals:0},{max:10995116e5,type:"GB",decimals:1}];function i(e){let t=r.find((t=>e<t.max))||r[r.length-1];return[(e/(t.max/1024)).toFixed(t.decimals),t.type]}function l(e){let t=e[0];for(let n=1;n<e.length;n++){let o=e[n];t.resolution.id<o.resolution.id&&(t=o)}return t}function a(e){let t=e[0];for(let n=1;n<e.length;n++){let o=e[n];t.resolution.id>o.resolution.id&&(t=o)}return t}function s(){return{iceServers:[{urls:"stun:stun.stunprotocol.org"},{urls:"stun:stun.framasoft.org"}]}}},7012:(e,t,n)=>{"use strict";function o(){return!!/iPad|iPhone|iPod/.test(navigator.platform)||!!(navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&navigator.platform.includes("MacIntel"))}function r(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function i(){return/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)}n.d(t,{G6:()=>r,gn:()=>o,tq:()=>i})},1301:(e,t,n)=>{"use strict";e.exports=n(1328)},9589:(e,t,n)=>{"use strict";n.d(t,{TF:()=>r});let o={"ar-001":"ar",ca:"ca-ES",cs:"cs-CZ",de:"de-DE",el:"el-GR",en:"en-US",es:"es-ES",eu:"eu-ES",fi:"fi-FI",gl:"gl-ES",fa:"fa-IR",fr:"fr-FR",hu:"hu-HU",it:"it-IT",ja:"ja-JP",nl:"nl-NL",pl:"pl-PL",pt:"pt-BR",nb:"nb-NO",ru:"ru-RU",sv:"sv-SE",th:"th-TH",vi:"vi-VN","zh-CN":"zh-Hans-CN","zh-Hans":"zh-Hans-CN","zh-Hant":"zh-Hant-TW","zh-TW":"zh-Hant-TW",zh:"zh-Hans-CN"};function r(e){return i(e)===i("en-US")}function i(e){return e&&o[e]?o[e]:e}Object.keys({"en-US":"English",ar:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629","ca-ES":"Catal\xe0","cs-CZ":"\u010ce\u0161tina","de-DE":"Deutsch","el-GR":"\u03b5\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",eo:"Esperanto","es-ES":"Espa\xf1ol","eu-ES":"Euskara","fi-FI":"suomi","fr-FR":"Fran\xe7ais",gd:"G\xe0idhlig","gl-ES":"galego",hr:"hrvatski","hu-HU":"magyar","fa-IR":"\u0641\u0627\u0631\u0633\u06cc","it-IT":"Italiano","ja-JP":"\u65e5\u672c\u8a9e",kab:"Taqbaylit","nl-NL":"Nederlands",oc:"Occitan","pl-PL":"Polski","pt-BR":"Portugu\xeas (Brasil)","pt-PT":"Portugu\xeas (Portugal)","ru-RU":"\u0440\u0443\u0441\u0441\u043a\u0438\u0439",sq:"Shqip","sv-SE":"Svenska",nn:"norsk nynorsk","nb-NO":"norsk bokm\xe5l","th-TH":"\u0e44\u0e17\u0e22","vi-VN":"Ti\u1ebfng Vi\u1ec7t",tok:"Toki Pona","zh-Hans-CN":"\u7b80\u4f53\u4e2d\u6587\uff08\u4e2d\u56fd\uff09","zh-Hant-TW":"\u7e41\u9ad4\u4e2d\u6587\uff08\u53f0\u7063\uff09"}).concat(Object.keys(o)).map((e=>"/"+e))},7862:(e,t,n)=>{"use strict";function o(e){if(!e)return 0;if("number"==typeof e)return e;let t=e.match(/^((\d+)[h:])?((\d+)[m:])?((\d+)s?)?$/);return t?3600*parseInt(t[2]||"0",10)+60*parseInt(t[4]||"0",10)+parseInt(t[6]||"0",10):0}function r(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,o="";if(0===e&&!t)return"0s";let r=n||"h",i=n||"m",l=t?"":"s",a=Math.floor(e/3600);a>=1?o=a+r:t&&(o="0"+r),e%=3600;let s=Math.floor(e/60);return s>=1&&s<10&&t?o+="0"+s+i:s>=1?o+=s+i:t&&(o+="00"+i),(e%=60)>=1&&e<10&&t?o+="0"+e+l:e>=1?o+=e+l:t&&(o+="00"),o}function i(e,t){let n={};for(let o of t)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}function l(e,t){return(null!=t?t:window.location.origin)+function(e){return"/w/"+e.shortUUID}(e)}function a(e){let{url:t}=e,n=new URLSearchParams;if(null!=e.startTime){let t=Math.floor(e.startTime);n.set("start",r(t))}if(e.stopTime){let t=Math.floor(e.stopTime);n.set("stop",r(t))}return e.subtitle&&n.set("subtitle",e.subtitle),!0===e.loop&&n.set("loop","1"),!0===e.autoplay&&n.set("autoplay","1"),!0===e.muted&&n.set("muted","1"),!1===e.title&&n.set("title","0"),!1===e.warningTitle&&n.set("warningTitle","0"),!1===e.controls&&n.set("controls","0"),!1===e.controlBar&&n.set("controlBar","0"),!1===e.peertubeLink&&n.set("peertubeLink","0"),void 0!==e.p2p&&n.set("p2p",e.p2p?"1":"0"),function(e,t){let n=!1;return t.forEach((()=>{n=!0})),n?e+"?"+t.toString():e}(t,n)}n.d(t,{d6:()=>l,fj:()=>a,ei:()=>i,nH:()=>r,h8:()=>o}),n(1301),n(9589);let s=["linkify","autolink","emphasis","link","newline","entity","list"],u=s.concat(["html_inline","html_block"]);s.concat(["image"]),u.concat(["image"]).concat(["block","inline","heading","paragraph"])},483:(e,t,n)=>{"use strict";n.r(t),n.d(t,{UPDATE_REFRESH_INTERVAL:()=>l,bind:()=>a,debounce:()=>u,throttle:()=>s});let o=3;var r=n(7688),i=n.n(r);let l=30,a=function(e,t,n){t.guid||(t.guid=o++);let r=t.bind(e);return r.guid=n?n+"_"+t.guid:t.guid,r},s=function(e,t){let n=i().performance.now();return function(){let o=i().performance.now();o-n>=t&&(e.apply(void 0,arguments),n=o)}},u=function(e,t,n){let o,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i(),l=()=>{r.clearTimeout(o),o=null},a=function(){let i=this,l=arguments,a=function(){o=null,a=null,n||e.apply(i,l)};!o&&n&&e.apply(i,l),r.clearTimeout(o),o=r.setTimeout(a,t)};return a.cancel=l,a}},2492:function(e,t,n){var o,r,i;i=function(e){"use strict";"undefined"!=typeof window&&(window.videojs_hotkeys={version:"0.2.27"}),(e.registerPlugin||e.plugin)("hotkeys",(function(t){var n=this,o=n.el(),r=document,i=(t=(e.mergeOptions||e.util.mergeOptions)({volumeStep:.1,seekStep:5,enableMute:!0,enableVolumeScroll:!0,enableHoverScroll:!1,enableFullscreen:!0,enableNumbers:!0,enableJogStyle:!1,alwaysCaptureHotkeys:!1,captureDocumentHotkeys:!1,documentHotkeysFocusElementFilter:function(){return!1},enableModifiersForNumbers:!0,enableInactiveFocus:!0,skipInitialFocus:!1,playPauseKey:function(e){return 32===e.which||179===e.which},rewindKey:function(e){return 37===e.which||177===e.which},forwardKey:function(e){return 39===e.which||176===e.which},volumeUpKey:function(e){return 38===e.which},volumeDownKey:function(e){return 40===e.which},muteKey:function(e){return 77===e.which},fullscreenKey:function(e){return 70===e.which},customKeys:{}},t||{})).volumeStep,l=t.seekStep,a=t.enableMute,s=t.enableVolumeScroll,u=t.enableHoverScroll,c=t.enableFullscreen,p=t.enableNumbers,f=t.enableJogStyle,d=t.alwaysCaptureHotkeys,h=t.captureDocumentHotkeys,y=t.documentHotkeysFocusElementFilter,b=t.enableModifiersForNumbers,v=t.enableInactiveFocus,m=t.skipInitialFocus,g=e.VERSION;o.hasAttribute("tabIndex")||o.setAttribute("tabIndex","-1"),o.style.outline="none",!d&&n.autoplay()||m||n.one("play",(function(){o.focus()})),v&&n.on("userinactive",(function(){var e=function(){clearTimeout(t)},t=setTimeout((function(){n.off("useractive",e);var t=r.activeElement,i=o.querySelector(".vjs-control-bar");t&&t.parentElement==i&&o.focus()}),10);n.one("useractive",e)})),n.on("play",(function(){var e=o.querySelector(".iframeblocker");e&&""===e.style.display&&(e.style.display="block",e.style.bottom="39px")}));var w=function(e){var l,s,u,v=e.which,m=e.preventDefault.bind(e),g=n.duration();if(n.controls()){var w=r.activeElement;if(d||h&&y(w)||w==o||w==o.querySelector(".vjs-tech")||w==o.querySelector(".vjs-control-bar")||w==o.querySelector(".iframeblocker"))switch(C(e,n)){case 1:m(),(d||h)&&e.stopPropagation(),n.paused()?null!=(u=n.play())&&"function"==typeof u.then&&u.then(null,(function(e){console.log("E",e)})):n.pause();break;case 2:l=!n.paused(),m(),(s=n.currentTime()-k(e))<=0&&(s=0),n.currentTime(s);break;case 3:l=!n.paused(),m(),(s=n.currentTime()+k(e))>=g&&(s=l?g-.001:g),n.currentTime(s);break;case 5:m(),f?(s=n.currentTime()-1,n.currentTime()<=1&&(s=0),n.currentTime(s)):n.volume(n.volume()-i);break;case 4:m(),f?((s=n.currentTime()+1)>=g&&(s=g),n.currentTime(s)):n.volume(n.volume()+i);break;case 6:a&&n.muted(!n.muted());break;case 7:c&&(n.isFullscreen()?n.exitFullscreen():n.requestFullscreen());break;default:if((v>47&&v<59||v>95&&v<106)&&(b||!(e.metaKey||e.ctrlKey||e.altKey))&&p){var O=48;v>95&&(O=96);var j=v-O;m(),n.currentTime(n.duration()*j*.1)}for(var P in t.customKeys){var E=t.customKeys[P];E&&E.key&&E.handler&&E.key(e)&&(m(),E.handler(n,t,e))}}}},O=function(e){if(null!=g&&g<="7.1.0"&&n.controls()){var t=e.relatedTarget||e.toElement||r.activeElement;t!=o&&t!=o.querySelector(".vjs-tech")&&t!=o.querySelector(".iframeblocker")||c&&(n.isFullscreen()?n.exitFullscreen():n.requestFullscreen())}},j=!1,P=o.querySelector(".vjs-volume-menu-button")||o.querySelector(".vjs-volume-panel");null!=P&&(P.onmouseover=function(){j=!0},P.onmouseout=function(){j=!1});var E=function(e){if(u)var t=0;else t=r.activeElement;if(n.controls()&&(d||t==o||t==o.querySelector(".vjs-tech")||t==o.querySelector(".iframeblocker")||t==o.querySelector(".vjs-control-bar")||j)&&s){e=window.event||e;var l=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));e.preventDefault(),1==l?n.volume(n.volume()+i):-1==l&&n.volume(n.volume()-i)}},C=function(e,n){return t.playPauseKey(e,n)?1:t.rewindKey(e,n)?2:t.forwardKey(e,n)?3:t.volumeUpKey(e,n)?4:t.volumeDownKey(e,n)?5:t.muteKey(e,n)?6:t.fullscreenKey(e,n)?7:void 0};function k(e){return"function"==typeof l?l(e):l}var T=!1;n.on("enablehotkeys",(function(){n.on("keydown",w),n.on("dblclick",O),n.on("mousewheel",E),n.on("DOMMouseScroll",E),h&&document.addEventListener("keydown",w),T=!0}));var _=function(){T&&(n.off("keydown",w),n.off("dblclick",O),n.off("mousewheel",E),n.off("DOMMouseScroll",E),h&&document.removeEventListener("keydown",w)),T=!1};return n.on("disablehotkeys",_),n.on("dispose",(function(){_(),n=null,o=null})),this}))},"undefined"!=typeof window&&window.videojs?i(window.videojs):(o=[n(3654)],r=function(e){return i(e.default||e)}.apply(t,o),void 0===r||(e.exports=r))}}]);
//# sourceMappingURL=543.chunk.js.map